<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>é¡¹ç›®å¼€å‘ | å°è¯´ç²¾å“å±‹</title>
    <meta name="generator" content="VuePress 1.9.7">
    <script crossorigin="anonymous" async="true" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7927582798443371"></script>
    <script src="/redirect.js"></script>
    <meta name="description" content="å°è¯´ç²¾å“å±‹é¡¹ç›®å¼€å‘æ–‡æ¡£,JAVAå­¦ä¹ æ•™ç¨‹,JAVAå¼€æºé¡¹ç›®,JAVAé¡¹ç›®å®æˆ˜æ•™ç¨‹,æ‰‹æŠŠæ‰‹æ•™ä½ å¼€å‘ä¸Šçº¿ä¸€ä¸ªç”Ÿäº§çº§åˆ«çš„å°è¯´ç³»ç»Ÿ">
    
    <link rel="preload" href="/assets/css/0.styles.f109e9b6.css" as="style"><link rel="preload" href="/assets/js/app.09e306c7.js" as="script"><link rel="preload" href="/assets/js/2.99247de7.js" as="script"><link rel="preload" href="/assets/js/14.d3b12aa4.js" as="script"><link rel="prefetch" href="/assets/js/10.0074f0b6.js"><link rel="prefetch" href="/assets/js/11.a30c50a6.js"><link rel="prefetch" href="/assets/js/12.8b56d8ab.js"><link rel="prefetch" href="/assets/js/13.c749534f.js"><link rel="prefetch" href="/assets/js/15.74294d9c.js"><link rel="prefetch" href="/assets/js/16.6da0ac7a.js"><link rel="prefetch" href="/assets/js/17.1ab88373.js"><link rel="prefetch" href="/assets/js/18.8875335c.js"><link rel="prefetch" href="/assets/js/19.4939c52f.js"><link rel="prefetch" href="/assets/js/20.34025d9d.js"><link rel="prefetch" href="/assets/js/21.7cce32ee.js"><link rel="prefetch" href="/assets/js/22.11440c86.js"><link rel="prefetch" href="/assets/js/23.e192cd17.js"><link rel="prefetch" href="/assets/js/24.45216f10.js"><link rel="prefetch" href="/assets/js/25.3be12542.js"><link rel="prefetch" href="/assets/js/26.4fbe7fce.js"><link rel="prefetch" href="/assets/js/27.ba19a09d.js"><link rel="prefetch" href="/assets/js/28.8fee7490.js"><link rel="prefetch" href="/assets/js/29.1393ab46.js"><link rel="prefetch" href="/assets/js/3.d1f014c5.js"><link rel="prefetch" href="/assets/js/30.d7fe8f4e.js"><link rel="prefetch" href="/assets/js/31.3e268b35.js"><link rel="prefetch" href="/assets/js/4.c866ff58.js"><link rel="prefetch" href="/assets/js/5.1dabba3b.js"><link rel="prefetch" href="/assets/js/6.2b9e04ea.js"><link rel="prefetch" href="/assets/js/7.da8e9de0.js"><link rel="prefetch" href="/assets/js/8.f14eb728.js"><link rel="prefetch" href="/assets/js/9.89a7523c.js">
    <link rel="stylesheet" href="/assets/css/0.styles.f109e9b6.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="å°è¯´ç²¾å“å±‹" class="logo"> <span class="site-name can-hide">å°è¯´ç²¾å“å±‹</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  é¦–é¡µ
</a></div><div class="nav-item"><a href="http://47.106.243.172:8888" target="_blank" rel="noopener noreferrer" class="nav-link external">
  åœ¨çº¿æ¼”ç¤º
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://developer.aliyun.com/ebook/read/394" target="_blank" rel="noopener noreferrer" class="nav-link external">
  å¼€å‘è§„çº¦
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://www.xxyopen.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  æŠ€æœ¯åšå®¢
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Project Menu" class="dropdown-title"><span class="title">é¡¹ç›®å®æˆ˜</span> <span class="arrow down"></span></button> <button type="button" aria-label="Project Menu" class="mobile-dropdown-title"><span class="title">é¡¹ç›®å®æˆ˜</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/course/novel/" class="nav-link router-link-active">
  novel
</a></li><li class="dropdown-item"><!----> <a href="/course/novelcloud.html" class="nav-link">
  novel-cloud
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Log Menu" class="dropdown-title"><span class="title">æ›´æ–°æ—¥å¿—</span> <span class="arrow down"></span></button> <button type="button" aria-label="Log Menu" class="mobile-dropdown-title"><span class="title">æ›´æ–°æ—¥å¿—</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/log/novel.html" class="nav-link">
  novel
</a></li><li class="dropdown-item"><!----> <a href="/log/novelcloud.html" class="nav-link">
  novel-cloud
</a></li></ul></div></div><div class="nav-item"><a href="/suport/" class="nav-link">
  ğŸ’–æ”¯æŒ
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="GitHub Menu" class="dropdown-title"><span class="title">GitHub</span> <span class="arrow down"></span></button> <button type="button" aria-label="GitHub Menu" class="mobile-dropdown-title"><span class="title">GitHub</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/201206030/novel" target="_blank" rel="noopener noreferrer" class="nav-link external">
  novel
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/201206030/novel-plus" target="_blank" rel="noopener noreferrer" class="nav-link external">
  novel-plus
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/201206030/novel-cloud" target="_blank" rel="noopener noreferrer" class="nav-link external">
  novel-cloud
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Gitee Menu" class="dropdown-title"><span class="title">ç äº‘</span> <span class="arrow down"></span></button> <button type="button" aria-label="Gitee Menu" class="mobile-dropdown-title"><span class="title">ç äº‘</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://gitee.com/novel_dev_team/novel" target="_blank" rel="noopener noreferrer" class="nav-link external">
  novel
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://gitee.com/novel_dev_team/novel-plus" target="_blank" rel="noopener noreferrer" class="nav-link external">
  novel-plus
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://gitee.com/novel_dev_team/novel-cloud" target="_blank" rel="noopener noreferrer" class="nav-link external">
  novel-cloud
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  é¦–é¡µ
</a></div><div class="nav-item"><a href="http://47.106.243.172:8888" target="_blank" rel="noopener noreferrer" class="nav-link external">
  åœ¨çº¿æ¼”ç¤º
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://developer.aliyun.com/ebook/read/394" target="_blank" rel="noopener noreferrer" class="nav-link external">
  å¼€å‘è§„çº¦
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://www.xxyopen.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  æŠ€æœ¯åšå®¢
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Project Menu" class="dropdown-title"><span class="title">é¡¹ç›®å®æˆ˜</span> <span class="arrow down"></span></button> <button type="button" aria-label="Project Menu" class="mobile-dropdown-title"><span class="title">é¡¹ç›®å®æˆ˜</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/course/novel/" class="nav-link router-link-active">
  novel
</a></li><li class="dropdown-item"><!----> <a href="/course/novelcloud.html" class="nav-link">
  novel-cloud
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Log Menu" class="dropdown-title"><span class="title">æ›´æ–°æ—¥å¿—</span> <span class="arrow down"></span></button> <button type="button" aria-label="Log Menu" class="mobile-dropdown-title"><span class="title">æ›´æ–°æ—¥å¿—</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/log/novel.html" class="nav-link">
  novel
</a></li><li class="dropdown-item"><!----> <a href="/log/novelcloud.html" class="nav-link">
  novel-cloud
</a></li></ul></div></div><div class="nav-item"><a href="/suport/" class="nav-link">
  ğŸ’–æ”¯æŒ
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="GitHub Menu" class="dropdown-title"><span class="title">GitHub</span> <span class="arrow down"></span></button> <button type="button" aria-label="GitHub Menu" class="mobile-dropdown-title"><span class="title">GitHub</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/201206030/novel" target="_blank" rel="noopener noreferrer" class="nav-link external">
  novel
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/201206030/novel-plus" target="_blank" rel="noopener noreferrer" class="nav-link external">
  novel-plus
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/201206030/novel-cloud" target="_blank" rel="noopener noreferrer" class="nav-link external">
  novel-cloud
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Gitee Menu" class="dropdown-title"><span class="title">ç äº‘</span> <span class="arrow down"></span></button> <button type="button" aria-label="Gitee Menu" class="mobile-dropdown-title"><span class="title">ç äº‘</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://gitee.com/novel_dev_team/novel" target="_blank" rel="noopener noreferrer" class="nav-link external">
  novel
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://gitee.com/novel_dev_team/novel-plus" target="_blank" rel="noopener noreferrer" class="nav-link external">
  novel-plus
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://gitee.com/novel_dev_team/novel-cloud" target="_blank" rel="noopener noreferrer" class="nav-link external">
  novel-cloud
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/course/novel/" aria-current="page" class="sidebar-link">å¿«é€Ÿå¼€å§‹</a></li><li><a href="/course/novel/11.html" class="sidebar-link">å…¬ä¼—å·</a></li><li><a href="/course/novel/1.html" class="sidebar-link">æŠ€æœ¯æ¶æ„</a></li><li><a href="/course/novel/2.html" class="sidebar-link">æŠ€æœ¯è¦ç‚¹</a></li><li><a href="/course/novel/3.html" class="sidebar-link">æ•°æ®åº“è®¾è®¡</a></li><li><a href="/course/novel/4.html" aria-current="page" class="active sidebar-link">é¡¹ç›®å¼€å‘</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/course/novel/4.html#å¼€å‘ç¯å¢ƒ" class="sidebar-link">å¼€å‘ç¯å¢ƒ</a></li><li class="sidebar-sub-header"><a href="/course/novel/4.html#idea-æ’ä»¶å®‰è£…" class="sidebar-link">IDEA æ’ä»¶å®‰è£…</a></li><li class="sidebar-sub-header"><a href="/course/novel/4.html#é¡¹ç›®åˆå§‹åŒ–" class="sidebar-link">é¡¹ç›®åˆå§‹åŒ–</a></li><li class="sidebar-sub-header"><a href="/course/novel/4.html#é¡¹ç›®é…ç½®å’Œæ¡†æ¶é›†æˆ" class="sidebar-link">é¡¹ç›®é…ç½®å’Œæ¡†æ¶é›†æˆ</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/course/novel/4.html#åŒ…ç»“æ„åˆ›å»º" class="sidebar-link">åŒ…ç»“æ„åˆ›å»º</a></li><li class="sidebar-sub-header"><a href="/course/novel/4.html#é€šç”¨è¯·æ±‚-å“åº”æ•°æ®æ ¼å¼å°è£…" class="sidebar-link">é€šç”¨è¯·æ±‚/å“åº”æ•°æ®æ ¼å¼å°è£…</a></li><li class="sidebar-sub-header"><a href="/course/novel/4.html#rest-æ¥å£å“åº”å·¥å…·åŠå“åº”æ•°æ®æ ¼å¼å°è£…" class="sidebar-link">Rest æ¥å£å“åº”å·¥å…·åŠå“åº”æ•°æ®æ ¼å¼å°è£…</a></li><li class="sidebar-sub-header"><a href="/course/novel/4.html#é€šç”¨å¼‚å¸¸å¤„ç†" class="sidebar-link">é€šç”¨å¼‚å¸¸å¤„ç†</a></li><li class="sidebar-sub-header"><a href="/course/novel/4.html#å¸¸é‡ç±»åˆ›å»º" class="sidebar-link">å¸¸é‡ç±»åˆ›å»º</a></li><li class="sidebar-sub-header"><a href="/course/novel/4.html#æ—¥å¿—é…ç½®" class="sidebar-link">æ—¥å¿—é…ç½®</a></li><li class="sidebar-sub-header"><a href="/course/novel/4.html#è·¨åŸŸé…ç½®" class="sidebar-link">è·¨åŸŸé…ç½®</a></li><li class="sidebar-sub-header"><a href="/course/novel/4.html#mybatis-å¢å¼ºå·¥å…·-mybatis-plus-é›†æˆ" class="sidebar-link">Mybatis å¢å¼ºå·¥å…· MyBatis-Plus é›†æˆ</a></li><li class="sidebar-sub-header"><a href="/course/novel/4.html#ä»£ç ç”Ÿæˆå™¨-mybatis-plus-generator-é›†æˆ" class="sidebar-link">ä»£ç ç”Ÿæˆå™¨ Mybatis-Plus-Generator é›†æˆ</a></li><li class="sidebar-sub-header"><a href="/course/novel/4.html#æœ¬åœ°ç¼“å­˜-caffeine-é›†æˆå’Œé…ç½®" class="sidebar-link">æœ¬åœ°ç¼“å­˜ Caffeine é›†æˆå’Œé…ç½®</a></li><li class="sidebar-sub-header"><a href="/course/novel/4.html#åˆ†å¸ƒå¼ç¼“å­˜-redis-é›†æˆå’Œé…ç½®" class="sidebar-link">åˆ†å¸ƒå¼ç¼“å­˜ Redis é›†æˆå’Œé…ç½®</a></li><li class="sidebar-sub-header"><a href="/course/novel/4.html#æœç´¢å¼•æ“-elasticsearch-é›†æˆä¸é…ç½®" class="sidebar-link">æœç´¢å¼•æ“ Elasticsearch é›†æˆä¸é…ç½®</a></li><li class="sidebar-sub-header"><a href="/course/novel/4.html#spring-amqp-é›†æˆä¸é…ç½®" class="sidebar-link">Spring AMQP é›†æˆä¸é…ç½®</a></li><li class="sidebar-sub-header"><a href="/course/novel/4.html#åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦å¹³å°-xxl-job-é›†æˆä¸é…ç½®" class="sidebar-link">åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦å¹³å° XXL-JOB é›†æˆä¸é…ç½®</a></li></ul></li><li class="sidebar-sub-header"><a href="/course/novel/4.html#æ¥å£å¼€å‘" class="sidebar-link">æ¥å£å¼€å‘</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/course/novel/4.html#æ¥å£è§„çº¦" class="sidebar-link">æ¥å£è§„çº¦</a></li><li class="sidebar-sub-header"><a href="/course/novel/4.html#service-dao-å±‚æ–¹æ³•å‘½åè§„çº¦" class="sidebar-link">Service/DAO å±‚æ–¹æ³•å‘½åè§„çº¦</a></li><li class="sidebar-sub-header"><a href="/course/novel/4.html#é¦–é¡µç›¸å…³æ¥å£å¼€å‘" class="sidebar-link">é¦–é¡µç›¸å…³æ¥å£å¼€å‘</a></li><li class="sidebar-sub-header"><a href="/course/novel/4.html#ç™»å½•æ³¨å†Œç›¸å…³æ¥å£å¼€å‘" class="sidebar-link">ç™»å½•æ³¨å†Œç›¸å…³æ¥å£å¼€å‘</a></li><li class="sidebar-sub-header"><a href="/course/novel/4.html#å°è¯´è¯¦æƒ…é¡µç›¸å…³æ¥å£å¼€å‘" class="sidebar-link">å°è¯´è¯¦æƒ…é¡µç›¸å…³æ¥å£å¼€å‘</a></li></ul></li></ul></li><li><a href="/course/novel/9.html" class="sidebar-link">é¡¹ç›®ä¼˜åŒ–</a></li><li><a href="/course/novel/6.html" class="sidebar-link">é¡¹ç›®éƒ¨ç½²</a></li><li><a href="/course/novel/12.html" class="sidebar-link">æ›´å¤š</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="é¡¹ç›®å¼€å‘"><a href="#é¡¹ç›®å¼€å‘" class="header-anchor">#</a> é¡¹ç›®å¼€å‘</h1> <h2 id="å¼€å‘ç¯å¢ƒ"><a href="#å¼€å‘ç¯å¢ƒ" class="header-anchor">#</a> å¼€å‘ç¯å¢ƒ</h2> <ul><li>MySQL 8.0</li> <li>Redis 7.0</li> <li>Elasticsearch 8.2.0ï¼ˆé€‰è£…ï¼‰</li> <li>RabbitMQ 3.10.2ï¼ˆé€‰è£…ï¼‰</li> <li>XXL-JOB 2.3.1ï¼ˆé€‰è£…ï¼‰</li> <li>JDK 17</li> <li>Maven 3.8.5</li> <li>IntelliJ IDEA 2021.3</li> <li>Node 16.14</li></ul> <h2 id="idea-æ’ä»¶å®‰è£…"><a href="#idea-æ’ä»¶å®‰è£…" class="header-anchor">#</a> IDEA æ’ä»¶å®‰è£…</h2> <p>ä½¿ç”¨ IntelliJ IDEA å¼€å‘çš„åŒå­¦å»ºè®®å®‰è£…ä»¥ä¸‹æ’ä»¶ï¼š</p> <ul><li><p>å¿…è£…</p> <ul><li><p>Alibaba Java Code Guidelines - é˜¿é‡Œå·´å·´ Java ä»£ç è§„èŒƒ</p></li> <li><p>SonarLint - ä»£ç è´¨é‡æ£€æµ‹</p></li> <li><p>Save Actions - ä»£ç è‡ªåŠ¨æ ¼å¼åŒ–ï¼ˆ<a href="/course/novel/12.html#java-ä»£ç æ ¼å¼">Java ä»£ç æ ¼å¼</a>ï¼‰</p></li> <li><p>Git Commit Template - ä½¿ç”¨è§„èŒƒæ¨¡æ¿åˆ›å»º Git æäº¤æ¶ˆæ¯ï¼ˆ<a href="/course/novel/12.html#git-æäº¤è§„çº¦">Git æäº¤è§„èŒƒ</a>ï¼‰</p></li></ul></li> <li><p>é€‰è£…</p> <ul><li><p>Translation - ç¿»è¯‘æ’ä»¶</p></li> <li><p>Maven Helper - åˆ†æ Maven ä¾èµ–ï¼Œè§£å†³ Jar å†²çª</p></li> <li><p>EasyYapi - å¸®åŠ©ä½ å¯¼å‡ºæ–‡ä»¶ä¸­çš„ API åˆ° <code>yapi</code>/<code>postman</code>/<code>markdown</code> æˆ–å‘èµ·æ–‡ä»¶ä¸­çš„ API è¯·æ±‚</p></li> <li><p>Codota - ä»£ç æ™ºèƒ½æç¤º</p></li> <li><p>Search In Repository - æœç´¢ Maven æˆ–è€… NPM çš„ä¾èµ–ä¿¡æ¯</p></li> <li><p>CamelCase - å¤šç§å‘½åæ ¼å¼ï¼ˆä¸‹åˆ’çº¿ã€é©¼å³°ç­‰ï¼‰ä¹‹é—´åˆ‡æ¢</p></li> <li><p>Auto filling Java call arguments - è‡ªåŠ¨è¡¥å…¨è°ƒç”¨å‡½æ•°çš„å‚æ•°</p></li> <li><p>GenerateO2O - ç”Ÿæˆä¸€ä¸ªå¯¹è±¡å¹¶è‡ªåŠ¨å¡«å……å¦ä¸€ä¸ªå¯¹è±¡çš„å€¼</p></li> <li><p>GenerateAllSetter - ä¸€é”®è°ƒç”¨ä¸€ä¸ªå¯¹è±¡çš„æ‰€æœ‰çš„setæ–¹æ³•</p></li> <li><p>SequenceDiagram - è°ƒç”¨é“¾è·¯è‡ªåŠ¨ç”Ÿæˆæ—¶åºå›¾</p></li> <li><p>Rainbow Brackets - è®©ä½ çš„æ‹¬å·å˜æˆä¸ä¸€æ ·çš„é¢œè‰²ï¼Œé˜²æ­¢é”™ä¹±æ‹¬å·</p></li> <li><p>HighlightBracketPair - æ‹¬å·å¼€å§‹å’Œç»“å°¾ï¼Œé«˜äº®æ˜¾ç¤º</p></li> <li><p>Grep Console - æ§åˆ¶å°æ—¥å¿— é«˜äº®</p></li> <li><p>Key promoter X - é¼ æ ‡æ“ä½œçš„å¿«æ·é”®æç¤º</p></li> <li><p>CodeGlance - ç¼©ç•¥å›¾</p></li> <li><p>VisualGC - å®æ—¶åƒåœ¾å›æ”¶ç›‘æ§</p></li> <li><p>arthas idea - java åœ¨çº¿è¯Šæ–­å·¥å…·</p></li> <li><p>Alibaba Cloud Toolkit - é€šè¿‡å›¾å½¢é…ç½®çš„æ–¹å¼è¿æ¥åˆ°äº‘ç«¯éƒ¨ç½²ç¯å¢ƒå¹¶å°†åº”ç”¨ç¨‹åºå¿«é€Ÿéƒ¨ç½²åˆ°äº‘ç«¯</p></li></ul></li> <li><p>ä¸Šç­æ‘¸é±¼</p> <ul><li><p>Leetcode Editor IDEA åœ¨çº¿åˆ·é¢˜</p></li> <li><p>GIdeaBrowser IDEA å†…åµŒ Web æµè§ˆå™¨</p></li></ul></li></ul> <h2 id="é¡¹ç›®åˆå§‹åŒ–"><a href="#é¡¹ç›®åˆå§‹åŒ–" class="header-anchor">#</a> é¡¹ç›®åˆå§‹åŒ–</h2> <p>æˆ‘ä»¬ä½¿ç”¨ Spring Initializr æ¥åˆå§‹åŒ–æˆ‘ä»¬çš„é¡¹ç›®ã€‚</p> <p><img src="/img/novel/springbootinit.png" alt="Spring Initializr"></p> <p>æ“ä½œæ­¥éª¤å¦‚ä¸‹ï¼š</p> <ol><li><p>å¯¼èˆªåˆ° <a href="https://start.spring.io/" target="_blank" rel="noopener noreferrer">Spring Initializr<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ã€‚è¯¥æœåŠ¡å¼•å…¥åº”ç”¨ç¨‹åºæ‰€éœ€çš„æ‰€æœ‰ä¾èµ–é¡¹ï¼Œå¹¶è‡ªåŠ¨å®Œæˆå¤§éƒ¨åˆ†è®¾ç½®ã€‚</p></li> <li><p>é€‰æ‹© Gradle æˆ– Maven ä»¥åŠè¦ä½¿ç”¨çš„è¯­è¨€ã€‚æœ¬é¡¹ç›®é€‰æ‹© Maven å’Œ Javaã€‚</p></li> <li><p>é€‰æ‹© Spring Boot çš„ç‰ˆæœ¬ã€‚æœ¬é¡¹ç›®é€‰æ‹© 3.0.0-SNAPSHOT ç‰ˆæœ¬ã€‚</p></li> <li><p>å¡«å†™é¡¹ç›®å…ƒæ•°æ®ã€‚æœ¬é¡¹ç›®é€‰æ‹© Java 17 ç‰ˆæœ¬ã€‚</p></li> <li><p>å•å‡» ADD DEPENDENCIES å¹¶é€‰æ‹©é¡¹ç›®ä¾èµ–é¡¹ã€‚æœ¬é¡¹ç›®é€‰æ‹©çš„ä¾èµ–å¦‚ä¸Šå›¾æ‰€ç¤ºã€‚</p></li> <li><p>å•å‡» GENERATEï¼Œä¸‹è½½ç”Ÿæˆçš„ ZIP æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶æ˜¯æ ¹æ®æˆ‘ä»¬çš„é€‰æ‹©æ¥é…ç½®çš„ Spring Boot åº”ç”¨ç¨‹åºå­˜æ¡£ã€‚</p></li> <li><p>è§£å‹ ZIP æ–‡ä»¶åå¯¼å…¥æˆ‘ä»¬çš„ IDE ä¸­å³å¯ã€‚</p></li></ol> <p><strong>æ³¨ï¼šå¦‚æœæˆ‘ä»¬çš„ IDE å…·æœ‰ Spring Initializr é›†æˆï¼Œå¯ä»¥ç›´æ¥ä» IDE ä¸­å®Œæˆæ­¤è¿‡ç¨‹</strong></p> <h2 id="é¡¹ç›®é…ç½®å’Œæ¡†æ¶é›†æˆ"><a href="#é¡¹ç›®é…ç½®å’Œæ¡†æ¶é›†æˆ" class="header-anchor">#</a> é¡¹ç›®é…ç½®å’Œæ¡†æ¶é›†æˆ</h2> <h3 id="åŒ…ç»“æ„åˆ›å»º"><a href="#åŒ…ç»“æ„åˆ›å»º" class="header-anchor">#</a> åŒ…ç»“æ„åˆ›å»º</h3> <p>åœ¨é¡¹ç›® src/main/java ä¸‹é¢åˆ›å»ºå¦‚ä¸‹çš„åŒ…ç»“æ„ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>io
 +- github
     +- xxyopen   
        +- novel
            +- NovelApplication.java -- é¡¹ç›®å¯åŠ¨ç±»
            |
            +- core -- é¡¹ç›®æ ¸å¿ƒæ¨¡å—ï¼ŒåŒ…æ‹¬å„ç§å·¥å…·ã€é…ç½®å’Œå¸¸é‡ç­‰
            |   +- common -- ä¸šåŠ¡æ— å…³çš„é€šç”¨æ¨¡å—
            |   |   +- exception -- é€šç”¨å¼‚å¸¸å¤„ç†
            |   |   +- constant -- é€šç”¨å¸¸é‡   
            |   |   +- req -- é€šç”¨è¯·æ±‚æ•°æ®æ ¼å¼å°è£…ï¼Œä¾‹å¦‚åˆ†é¡µè¯·æ±‚æ•°æ®  
            |   |   +- resp -- æ¥å£å“åº”å·¥å…·åŠå“åº”æ•°æ®æ ¼å¼å°è£… 
            |   |   +- util -- é€šç”¨å·¥å…·   
            |   | 
            |   +- auth -- ç”¨æˆ·è®¤è¯æˆæƒç›¸å…³
            |   +- config -- ä¸šåŠ¡ç›¸å…³é…ç½®
            |   +- constant -- ä¸šåŠ¡ç›¸å…³å¸¸é‡         
            |   +- filter -- è¿‡æ»¤å™¨ 
            |   +- interceptor -- æ‹¦æˆªå™¨
            |   +- task -- å®šæ—¶ä»»åŠ¡
            |   +- util -- ä¸šåŠ¡ç›¸å…³å·¥å…· 
            |   +- wrapper -- è£…é¥°å™¨
            |
            +- dto -- æ•°æ®ä¼ è¾“å¯¹è±¡ï¼ŒåŒ…æ‹¬å¯¹å„ç§ Http è¯·æ±‚å’Œå“åº”æ•°æ®çš„å°è£…
            |   +- req -- Http è¯·æ±‚æ•°æ®å°è£…
            |   +- resp -- Http å“åº”æ•°æ®å°è£…
            |
            +- dao -- æ•°æ®è®¿é—®å±‚ï¼Œä¸åº•å±‚ MySQL è¿›è¡Œæ•°æ®äº¤äº’
            +- manager -- é€šç”¨ä¸šåŠ¡å¤„ç†å±‚ï¼Œå¯¹ç¬¬ä¸‰æ–¹å¹³å°å°è£…ã€å¯¹ Service å±‚é€šç”¨èƒ½åŠ›çš„ä¸‹æ²‰ä»¥åŠå¯¹å¤šä¸ª DAO çš„ç»„åˆå¤ç”¨ 
            +- service -- ç›¸å¯¹å…·ä½“çš„ä¸šåŠ¡é€»è¾‘æœåŠ¡å±‚  
            +- controller -- ä¸»è¦æ˜¯å¤„ç†å„ç§ Http è¯·æ±‚ï¼Œå„ç±»åŸºæœ¬å‚æ•°æ ¡éªŒï¼Œæˆ–è€…ä¸å¤ç”¨çš„ä¸šåŠ¡ç®€å•å¤„ç†ï¼Œè¿”å› JSON æ•°æ®ç­‰
            |   +- front -- å°è¯´é—¨æˆ·ç›¸å…³æ¥å£
            |   +- author -- ä½œå®¶ç®¡ç†åå°ç›¸å…³æ¥å£
            |   +- admin -- å¹³å°ç®¡ç†åå°ç›¸å…³æ¥å£
            |   +- app -- app æ¥å£
            |   +- applet -- å°ç¨‹åºæ¥å£
            |   +- open -- å¼€æ”¾æ¥å£ï¼Œä¾›ç¬¬ä¸‰æ–¹è°ƒç”¨ 
</code></pre></div><h3 id="é€šç”¨è¯·æ±‚-å“åº”æ•°æ®æ ¼å¼å°è£…"><a href="#é€šç”¨è¯·æ±‚-å“åº”æ•°æ®æ ¼å¼å°è£…" class="header-anchor">#</a> é€šç”¨è¯·æ±‚/å“åº”æ•°æ®æ ¼å¼å°è£…</h3> <ol><li>åœ¨<code>io.github.xxyopen.novel.core.common.req</code>åŒ…ä¸‹åˆ›å»ºåˆ†é¡µè¯·æ±‚æ•°æ®æ ¼å¼å°è£…ç±»ï¼š</li></ol> <div class="language- extra-class"><pre class="language-text"><code>/**
 * åˆ†é¡µè¯·æ±‚æ•°æ®æ ¼å¼å°è£…ï¼Œæ‰€æœ‰åˆ†é¡µè¯·æ±‚çš„ Dto ç±»éƒ½åº”ç»§æ‰¿è¯¥ç±»
 *
 * @author xiongxiaoyang
 * @date 2022/5/11
 */
@Data
public class PageReqDto {

    /**
     * è¯·æ±‚é¡µç ï¼Œé»˜è®¤ç¬¬ 1 é¡µ
     * */
    private int pageNum = 1;

    /**
     * æ¯é¡µå¤§å°ï¼Œé»˜è®¤æ¯é¡µ 10 æ¡
     * */
    private int pageSize = 10;

    /**
     * æ˜¯å¦æŸ¥è¯¢æ‰€æœ‰ï¼Œé»˜è®¤ä¸æŸ¥æ‰€æœ‰
     * ä¸º true æ—¶ï¼ŒpageNum å’Œ pageSize æ— æ•ˆ
     * */
    private boolean fetchAll = false;
    
}
</code></pre></div><ol start="2"><li>åœ¨<code>io.github.xxyopen.novel.core.common.resp</code>åŒ…ä¸‹åˆ›å»ºåˆ†é¡µå“åº”æ•°æ®æ ¼å¼å°è£…ç±»ï¼š</li></ol> <div class="language- extra-class"><pre class="language-text"><code>/**
 * åˆ†é¡µå“åº”æ•°æ®æ ¼å¼å°è£…
 *
 * @author xiongxiaoyang
 * @date 2022/5/11
 */
@Getter
public class PageRespDto&lt;T&gt; {

    /**
     * é¡µç 
     */
    private final long pageNum;

    /**
     * æ¯é¡µå¤§å°
     */
    private final long pageSize;

    /**
     * æ€»è®°å½•æ•°
     */
    private final long total;

    /**
     * åˆ†é¡µæ•°æ®é›†
     */
    private final List&lt;? extends T&gt; list;

    /**
     * è¯¥æ„é€ å‡½æ•°ç”¨äºé€šç”¨åˆ†é¡µæŸ¥è¯¢çš„åœºæ™¯
     * æ¥æ”¶æ™®é€šåˆ†é¡µæ•°æ®å’Œæ™®é€šé›†åˆ
     */
    public PageRespDto(long pageNum, long pageSize, long total, List&lt;T&gt; list) {
        this.pageNum = pageNum;
        this.pageSize = pageSize;
        this.total = total;
        this.list = list;
    }

    public static &lt;T&gt; PageRespDto&lt;T&gt; of(long pageNum, long pageSize, long total, List&lt;T&gt; list) {
        return new PageRespDto&lt;&gt;(pageNum, pageSize, total, list);
    }

    /**
     * è·å–åˆ†é¡µæ•°
     * */
    public long getPages() {
        if (this.pageSize == 0L) {
            return 0L;
        } else {
            long pages = this.total / this.pageSize;
            if (this.total % this.pageSize != 0L) {
                ++pages;
            }

            return pages;
        }
    }
}
</code></pre></div><h3 id="rest-æ¥å£å“åº”å·¥å…·åŠå“åº”æ•°æ®æ ¼å¼å°è£…"><a href="#rest-æ¥å£å“åº”å·¥å…·åŠå“åº”æ•°æ®æ ¼å¼å°è£…" class="header-anchor">#</a> Rest æ¥å£å“åº”å·¥å…·åŠå“åº”æ•°æ®æ ¼å¼å°è£…</h3> <ol><li>åœ¨<code>io.github.xxyopen.novel.core.common.constant</code>åŒ…ä¸‹åˆ›å»ºé”™è¯¯ç æšä¸¾ç±»ï¼š</li></ol> <div class="language- extra-class"><pre class="language-text"><code>/**
 * é”™è¯¯ç æšä¸¾ç±»ã€‚
 *
 * é”™è¯¯ç ä¸ºå­—ç¬¦ä¸²ç±»å‹ï¼Œå…± 5 ä½ï¼Œåˆ†æˆä¸¤ä¸ªéƒ¨åˆ†ï¼šé”™è¯¯äº§ç”Ÿæ¥æº+å››ä½æ•°å­—ç¼–å·ã€‚
 * é”™è¯¯äº§ç”Ÿæ¥æºåˆ†ä¸º A/B/Cï¼Œ A è¡¨ç¤ºé”™è¯¯æ¥æºäºç”¨æˆ·ï¼Œæ¯”å¦‚å‚æ•°é”™è¯¯ï¼Œç”¨æˆ·å®‰è£…ç‰ˆæœ¬è¿‡ä½ï¼Œç”¨æˆ·æ”¯ä»˜
 * è¶…æ—¶ç­‰é—®é¢˜ï¼› B è¡¨ç¤ºé”™è¯¯æ¥æºäºå½“å‰ç³»ç»Ÿï¼Œå¾€å¾€æ˜¯ä¸šåŠ¡é€»è¾‘å‡ºé”™ï¼Œæˆ–ç¨‹åºå¥å£®æ€§å·®ç­‰é—®é¢˜ï¼› C è¡¨ç¤ºé”™è¯¯æ¥æº
 * äºç¬¬ä¸‰æ–¹æœåŠ¡ï¼Œæ¯”å¦‚ CDN æœåŠ¡å‡ºé”™ï¼Œæ¶ˆæ¯æŠ•é€’è¶…æ—¶ç­‰é—®é¢˜ï¼›å››ä½æ•°å­—ç¼–å·ä» 0001 åˆ° 9999ï¼Œå¤§ç±»ä¹‹é—´çš„
 * æ­¥é•¿é—´è·é¢„ç•™ 100ã€‚
 *
 * é”™è¯¯ç åˆ†ä¸ºä¸€çº§å®è§‚é”™è¯¯ç ã€äºŒçº§å®è§‚é”™è¯¯ç ã€ä¸‰çº§å®è§‚é”™è¯¯ç ã€‚
 * åœ¨æ— æ³•æ›´åŠ å…·ä½“ç¡®å®šçš„é”™è¯¯åœºæ™¯ä¸­ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ä¸€çº§å®è§‚é”™è¯¯ç ã€‚
 *
 * @author xiongxiaoyang
 * @date 2022/5/11
 */
@Getter
@AllArgsConstructor
public enum ErrorCodeEnum {

    /**
     * æ­£ç¡®æ‰§è¡Œåçš„è¿”å›
     * */
    OK(&quot;00000&quot;,&quot;ä¸€åˆ‡ ok&quot;),

    /**
     * ä¸€çº§å®è§‚é”™è¯¯ç ï¼Œç”¨æˆ·ç«¯é”™è¯¯
     * */
    USER_ERROR(&quot;A0001&quot;,&quot;ç”¨æˆ·ç«¯é”™è¯¯&quot;),

    /**
     * äºŒçº§å®è§‚é”™è¯¯ç ï¼Œç”¨æˆ·æ³¨å†Œé”™è¯¯
     * */
    USER_REGISTER_ERROR(&quot;A0100&quot;,&quot;ç”¨æˆ·æ³¨å†Œé”™è¯¯&quot;),

    /**
     * äºŒçº§å®è§‚é”™è¯¯ç ï¼Œç”¨æˆ·æœªåŒæ„éšç§åè®®
     * */
    USER_NO_AGREE_PRIVATE_ERROR(&quot;A0101&quot;,&quot;ç”¨æˆ·æœªåŒæ„éšç§åè®®&quot;),

    /**
     * äºŒçº§å®è§‚é”™è¯¯ç ï¼Œæ³¨å†Œå›½å®¶æˆ–åœ°åŒºå—é™
     * */
    USER_REGISTER_AREA_LIMIT_ERROR(&quot;A0102&quot;,&quot;æ³¨å†Œå›½å®¶æˆ–åœ°åŒºå—é™&quot;),

    /**
     * äºŒçº§å®è§‚é”™è¯¯ç ï¼Œç”¨æˆ·è¯·æ±‚å‚æ•°é”™è¯¯
     * */
    USER_REQUEST_PARAM_ERROR(&quot;A0400&quot;,&quot;ç”¨æˆ·è¯·æ±‚å‚æ•°é”™è¯¯&quot;),

    // ...çœç•¥è‹¥å¹²ç”¨æˆ·ç«¯äºŒçº§å®è§‚é”™è¯¯ç 

    /**
     * ä¸€çº§å®è§‚é”™è¯¯ç ï¼Œç³»ç»Ÿæ‰§è¡Œå‡ºé”™
     * */
    SYSTEM_ERROR(&quot;B0001&quot;,&quot;ç³»ç»Ÿæ‰§è¡Œå‡ºé”™&quot;),

    /**
     * äºŒçº§å®è§‚é”™è¯¯ç ï¼Œç³»ç»Ÿæ‰§è¡Œè¶…æ—¶
     * */
    SYSTEM_TIMEOUT_ERROR(&quot;B0100&quot;,&quot;ç³»ç»Ÿæ‰§è¡Œè¶…æ—¶&quot;),

    // ...çœç•¥è‹¥å¹²ç³»ç»Ÿæ‰§è¡ŒäºŒçº§å®è§‚é”™è¯¯ç 

    /**
     * ä¸€çº§å®è§‚é”™è¯¯ç ï¼Œè°ƒç”¨ç¬¬ä¸‰æ–¹æœåŠ¡å‡ºé”™
     * */
    THIRD_SERVICE_ERROR(&quot;C0001&quot;,&quot;è°ƒç”¨ç¬¬ä¸‰æ–¹æœåŠ¡å‡ºé”™&quot;),

    /**
     * ä¸€çº§å®è§‚é”™è¯¯ç ï¼Œä¸­é—´ä»¶æœåŠ¡å‡ºé”™
     * */
    MIDDLEWARE_SERVICE_ERROR(&quot;C0100&quot;,&quot;ä¸­é—´ä»¶æœåŠ¡å‡ºé”™&quot;)

    // ...çœç•¥è‹¥å¹²ä¸‰æ–¹æœåŠ¡è°ƒç”¨äºŒçº§å®è§‚é”™è¯¯ç     

    ;

    /**
     * é”™è¯¯ç 
     * */
    private String code;

    /**
     * ä¸­æ–‡æè¿°
     * */
    private String message;

}
</code></pre></div><ol start="2"><li>åœ¨<code>io.github.xxyopen.novel.core.common.resp</code>åŒ…ä¸‹åˆ›å»º Http Rest å“åº”å·¥å…·åŠæ•°æ®æ ¼å¼å°è£…ç±»ï¼š</li></ol> <div class="language- extra-class"><pre class="language-text"><code>/**
 * Http Rest å“åº”å·¥å…·åŠæ•°æ®æ ¼å¼å°è£…
 *
 * @author xiongxiaoyang
 * @date 2022/5/11
 */
@Getter
public class RestResp&lt;T&gt; {

    /**
     * å“åº”ç 
     */
    private String code;

    /**
     * å“åº”æ¶ˆæ¯
     */
    private String message;

    /**
     * å“åº”æ•°æ®
     */
    private T data;

    private RestResp() {
        this.code = ErrorCodeEnum.OK.getCode();
        this.message = ErrorCodeEnum.OK.getMessage();
    }

    private RestResp(ErrorCodeEnum errorCode) {
        this.code = errorCode.getCode();
        this.message = errorCode.getMessage();
    }

    private RestResp(T data) {
        this.data = data;
    }

    /**
     * ä¸šåŠ¡å¤„ç†æˆåŠŸ,æ— æ•°æ®è¿”å›
     */
    public static RestResp&lt;Void&gt; ok() {
        return new RestResp&lt;&gt;();
    }

    /**
     * ä¸šåŠ¡å¤„ç†æˆåŠŸï¼Œæœ‰æ•°æ®è¿”å›
     */
    public static &lt;T&gt; RestResp&lt;T&gt; ok(T data) {
        return new RestResp&lt;&gt;(data);
    }

    /**
     * ä¸šåŠ¡å¤„ç†å¤±è´¥
     */
    public static RestResp&lt;Void&gt; fail(ErrorCodeEnum errorCode) {
        return new RestResp&lt;&gt;(errorCode);
    }

    /**
     * ç³»ç»Ÿé”™è¯¯
     */
    public static RestResp&lt;Void&gt; error() {
        return new RestResp&lt;&gt;(ErrorCodeEnum.SYSTEM_ERROR);
    }

    /**
     * åˆ¤æ–­æ˜¯å¦æˆåŠŸ
     */
    public boolean isOk() {
        return Objects.equals(this.code, ErrorCodeEnum.OK.getCode());
    }
    
}
</code></pre></div><h3 id="é€šç”¨å¼‚å¸¸å¤„ç†"><a href="#é€šç”¨å¼‚å¸¸å¤„ç†" class="header-anchor">#</a> é€šç”¨å¼‚å¸¸å¤„ç†</h3> <p>åœ¨ Spring 3.2 ä¸­ï¼Œæ–°å¢äº† <a href="https://docs.spring.io/spring-framework/docs/6.0.0-SNAPSHOT/javadoc-api/org/springframework/web/bind/annotation/ControllerAdvice.html" target="_blank" rel="noopener noreferrer">@ControllerAdvice<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æ³¨è§£ï¼Œç”¨äºå®šä¹‰é€‚ç”¨äºæ‰€æœ‰ @RequestMapping æ–¹æ³•çš„ @ExceptionHandlerã€@InitBinder å’Œ @ModelAttribute æ–¹æ³•ã€‚Spring Boot é»˜è®¤æƒ…å†µä¸‹ä¼šæ˜ å°„åˆ° /error è¿›è¡Œå¼‚å¸¸å¤„ç†ï¼Œä½†æ˜¯æç¤ºååˆ†ä¸å‹å¥½ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¯¥æ³¨è§£å®šä¹‰ @ExceptionHandler æ–¹æ³•æ¥æ•è· Controller æŠ›å‡ºçš„é€šç”¨å¼‚å¸¸ï¼Œå¹¶ç»Ÿä¸€è¿›è¡Œå¤„ç†ã€‚</p> <ol><li>åœ¨<code>io.github.xxyopen.novel.core.common.exception</code>åŒ…ä¸‹åˆ›å»ºè‡ªå®šä¹‰ä¸šåŠ¡å¼‚å¸¸ç±»ï¼š</li></ol> <div class="language- extra-class"><pre class="language-text"><code>/**
 * è‡ªå®šä¹‰ä¸šåŠ¡å¼‚å¸¸ï¼Œç”¨äºå¤„ç†ç”¨æˆ·è¯·æ±‚æ—¶ï¼Œä¸šåŠ¡é”™è¯¯æ—¶æŠ›å‡º
 *
 * @author xiongxiaoyang
 * @date 2022/5/11
 */
@EqualsAndHashCode(callSuper = true)
@Data
public class BusinessException extends RuntimeException {

    private final ErrorCodeEnum errorCodeEnum;

    public BusinessException(ErrorCodeEnum errorCodeEnum) {
        // ä¸è°ƒç”¨çˆ¶ç±» Throwableçš„fillInStackTrace() æ–¹æ³•ç”Ÿæˆæ ˆè¿½è¸ªä¿¡æ¯ï¼Œæé«˜åº”ç”¨æ€§èƒ½
        // æ„é€ å™¨ä¹‹é—´çš„è°ƒç”¨å¿…é¡»åœ¨ç¬¬ä¸€è¡Œ
        super(errorCodeEnum.getMessage(), null, false, false);
        this.errorCodeEnum = errorCodeEnum;
    }

}
</code></pre></div><ol start="2"><li>åœ¨<code>io.github.xxyopen.novel.core.common.exception</code>åŒ…ä¸‹åˆ›å»ºé€šç”¨å¼‚å¸¸å¤„ç†å™¨ï¼Œå¤„ç†ç³»ç»Ÿå¼‚å¸¸ã€æ•°æ®æ ¡éªŒå¼‚å¸¸å’Œæˆ‘ä»¬è‡ªå®šä¹‰çš„ä¸šåŠ¡å¼‚å¸¸ï¼š</li></ol> <div class="language- extra-class"><pre class="language-text"><code>/**
 * é€šç”¨çš„å¼‚å¸¸å¤„ç†å™¨
 *
 * @author xiongxiaoyang
 * @date 2022/5/11
 */
@Slf4j
@RestControllerAdvice
public class CommonExceptionHandler {

    /**
     * å¤„ç†æ•°æ®æ ¡éªŒå¼‚å¸¸
     * */
    @ExceptionHandler(BindException.class)
    public RestResp&lt;Void&gt; handlerBindException(BindException e){
        log.error(e.getMessage(),e);
        return RestResp.fail(ErrorCodeEnum.USER_REQUEST_PARAM_ERROR);
    }

    /**
     * å¤„ç†ä¸šåŠ¡å¼‚å¸¸
     * */
    @ExceptionHandler(BusinessException.class)
    public RestResp&lt;Void&gt; handlerBusinessException(BusinessException e){
        log.error(e.getMessage(),e);
        return RestResp.fail(e.getErrorCodeEnum());
    }

    /**
     * å¤„ç†ç³»ç»Ÿå¼‚å¸¸
     * */
    @ExceptionHandler(Exception.class)
    public RestResp&lt;Void&gt; handlerException(Exception e){
        log.error(e.getMessage(),e);
        return RestResp.error();
    }

}
</code></pre></div><h3 id="å¸¸é‡ç±»åˆ›å»º"><a href="#å¸¸é‡ç±»åˆ›å»º" class="header-anchor">#</a> å¸¸é‡ç±»åˆ›å»º</h3> <ol><li>åœ¨<code>io.github.xxyopen.novel.core.common.constant</code>åŒ…ä¸‹åˆ›å»ºé€šç”¨å¸¸é‡ç±»å’Œ API è·¯ç”±å¸¸é‡ç±»</li></ol> <div class="language- extra-class"><pre class="language-text"><code>/**
 * é€šç”¨å¸¸é‡
 *
 * @author xiongxiaoyang
 * @date 2022/5/12
 */
public class CommonConsts {

    /**
     * æ˜¯
     * */
    public static final Integer YES = 1;

    /**
     * å¦
     * */
    public static final Integer NO = 0;

    /**
     * æ€§åˆ«å¸¸é‡
     * */
    public enum SexEnum{

        /**
         * ç”·
         * */
        MALE(0,&quot;ç”·&quot;),

        /**
         * å¥³
         * */
        FEMALE(1,&quot;å¥³&quot;);

        SexEnum(int code,String desc){
            this.code = code;
            this.desc = desc;
        }

        private int code;
        private String desc;

        public int getCode() {
            return code;
        }

        public String getDesc() {
            return desc;
        }

    }

    // ...çœç•¥è‹¥å¹²å¸¸é‡
}
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>/**
 * API è·¯ç”±å¸¸é‡
 *
 * @author xiongxiaoyang
 * @date 2022/5/12
 */
public class ApiRouterConsts {

    /**
     * APIè¯·æ±‚è·¯å¾„å‰ç¼€
     */
    String API_URL_PREFIX = &quot;/api&quot;;

    /**
     * å‰å°é—¨æˆ·ç³»ç»Ÿè¯·æ±‚è·¯å¾„å‰ç¼€
     */
    String API_FRONT_URL_PREFIX = API_URL_PREFIX + &quot;/front&quot;;

    /**
     * ä½œå®¶ç®¡ç†ç³»ç»Ÿè¯·æ±‚è·¯å¾„å‰ç¼€
     */
    String API_AUTHOR_URL_PREFIX = API_URL_PREFIX + &quot;/author&quot;;

    /**
     * å¹³å°åå°ç®¡ç†ç³»ç»Ÿè¯·æ±‚è·¯å¾„å‰ç¼€
     */
    String API_ADMIN_URL_PREFIX = API_URL_PREFIX + &quot;/admin&quot;;

    /**
     * é¦–é¡µæ¨¡å—è¯·æ±‚è·¯å¾„å‰ç¼€
     * */
    String HOME_URL_PREFIX = &quot;/home&quot;;

    /**
     * å°è¯´æ¨¡å—è¯·æ±‚è·¯å¾„å‰ç¼€
     * */
    String BOOK_URL_PREFIX = &quot;/book&quot;;

    /**
     * ä¼šå‘˜æ¨¡å—è¯·æ±‚è·¯å¾„å‰ç¼€
     * */
    String USER_URL_PREFIX = &quot;/user&quot;;

    /**
     * å‰å°é—¨æˆ·é¦–é¡µAPIè¯·æ±‚è·¯å¾„å‰ç¼€
     */
    String API_FRONT_HOME_URL_PREFIX = API_FRONT_URL_PREFIX + HOME_URL_PREFIX;

    /**
     * å‰å°é—¨æˆ·å°è¯´ç›¸å…³APIè¯·æ±‚è·¯å¾„å‰ç¼€
     */
    String API_FRONT_BOOK_URL_PREFIX = API_FRONT_URL_PREFIX + BOOK_URL_PREFIX;

    /**
     * å‰å°é—¨æˆ·ä¼šå‘˜ç›¸å…³APIè¯·æ±‚è·¯å¾„å‰ç¼€
     */
    String API_FRONT_USER_URL_PREFIX = API_FRONT_URL_PREFIX + USER_URL_PREFIX;

    // ...çœç•¥è‹¥å¹²å¸¸é‡

}
</code></pre></div><ol start="2"><li>åœ¨<code>io.github.xxyopen.novel.core.constant</code>åŒ…ä¸‹åˆ›å»ºç¼“å­˜å¸¸é‡ç±»</li></ol> <div class="language- extra-class"><pre class="language-text"><code>/**
 * ç¼“å­˜ç›¸å…³å¸¸é‡
 *
 * @author xiongxiaoyang
 * @date 2022/5/12
 */
public class CacheConsts {

    /**
     * æœ¬é¡¹ç›® Redis ç¼“å­˜å‰ç¼€
     * */
    public static final String REDIS_CACHE_PREFIX = &quot;Cache::Novel::&quot;;


    /**
     * Caffeine ç¼“å­˜ç®¡ç†å™¨
     * */
    public static final String CAFFEINE_CACHE_MANAGER = &quot;caffeineCacheManager&quot;;

    /**
     * Redis ç¼“å­˜ç®¡ç†å™¨
     * */
    public static final String REDIS_CACHE_MANAGER = &quot;redisCacheManager&quot;;

    /**
     * é¦–é¡µå°è¯´æ¨èç¼“å­˜
     * */
    public static final String HOME_BOOK_CACHE_NAME = &quot;homeBookCache&quot;;

    /**
     * é¦–é¡µå‹æƒ…é“¾æ¥ç¼“å­˜
     * */
    public static final String HOME_FRIEND_LINK_CACHE_NAME = &quot;homeFriendLinkCache&quot;;

    /**
     * ç¼“å­˜é…ç½®å¸¸é‡
     */
    public enum CacheEnum {

        HOME_BOOK_CACHE(1,HOME_BOOK_CACHE_NAME,0,1),

        HOME_FRIEND_LINK_CACHE(2,HOME_FRIEND_LINK_CACHE_NAME,1000,1)

        ;

        /**
         * ç¼“å­˜ç±»å‹ 0-æœ¬åœ° 1-æœ¬åœ°å’Œè¿œç¨‹ 2-è¿œç¨‹
         */
        private int type;
        /**
         * ç¼“å­˜çš„åå­—
         */
        private String name;
        /**
         * å¤±æ•ˆæ—¶é—´ï¼ˆç§’ï¼‰ 0-æ°¸ä¸å¤±æ•ˆ
         */
        private int ttl;
        /**
         * æœ€å¤§å®¹é‡
         */
        private int maxSize;

        CacheEnum(int type, String name, int ttl, int maxSize) {
            this.type = type;
            this.name = name;
            this.ttl = ttl;
            this.maxSize = maxSize;
        }

        public boolean isLocal() {
            return type &lt;= 1;
        }

        public boolean isRemote() {
            return type &gt;= 1;
        }

        public String getName() {
            return name;
        }

        public int getTtl() {
            return ttl;
        }

        public int getMaxSize() {
            return maxSize;
        }

    }

}
</code></pre></div><h3 id="æ—¥å¿—é…ç½®"><a href="#æ—¥å¿—é…ç½®" class="header-anchor">#</a> æ—¥å¿—é…ç½®</h3> <p>Spring Boot é»˜è®¤ä½¿ç”¨çš„æ˜¯ Logback æ—¥å¿—å®ç°ï¼Œä¼šè‡ªåŠ¨è¯»å–ç±»è·¯å¾„ä¸‹çš„ logback-spring.xml, logback-spring.groovy, logback.xml, æˆ– logback.groovy é…ç½®æ–‡ä»¶ã€‚</p> <p>æˆ‘ä»¬åœ¨é¡¹ç›® src/resource ä¸‹é¢æ·»åŠ å¦‚ä¸‹å†…å®¹çš„æ—¥å¿—é…ç½®æ–‡ä»¶ logback-spring.xml å³å¯ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;configuration&gt;
    &lt;!-- å½©è‰²æ—¥å¿—ä¾èµ–çš„æ¸²æŸ“ç±» --&gt;
    &lt;conversionRule conversionWord=&quot;clr&quot; converterClass=&quot;org.springframework.boot.logging.logback.ColorConverter&quot;/&gt;
    &lt;conversionRule conversionWord=&quot;wex&quot;
                    converterClass=&quot;org.springframework.boot.logging.logback.WhitespaceThrowableProxyConverter&quot;/&gt;
    &lt;conversionRule conversionWord=&quot;wEx&quot;
                    converterClass=&quot;org.springframework.boot.logging.logback.ExtendedWhitespaceThrowableProxyConverter&quot;/&gt;
    &lt;!-- å½©è‰²æ—¥å¿—æ ¼å¼ --&gt;
    &lt;property name=&quot;CONSOLE_LOG_PATTERN&quot;
              value=&quot;${CONSOLE_LOG_PATTERN:-%clr(%d{yyyy-MM-dd HH:mm:ss.SSS}){faint} %clr(${LOG_LEVEL_PATTERN:-%5p}) %clr(${PID:- }){magenta} %clr(---){faint} %clr([%15.15t]){faint} %clr(%-40.40logger{39}){cyan} %clr(:){faint} %m%n${LOG_EXCEPTION_CONVERSION_WORD:-%wEx}}&quot;/&gt;

    &lt;!-- %mè¾“å‡ºçš„ä¿¡æ¯,%pæ—¥å¿—çº§åˆ«,%tçº¿ç¨‹å,%dæ—¥æœŸ,%cç±»çš„å…¨å,%iç´¢å¼•ã€ä»æ•°å­—0å¼€å§‹é€’å¢ã€‘,,, --&gt;
    &lt;!-- appenderæ˜¯configurationçš„å­èŠ‚ç‚¹ï¼Œæ˜¯è´Ÿè´£å†™æ—¥å¿—çš„ç»„ä»¶ã€‚ --&gt;
    &lt;!-- ConsoleAppenderï¼šæŠŠæ—¥å¿—è¾“å‡ºåˆ°æ§åˆ¶å° --&gt;
    &lt;appender name=&quot;STDOUT&quot; class=&quot;ch.qos.logback.core.ConsoleAppender&quot;&gt;
        &lt;encoder&gt;
            &lt;!--
            &lt;pattern&gt;%d %p (%file:%line\)- %m%n&lt;/pattern&gt;
             --&gt;
            &lt;pattern&gt;${CONSOLE_LOG_PATTERN}&lt;/pattern&gt;
            &lt;!-- æ§åˆ¶å°ä¹Ÿè¦ä½¿ç”¨UTF-8ï¼Œä¸è¦ä½¿ç”¨GBKï¼Œå¦åˆ™ä¼šä¸­æ–‡ä¹±ç  --&gt;
            &lt;charset&gt;UTF-8&lt;/charset&gt;
        &lt;/encoder&gt;
    &lt;/appender&gt;

    &lt;!-- RollingFileAppenderï¼šæ»šåŠ¨è®°å½•æ–‡ä»¶ï¼Œå…ˆå°†æ—¥å¿—è®°å½•åˆ°æŒ‡å®šæ–‡ä»¶ï¼Œå½“ç¬¦åˆæŸä¸ªæ¡ä»¶æ—¶ï¼Œå°†æ—¥å¿—è®°å½•åˆ°å…¶ä»–æ–‡ä»¶ --&gt;
    &lt;!-- ä»¥ä¸‹çš„å¤§æ¦‚æ„æ€æ˜¯ï¼š1.å…ˆæŒ‰æ—¥æœŸå­˜æ—¥å¿—ï¼Œæ—¥æœŸå˜äº†ï¼Œå°†å‰ä¸€å¤©çš„æ—¥å¿—æ–‡ä»¶åé‡å‘½åä¸ºXXX%æ—¥æœŸ%ç´¢å¼•ï¼Œæ–°çš„æ—¥å¿—ä»ç„¶æ˜¯demo.log --&gt;
    &lt;!-- 2.å¦‚æœæ—¥æœŸæ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œä½†æ˜¯å½“å‰æ—¥å¿—çš„æ–‡ä»¶å¤§å°è¶…è¿‡1KBæ—¶ï¼Œå¯¹å½“å‰æ—¥å¿—è¿›è¡Œåˆ†å‰² é‡å‘½å --&gt;
    &lt;appender name=&quot;FILE&quot; class=&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;&gt;

        &lt;File&gt;logs/novel.log&lt;/File&gt;
        &lt;!-- rollingPolicy:å½“å‘ç”Ÿæ»šåŠ¨æ—¶ï¼Œå†³å®š RollingFileAppender çš„è¡Œä¸ºï¼Œæ¶‰åŠæ–‡ä»¶ç§»åŠ¨å’Œé‡å‘½åã€‚ --&gt;
        &lt;!-- TimeBasedRollingPolicyï¼š æœ€å¸¸ç”¨çš„æ»šåŠ¨ç­–ç•¥ï¼Œå®ƒæ ¹æ®æ—¶é—´æ¥åˆ¶å®šæ»šåŠ¨ç­–ç•¥ï¼Œæ—¢è´Ÿè´£æ»šåŠ¨ä¹Ÿè´Ÿè´£å‡ºå‘æ»šåŠ¨ --&gt;
        &lt;rollingPolicy class=&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;&gt;
            &lt;!-- æ´»åŠ¨æ–‡ä»¶çš„åå­—ä¼šæ ¹æ®fileNamePatternçš„å€¼ï¼Œæ¯éš”ä¸€æ®µæ—¶é—´æ”¹å˜ä¸€æ¬¡ --&gt;
            &lt;!-- æ–‡ä»¶åï¼šlogs/demo.2017-12-05.0.log --&gt;
            &lt;fileNamePattern&gt;logs/debug.%d.%i.log&lt;/fileNamePattern&gt;
            &lt;!-- æ¯äº§ç”Ÿä¸€ä¸ªæ—¥å¿—æ–‡ä»¶ï¼Œè¯¥æ—¥å¿—æ–‡ä»¶çš„ä¿å­˜æœŸé™ä¸º30å¤© --&gt;
            &lt;maxHistory&gt;30&lt;/maxHistory&gt;
            &lt;timeBasedFileNamingAndTriggeringPolicy class=&quot;ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP&quot;&gt;
                &lt;!-- maxFileSize:è¿™æ˜¯æ´»åŠ¨æ–‡ä»¶çš„å¤§å°ï¼Œé»˜è®¤å€¼æ˜¯10MBï¼Œæµ‹è¯•æ—¶å¯æ”¹æˆ1KBçœ‹æ•ˆæœ --&gt;
                &lt;maxFileSize&gt;10MB&lt;/maxFileSize&gt;
            &lt;/timeBasedFileNamingAndTriggeringPolicy&gt;
        &lt;/rollingPolicy&gt;
        &lt;encoder&gt;
            &lt;!-- patternèŠ‚ç‚¹ï¼Œç”¨æ¥è®¾ç½®æ—¥å¿—çš„è¾“å…¥æ ¼å¼ --&gt;
            &lt;pattern&gt;
                %d %p (%file:%line\)- %m%n
            &lt;/pattern&gt;
            &lt;!-- è®°å½•æ—¥å¿—çš„ç¼–ç :æ­¤å¤„è®¾ç½®å­—ç¬¦é›† - --&gt;
            &lt;charset&gt;UTF-8&lt;/charset&gt;
        &lt;/encoder&gt;
    &lt;/appender&gt;
    &lt;springProfile name=&quot;dev&quot;&gt;
        &lt;!-- ROOT æ—¥å¿—çº§åˆ« --&gt;
        &lt;root level=&quot;INFO&quot;&gt;
            &lt;appender-ref ref=&quot;STDOUT&quot;/&gt;
        &lt;/root&gt;
        &lt;!-- æŒ‡å®šé¡¹ç›®ä¸­æŸä¸ªåŒ…ï¼Œå½“æœ‰æ—¥å¿—æ“ä½œè¡Œä¸ºæ—¶çš„æ—¥å¿—è®°å½•çº§åˆ« --&gt;
        &lt;!-- com.maijinjie.springboot ä¸ºæ ¹åŒ…ï¼Œä¹Ÿå°±æ˜¯åªè¦æ˜¯å‘ç”Ÿåœ¨è¿™ä¸ªæ ¹åŒ…ä¸‹é¢çš„æ‰€æœ‰æ—¥å¿—æ“ä½œè¡Œä¸ºçš„æƒé™éƒ½æ˜¯DEBUG --&gt;
        &lt;!-- çº§åˆ«ä¾æ¬¡ä¸ºã€ä»é«˜åˆ°ä½ã€‘ï¼šFATAL &gt; ERROR &gt; WARN &gt; INFO &gt; DEBUG &gt; TRACE --&gt;
        &lt;logger name=&quot;io.github.xxyopen&quot; level=&quot;DEBUG&quot; additivity=&quot;false&quot;&gt;
            &lt;appender-ref ref=&quot;STDOUT&quot;/&gt;
        &lt;/logger&gt;
    &lt;/springProfile&gt;

    &lt;springProfile name=&quot;prod&quot;&gt;
        &lt;!-- ROOT æ—¥å¿—çº§åˆ« --&gt;
        &lt;root level=&quot;INFO&quot;&gt;
            &lt;appender-ref ref=&quot;STDOUT&quot;/&gt;
            &lt;appender-ref ref=&quot;FILE&quot;/&gt;
        &lt;/root&gt;
        &lt;!-- æŒ‡å®šé¡¹ç›®ä¸­æŸä¸ªåŒ…ï¼Œå½“æœ‰æ—¥å¿—æ“ä½œè¡Œä¸ºæ—¶çš„æ—¥å¿—è®°å½•çº§åˆ« --&gt;
        &lt;!-- com.maijinjie.springboot ä¸ºæ ¹åŒ…ï¼Œä¹Ÿå°±æ˜¯åªè¦æ˜¯å‘ç”Ÿåœ¨è¿™ä¸ªæ ¹åŒ…ä¸‹é¢çš„æ‰€æœ‰æ—¥å¿—æ“ä½œè¡Œä¸ºçš„æƒé™éƒ½æ˜¯DEBUG --&gt;
        &lt;!-- çº§åˆ«ä¾æ¬¡ä¸ºã€ä»é«˜åˆ°ä½ã€‘ï¼šFATAL &gt; ERROR &gt; WARN &gt; INFO &gt; DEBUG &gt; TRACE --&gt;
        &lt;logger name=&quot;io.github.xxyopen&quot; level=&quot;ERROR&quot; additivity=&quot;false&quot;&gt;
            &lt;appender-ref ref=&quot;STDOUT&quot;/&gt;
            &lt;appender-ref ref=&quot;FILE&quot;/&gt;
        &lt;/logger&gt;
    &lt;/springProfile&gt;
&lt;/configuration&gt;
</code></pre></div><h3 id="è·¨åŸŸé…ç½®"><a href="#è·¨åŸŸé…ç½®" class="header-anchor">#</a> è·¨åŸŸé…ç½®</h3> <p>è·¨åŸŸæ˜¯æŒ‡æµè§ˆå™¨ä»ä¸€ä¸ªåŸŸåçš„ç½‘é¡µå»è¯·æ±‚å¦ä¸€ä¸ªåŸŸåçš„èµ„æºæ—¶ï¼ŒåŸŸåã€ç«¯å£ã€åè®®ä»»ä¸€ä¸åŒï¼Œéƒ½æ˜¯è·¨åŸŸã€‚åœ¨å‰åç«¯åˆ†ç¦»çš„æ¨¡å¼ä¸‹ï¼Œå‰åç«¯çš„åŸŸåæ˜¯ä¸ä¸€è‡´çš„ï¼Œæ­¤æ—¶å°±ä¼šå‘ç”Ÿè·¨åŸŸè®¿é—®é—®é¢˜ã€‚</p> <p>è·¨åŸŸæ˜¯å‡ºäºæµè§ˆå™¨çš„åŒæºç­–ç•¥é™åˆ¶ï¼ŒåŒæºç­–ç•¥ï¼ˆSameoriginpolicyï¼‰æ˜¯ä¸€ç§çº¦å®šï¼Œå®ƒæ˜¯æµè§ˆå™¨æœ€æ ¸å¿ƒä¹Ÿæœ€åŸºæœ¬çš„å®‰å…¨åŠŸèƒ½ï¼Œå¦‚æœç¼ºå°‘äº†åŒæºç­–ç•¥ï¼Œåˆ™æµè§ˆå™¨çš„æ­£å¸¸åŠŸèƒ½å¯èƒ½éƒ½ä¼šå—åˆ°å½±å“ã€‚</p> <p>æˆ‘ä»¬å¯ä»¥é€šè¿‡å‰ç«¯é…ç½®ã€åç«¯é…ç½®æˆ– nginx é…ç½®æ¥è§£å†³è·¨åŸŸé—®é¢˜ã€‚</p> <p>å¦‚æœé€‰æ‹©å‰ç«¯é…ç½®ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ node ä¸­é—´ä»¶ proxy é…ç½®è·¨åŸŸï¼Œå‰ç«¯é€šè¿‡ node proxy æ¥è½¬å‘æˆ‘ä»¬çš„æ¥å£è¯·æ±‚ï¼Œå’Œæµè§ˆå™¨ç›´æ¥æ‰“äº¤é“çš„æ˜¯ node proxyï¼Œè¿™æ ·å¯ä»¥é¿å…æµè§ˆå™¨çš„åŒæºç­–ç•¥ã€‚é…ç½®ç¤ºä¾‹å¦‚ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>proxy: {
  '/api': {
    target: 'http://localhost:8888',
    // è¯·æ±‚æ”¹å˜æºï¼Œæ­¤æ—¶ nginx å¯ä»¥è·å–åˆ°çœŸå®çš„è¯·æ±‚ ip
    changeOrigin: true
  }
}
</code></pre></div><p>å¦‚æœé€šè¿‡ nginx é…ç½®æ¥è§£å†³è·¨åŸŸé—®é¢˜ï¼Œæˆ‘ä»¬åœ¨é…ç½® location è·¯å¾„è½¬å‘æ—¶éœ€è¦åŠ ä¸Šå¦‚ä¸‹çš„é…ç½®ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code># å…è®¸çš„è¯·æ±‚å¤´
add_header 'Access-Control-Allow-Methods' 'GET,OPTIONS,POST,PUT,DELETE' always;
add_header 'Access-Control-Allow-Credentials' 'true' always;
add_header 'Access-Control-Allow-Origin' '$http_origin' always;
add_header Access-Control-Allow-Headers $http_access_control_request_headers;
add_header Access-Control-Max-Age 3600;
# å¤´è½¬å‘
proxy_set_header Host $host;
proxy_set_header X-Real-Ip $remote_addr;
proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
proxy_connect_timeout 1000;
proxy_read_timeout 1000;
# è·¨åŸŸé…ç½®
if ($request_method = OPTIONS ) { return 200; }
</code></pre></div><p>å› ä¸ºæˆ‘ä»¬é¡¹ç›®çš„ä¾§é‡ç‚¹åœ¨åç«¯ï¼Œè€Œä¸” Spring MVC æä¾›äº†è·¨åŸŸè§£å†³æ–¹æ¡ˆï¼ˆ<a href="https://en.wikipedia.org/wiki/Cross-origin_resource_sharing" target="_blank" rel="noopener noreferrer">CORS<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ï¼‰çš„æ”¯æŒã€‚æ‰€ä»¥æˆ‘ä»¬è¿™é‡Œé€šè¿‡åç«¯é…ç½®æ¥è§£å†³è·¨åŸŸé—®é¢˜ã€‚</p> <p>é¦–å…ˆæˆ‘ä»¬éœ€è¦åœ¨ application.yml é…ç½®æ–‡ä»¶ä¸­æ·»åŠ è·¨åŸŸç›¸å…³çš„é…ç½®ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code># é¡¹ç›®é…ç½®
novel:
  # è·¨åŸŸé…ç½®
  cors:
    # å…è®¸è·¨åŸŸçš„åŸŸå
    allow-origins:
      - http://localhost:1024
      - http://localhost:8080
</code></pre></div><p>ç„¶ååœ¨<code>io.github.xxyopen.novel.core.config</code>åŒ…ä¸‹åˆ›å»º CorsProperties ç±»æ¥ç»‘å®š CORS é…ç½®å±æ€§:</p> <div class="language- extra-class"><pre class="language-text"><code>/**
 * è·¨åŸŸé…ç½®å±æ€§
 *
 * @author xiongxiaoyang
 * @date 2022/5/17
 */
@ConfigurationProperties(prefix = &quot;novel.cors&quot;)
@Data
public class CorsProperties {

    /**
     * å…è®¸è·¨åŸŸçš„åŸŸå
     * */
    private List&lt;String&gt; allowOrigins;
}
</code></pre></div><p>æœ€ååœ¨<code>io.github.xxyopen.novel.core.config</code>åŒ…ä¸‹å¢åŠ å¦‚ä¸‹çš„ CORS é…ç½®ç±»ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>/**
 * è·¨åŸŸé…ç½®
 *
 * @author xiongxiaoyang
 * @date 2022/5/13
 */
@Configuration
@EnableConfigurationProperties(CorsProperties.class)
@RequiredArgsConstructor
public class CorsConfig {

    private final CorsProperties corsProperties;

    @Bean
    public CorsFilter corsFilter() {
        CorsConfiguration config = new CorsConfiguration();
        // å…è®¸çš„åŸŸ,ä¸è¦å†™*ï¼Œå¦åˆ™cookieå°±æ— æ³•ä½¿ç”¨äº†
        for (String allowOrigin : corsProperties.getAllowOrigins()) {
            config.addAllowedOrigin(allowOrigin);
        }
        // å…è®¸çš„å¤´ä¿¡æ¯
        config.addAllowedHeader(&quot;*&quot;);
        // å…è®¸çš„è¯·æ±‚æ–¹å¼
        config.addAllowedMethod(&quot;*&quot;);
        // æ˜¯å¦å…è®¸æºå¸¦Cookieä¿¡æ¯
        config.setAllowCredentials(true);

        UrlBasedCorsConfigurationSource configurationSource = new UrlBasedCorsConfigurationSource();
        // æ·»åŠ æ˜ å°„è·¯å¾„ï¼Œæ‹¦æˆªä¸€åˆ‡è¯·æ±‚
        configurationSource.registerCorsConfiguration(&quot;/**&quot;,config);
        return new CorsFilter(configurationSource);
    }
    
}
</code></pre></div><h3 id="mybatis-å¢å¼ºå·¥å…·-mybatis-plus-é›†æˆ"><a href="#mybatis-å¢å¼ºå·¥å…·-mybatis-plus-é›†æˆ" class="header-anchor">#</a> Mybatis å¢å¼ºå·¥å…· MyBatis-Plus é›†æˆ</h3> <p>[MyBatis-Plus] (https://baomidou.com)æ˜¯ä¸€ä¸ª MyBatis (https://www.mybatis.org/mybatis-3)çš„å¢å¼ºå·¥å…·ï¼Œåœ¨ MyBatis çš„åŸºç¡€ä¸Šåªåšå¢å¼ºä¸åšæ”¹å˜ï¼Œä¸ºç®€åŒ–å¼€å‘ã€æé«˜æ•ˆç‡è€Œç”Ÿã€‚æˆ‘ä»¬å¯ä»¥æŒ‰ç…§å¦‚ä¸‹æ­¥éª¤é›†æˆåˆ°æˆ‘ä»¬çš„é¡¹ç›®ä¸­ï¼š</p> <ol><li>æ·»åŠ  mybatis-plus çš„å¯åŠ¨å™¨ä¾èµ–</li></ol> <div class="language- extra-class"><pre class="language-text"><code>&lt;dependency&gt;
    &lt;groupId&gt;com.baomidou&lt;/groupId&gt;
    &lt;artifactId&gt;mybatis-plus-boot-starter&lt;/artifactId&gt;
    &lt;version&gt;3.5.1&lt;/version&gt;
&lt;/dependency&gt;
</code></pre></div><ol start="2"><li>é…ç½® MapperScan æ³¨è§£</li></ol> <div class="language- extra-class"><pre class="language-text"><code>@SpringBootApplication
@MapperScan(&quot;io.github.xxyopen.novel.dao.mapper&quot;)
public class NovelApplication {

	public static void main(String[] args) {
		SpringApplication.run(NovelApplication.class, args);
	}

}
</code></pre></div><ol start="3"><li>å› ä¸ºæˆ‘ä»¬ç³»ç»Ÿæ¶‰åŠåˆ†é¡µæ•°æ®æŸ¥è¯¢ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦åœ¨<code>io.github.xxyopen.novel.core.config</code>åŒ…ä¸‹é…ç½® mybatis-plus çš„åˆ†é¡µæ’ä»¶ï¼š</li></ol> <div class="language- extra-class"><pre class="language-text"><code>/**
 * Mybatis-Plus é…ç½®ç±»
 *
 * @author xiongxiaoyang
 * @date 2022/5/16
 */
@Configuration
public class MybatisPlusConfig {

    /**
     * åˆ†é¡µæ’ä»¶
     */
    @Bean
    public MybatisPlusInterceptor mybatisPlusInterceptor() {
        MybatisPlusInterceptor interceptor = new MybatisPlusInterceptor();
        interceptor.addInnerInterceptor(new PaginationInnerInterceptor(DbType.MYSQL));
        return interceptor;
    }

}
</code></pre></div><ol start="4"><li>æ•°æ®æºé…ç½®</li></ol> <p>YAML æ˜¯ JSON çš„è¶…é›†ï¼Œä¸€ç§ç”¨äºæŒ‡å®šåˆ†å±‚é…ç½®æ•°æ®çš„ä¾¿æ·æ ¼å¼ã€‚æœ¬é¡¹ç›®ä¸­æˆ‘ä»¬ç»Ÿä¸€ä½¿ç”¨ YAML æ ¼å¼çš„é…ç½®æ–‡ä»¶ï¼Œæ‰€ä»¥å…ˆå°† resources ç›®å½•ä¸‹çš„ application.properties æ–‡ä»¶é‡å‘½åä¸º application.ymlï¼Œ</p> <p>ç„¶ååœ¨ application.yml é…ç½®æ–‡ä»¶ä¸­åŠ å…¥ä»¥ä¸‹æ•°æ®æºé…ç½®ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>spring:
  datasource:
    url: jdbc:mysql://localhost:3306/novel?useUnicode=true&amp;characterEncoding=utf-8&amp;useSSL=false&amp;serverTimezone=Asia/Shanghai
    username: root
    password: test123456
</code></pre></div><p><strong>æ³¨ï¼šæ ¹æ®å®é™…çš„æ•°æ®åº“ç¯å¢ƒæ¥ä¿®æ”¹ç›¸åº”çš„IPã€ç«¯å£å·ã€æ•°æ®åº“åã€ç”¨æˆ·åå’Œå¯†ç </strong></p> <ol start="5"><li>ä¸ºäº†å…¼å®¹ Spring Boot 3ï¼ˆSpring 6ï¼‰ï¼Œåœ¨<code>org.springframework.core</code>åŒ…ä¸‹åˆ›å»º<code>NestedIOException</code>å¼‚å¸¸ç±»</li></ol> <div class="language- extra-class"><pre class="language-text"><code>/**
 * å…¼å®¹ mybatis-plus 3.5.1
 * mybatis-plus çš„ MybatisSqlSessionFactoryBean ä¸­ä½¿ç”¨åˆ°äº†è¿™ä¸ªå¼‚å¸¸
 * Spring 6 å¼€å§‹ç§»é™¤äº†è¯¥å¼‚å¸¸
 *
 * @author xiongxiaoyang
 * @date 2022/5/12
 */
public class NestedIOException extends IOException {

}
</code></pre></div><h3 id="ä»£ç ç”Ÿæˆå™¨-mybatis-plus-generator-é›†æˆ"><a href="#ä»£ç ç”Ÿæˆå™¨-mybatis-plus-generator-é›†æˆ" class="header-anchor">#</a> ä»£ç ç”Ÿæˆå™¨ Mybatis-Plus-Generator é›†æˆ</h3> <ol><li>æ·»åŠ ç›¸å…³ä¾èµ–</li></ol> <div class="language- extra-class"><pre class="language-text"><code>&lt;dependency&gt;
    &lt;groupId&gt;com.baomidou&lt;/groupId&gt;
    &lt;artifactId&gt;mybatis-plus-generator&lt;/artifactId&gt;
    &lt;version&gt;${mybatis-plus.version}&lt;/version&gt;
    &lt;scope&gt;test&lt;/scope&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.apache.velocity&lt;/groupId&gt;
    &lt;artifactId&gt;velocity-engine-core&lt;/artifactId&gt;
    &lt;version&gt;2.3&lt;/version&gt;
    &lt;scope&gt;test&lt;/scope&gt;
&lt;/dependency&gt;
</code></pre></div><ol start="2"><li>åœ¨ test/resources/templates ä¸‹é¢åˆ›å»ºä»¥ä¸‹æ¨¡ç‰ˆæ–‡ä»¶</li></ol> <p><img src="/img/novel/mybatisplusgen.png" alt="gen-templates"></p> <ol start="3"><li>åœ¨ test/java ä¸‹é¢åˆ›å»ºä»£ç ç”Ÿæˆå™¨ç±»</li></ol> <div class="language- extra-class"><pre class="language-text"><code>/**
 * ä»£ç ç”Ÿæˆå™¨
 *
 * @author xiongxiaoyang
 * @date 2022/5/11
 */
public class Generator {

    private static final String USERNAME = System.getenv().get(&quot;USER&quot;);

    /**
     * é¡¹ç›®ä¿¡æ¯
     */
    private static final String PROJECT_PATH = System.getProperty(&quot;user.dir&quot;);
    private static final String JAVA_PATH = &quot;/src/main/java&quot;;
    private static final String RESOURCE_PATH = &quot;/src/main/resources&quot;;
    private static final String BASE_PACKAGE = &quot;io.github.xxyopen.novel&quot;;

    /**
     * æ•°æ®åº“ä¿¡æ¯
     */
    private static final String DATABASE_IP = &quot;127.0.0.1&quot;;
    private static final String DATABASE_PORT = &quot;3306&quot;;
    private static final String DATABASE_NAME = &quot;novel&quot;;
    private static final String DATABASE_USERNAME = &quot;root&quot;;
    private static final String DATABASE_PASSWORD = &quot;test123456&quot;;


    public static void main(String[] args) {

        // ä¼ å…¥éœ€è¦ç”Ÿæˆçš„è¡¨åï¼Œå¤šä¸ªç”¨è‹±æ–‡é€—å·åˆ†éš”ï¼Œæ‰€æœ‰ç”¨ all è¡¨ç¤º
        genCode(&quot;sys_user&quot;);

    }


    /**
     * ä»£ç ç”Ÿæˆ
     */
    private static void genCode(String tables) {

        // å…¨å±€é…ç½®
        FastAutoGenerator.create(String.format(&quot;jdbc:mysql://%s:%s/%s?useUnicode=true&amp;characterEncoding=utf-8&amp;useSSL=false&amp;serverTimezone=Asia/Shanghai&quot;, DATABASE_IP, DATABASE_PORT, DATABASE_NAME), DATABASE_USERNAME, DATABASE_PASSWORD)
                .globalConfig(builder -&gt; {
                    builder.author(USERNAME) // è®¾ç½®ä½œè€…
                            .fileOverride()
                            // kotlin
                            //.enableSwagger() // å¼€å¯ swagger æ¨¡å¼
                            .fileOverride() // è¦†ç›–å·²ç”Ÿæˆæ–‡ä»¶
                            .commentDate(&quot;yyyy/MM/dd&quot;)
                            .outputDir(PROJECT_PATH + JAVA_PATH); // æŒ‡å®šè¾“å‡ºç›®å½•
                })
                // åŒ…é…ç½®
                .packageConfig(builder -&gt; builder.parent(BASE_PACKAGE) // è®¾ç½®çˆ¶åŒ…å
                        .entity(&quot;dao.entity&quot;)
                        .service(&quot;service&quot;)
                        .serviceImpl(&quot;service.impl&quot;)
                        .mapper(&quot;dao.mapper&quot;)
                        .controller(&quot;controller.front&quot;)
                        .pathInfo(Collections.singletonMap(OutputFile.mapperXml, PROJECT_PATH + RESOURCE_PATH + &quot;/mapper&quot;)))
                // æ¨¡ç‰ˆé…ç½®
                .templateConfig(builder -&gt; builder.disable(TemplateType.SERVICE)
                        .disable(TemplateType.SERVICEIMPL)
                        .disable(TemplateType.CONTROLLER))
                // ç­–ç•¥é…ç½®
                .strategyConfig(builder -&gt; builder.addInclude(getTables(tables)) // è®¾ç½®éœ€è¦ç”Ÿæˆçš„è¡¨å
                        .controllerBuilder()
                        .enableRestStyle()
                        .serviceBuilder()
                        .formatServiceFileName(&quot;%sService&quot;)
                ) // å¼€å¯ç”Ÿæˆ@RestController æ§åˆ¶å™¨
                //.templateEngine(new FreemarkerTemplateEngine()) // ä½¿ç”¨Freemarkerå¼•æ“æ¨¡æ¿ï¼Œé»˜è®¤çš„æ˜¯Velocityå¼•æ“æ¨¡æ¿
                .execute();

    }

    /**
     * å¤„ç† all å’Œå¤šè¡¨æƒ…å†µ
     */
    protected static List&lt;String&gt; getTables(String tables) {
        return &quot;all&quot;.equals(tables) ? Collections.emptyList() : Arrays.asList(tables.split(&quot;,&quot;));
    }

}
</code></pre></div><ol start="4"><li>ä¿®æ”¹ Generator ç±»ä¸­æ•°æ®åº“ç›¸å…³é…ç½®ï¼Œé€‰æ‹©æˆ‘ä»¬éœ€è¦åˆ›å»ºçš„è¡¨åï¼ˆall)ï¼Œè¿è¡Œ main æ–¹æ³•ç”Ÿæˆä»£ç </li></ol> <h3 id="æœ¬åœ°ç¼“å­˜-caffeine-é›†æˆå’Œé…ç½®"><a href="#æœ¬åœ°ç¼“å­˜-caffeine-é›†æˆå’Œé…ç½®" class="header-anchor">#</a> æœ¬åœ°ç¼“å­˜ Caffeine é›†æˆå’Œé…ç½®</h3> <p>Caffeine æ˜¯ Java 8 å¯¹ Google Guava ç¼“å­˜çš„é‡å†™ï¼Œæ˜¯ä¸€ä¸ªæä¾›äº†è¿‘ä¹æœ€ä½³å‘½ä¸­ç‡çš„é«˜æ€§èƒ½çš„ç¼“å­˜åº“ã€‚æˆ‘ä»¬æŒ‰ç…§å¦‚ä¸‹æ­¥éª¤é›†æˆå’Œé…ç½®ï¼š</p> <ol><li>æ·»åŠ  spring-boot-starter-cache ä¾èµ–</li></ol> <p>ä½¿ç”¨ spring-boot-starter-cache â€œStarterâ€ å¯ä»¥å¿«é€Ÿæ·»åŠ åŸºæœ¬ç¼“å­˜ä¾èµ–é¡¹ã€‚ starter å¼•å…¥äº† spring-context-supportã€‚å¦‚æœæˆ‘ä»¬æ‰‹åŠ¨æ·»åŠ ä¾èµ–é¡¹ï¼Œåˆ™å¿…é¡»åŒ…å« spring-context-support æ‰èƒ½ä½¿ç”¨ JCache æˆ– Caffeine æ”¯æŒã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-cache&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre></div><ol start="2"><li>æ·»åŠ  caffeine ä¾èµ–</li></ol> <div class="language- extra-class"><pre class="language-text"><code>&lt;dependency&gt;
    &lt;groupId&gt;com.github.ben-manes.caffeine&lt;/groupId&gt;
    &lt;artifactId&gt;caffeine&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre></div><ol start="3"><li>è‡ªå®šä¹‰ç¼“å­˜ç®¡ç†å™¨</li></ol> <div class="language- extra-class"><pre class="language-text"><code>/**
    * Caffeine ç¼“å­˜ç®¡ç†å™¨
    */
@Bean
public CacheManager caffeineCacheManager() {
    SimpleCacheManager cacheManager = new SimpleCacheManager();

    List&lt;CaffeineCache&gt; caches = new ArrayList&lt;&gt;(CacheConsts.CacheEnum.values().length);
    for (CacheConsts.CacheEnum c : CacheConsts.CacheEnum.values()) {
        if (c.isLocal()) {
            Caffeine&lt;Object, Object&gt; caffeine = Caffeine.newBuilder().recordStats().maximumSize(c.getMaxSize());
            if (c.getTtl() &gt; 0) {
                caffeine.expireAfterWrite(Duration.ofSeconds(c.getTtl()));
            }
            caches.add(new CaffeineCache(c.getName(), caffeine.build()));
        }
    }

    cacheManager.setCaches(caches);
    return cacheManager;
}
</code></pre></div><ol start="4"><li>ä½¿ç”¨ @EnableCaching æ³¨è§£å¼€å¯ç¼“å­˜</li></ol> <div class="language- extra-class"><pre class="language-text"><code>@SpringBootApplication
@MapperScan(&quot;io.github.xxyopen.novel.dao.mapper&quot;)
@EnableCaching
@Slf4j
public class NovelApplication {

	public static void main(String[] args) {
		SpringApplication.run(NovelApplication.class, args);
	}

	@Bean
	public CommandLineRunner commandLineRunner(ApplicationContext context){
		return args -&gt; {
			Map&lt;String, CacheManager&gt; beans = context.getBeansOfType(CacheManager.class);
			log.info(&quot;åŠ è½½äº†å¦‚ä¸‹ç¼“å­˜ç®¡ç†å™¨ï¼š&quot;);
			beans.forEach((k,v)-&gt;{
				log.info(&quot;{}:{}&quot;,k,v.getClass().getName());
				log.info(&quot;ç¼“å­˜ï¼š{}&quot;,v.getCacheNames());
			});

		};
	}

}
</code></pre></div><p>è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ Spring Cache çš„æ³¨è§£ï¼ˆä¾‹å¦‚ @Cacheableï¼‰å¼€å‘äº†ã€‚</p> <h3 id="åˆ†å¸ƒå¼ç¼“å­˜-redis-é›†æˆå’Œé…ç½®"><a href="#åˆ†å¸ƒå¼ç¼“å­˜-redis-é›†æˆå’Œé…ç½®" class="header-anchor">#</a> åˆ†å¸ƒå¼ç¼“å­˜ Redis é›†æˆå’Œé…ç½®</h3> <p>æœ¬åœ°ç¼“å­˜è™½ç„¶æœ‰ç€è®¿é—®é€Ÿåº¦å¿«çš„ä¼˜ç‚¹ï¼Œä½†æ— æ³•è¿›è¡Œå¤§æ•°æ®çš„å­˜å‚¨ã€‚å¹¶ä¸”å½“æˆ‘ä»¬é›†ç¾¤éƒ¨ç½²å¤šä¸ªæœåŠ¡èŠ‚ç‚¹ï¼Œæˆ–è€…åæœŸéšç€ä¸šåŠ¡å‘å±•è¿›è¡ŒæœåŠ¡æ‹†åˆ†åï¼Œæ²¡æ³•å…±äº«ç¼“å­˜å’Œä¿è¯ç¼“å­˜æ•°æ®çš„ä¸€è‡´æ€§ã€‚
æœ¬åœ°ç¼“å­˜çš„æ•°æ®è¿˜ä¼šéšåº”ç”¨ç¨‹åºçš„é‡å¯è€Œä¸¢å¤±ï¼Œè¿™æ ·å¯¹äºéœ€è¦æŒä¹…åŒ–çš„æ•°æ®æ»¡è¶³ä¸äº†éœ€æ±‚ï¼Œè¿˜ä¼šå¯¼è‡´é‡å¯åæ•°æ®åº“ç¬æ—¶å‹åŠ›è¿‡å¤§ã€‚</p> <p>æ‰€ä»¥æœ¬åœ°ç¼“å­˜ä¸€èˆ¬é€‚åˆäºç¼“å­˜åªè¯»æ•°æ®ï¼Œå¦‚ç»Ÿè®¡ç±»æ•°æ®ï¼Œæˆ–è€…æ¯ä¸ªéƒ¨ç½²èŠ‚ç‚¹ç‹¬ç«‹çš„æ•°æ®ã€‚å…¶å®ƒæƒ…å†µå°±éœ€è¦ç”¨åˆ°åˆ†å¸ƒå¼ç¼“å­˜äº†ã€‚</p> <p>åˆ†å¸ƒå¼ç¼“å­˜çš„é›†æˆæ­¥éª¤å’Œæœ¬åœ°ç¼“å­˜åŸºæœ¬å·®ä¸å¤šï¼Œé™¤äº†æ›¿æ¢ caffeine çš„ä¾èµ–é¡¹ä¸ºæˆ‘ä»¬ redis çš„ä¾èµ–å’Œé…ç½®ä¸Šæˆ‘ä»¬è‡ªå®šä¹‰çš„ redis ç¼“å­˜ç®¡ç†å™¨å¤–ï¼Œè¿˜è¦åœ¨é…ç½®æ–‡ä»¶ä¸­åŠ å…¥ redis çš„è¿æ¥é…ç½®ï¼š</p> <ol><li>åŠ å…¥ä¾èµ–</li></ol> <div class="language- extra-class"><pre class="language-text"><code>&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre></div><ol start="2"><li>é…ç½® redis ç¼“å­˜ç®¡ç†å™¨</li></ol> <div class="language- extra-class"><pre class="language-text"><code>/**
 * ç¼“å­˜é…ç½®ç±»
 *
 * @author xiongxiaoyang
 * @date 2022/5/12
 */
@Configuration
public class CacheConfig {

    /**
     * Caffeine ç¼“å­˜ç®¡ç†å™¨
     */
    @Bean
    @Primary
    public CacheManager caffeineCacheManager() {
        SimpleCacheManager cacheManager = new SimpleCacheManager();

        List&lt;CaffeineCache&gt; caches = new ArrayList&lt;&gt;(CacheConsts.CacheEnum.values().length);
        for (CacheConsts.CacheEnum c : CacheConsts.CacheEnum.values()) {
            if (c.isLocal()) {
                Caffeine&lt;Object, Object&gt; caffeine = Caffeine.newBuilder().recordStats().maximumSize(c.getMaxSize());
                if (c.getTtl() &gt; 0) {
                    caffeine.expireAfterWrite(Duration.ofSeconds(c.getTtl()));
                }
                caches.add(new CaffeineCache(c.getName(), caffeine.build()));
            }
        }

        cacheManager.setCaches(caches);
        return cacheManager;
    }

    /**
     * Redis ç¼“å­˜ç®¡ç†å™¨
     */
    @Bean
    public CacheManager redisCacheManager(RedisConnectionFactory connectionFactory) {
        RedisCacheWriter redisCacheWriter = RedisCacheWriter.nonLockingRedisCacheWriter(connectionFactory);

        RedisCacheConfiguration defaultCacheConfig = RedisCacheConfiguration.defaultCacheConfig()
                .disableCachingNullValues().prefixCacheNameWith(CacheConsts.REDIS_CACHE_PREFIX);

        Map&lt;String, RedisCacheConfiguration&gt; cacheMap = new LinkedHashMap&lt;&gt;(CacheConsts.CacheEnum.values().length);
        for (CacheConsts.CacheEnum c : CacheConsts.CacheEnum.values()) {
            if (c.isRemote()) {
                if (c.getTtl() &gt; 0) {
                    cacheMap.put(c.getName(), RedisCacheConfiguration.defaultCacheConfig().disableCachingNullValues()
                            .prefixCacheNameWith(CacheConsts.REDIS_CACHE_PREFIX).entryTtl(Duration.ofSeconds(c.getTtl())));
                } else {
                    cacheMap.put(c.getName(), RedisCacheConfiguration.defaultCacheConfig().disableCachingNullValues()
                            .prefixCacheNameWith(CacheConsts.REDIS_CACHE_PREFIX));
                }
            }
        }

        RedisCacheManager redisCacheManager = new RedisCacheManager(redisCacheWriter, defaultCacheConfig, cacheMap);
        redisCacheManager.setTransactionAware(true);
        redisCacheManager.initializeCaches();
        return redisCacheManager;
    }

}
</code></pre></div><ol start="3"><li>application.yml ä¸­åŠ å…¥ redis è¿æ¥é…ç½®ä¿¡æ¯</li></ol> <div class="language- extra-class"><pre class="language-text"><code>spring:
  redis:
    host: 127.0.0.1
    port: 6379
    password: 123456
</code></pre></div><h3 id="æœç´¢å¼•æ“-elasticsearch-é›†æˆä¸é…ç½®"><a href="#æœç´¢å¼•æ“-elasticsearch-é›†æˆä¸é…ç½®" class="header-anchor">#</a> æœç´¢å¼•æ“ Elasticsearch é›†æˆä¸é…ç½®</h3> <h4 id="ä»‹ç»"><a href="#ä»‹ç»" class="header-anchor">#</a> ä»‹ç»</h4> <p>Elastic Stack æ˜¯ä¸€ä¸ªå¯ä»¥å¸®åŠ©æˆ‘ä»¬æ„å»ºæœç´¢ä½“éªŒã€è§£å†³é—®é¢˜å¹¶å–å¾—æˆåŠŸçš„æœç´¢å¹³å°ã€‚æ ¸å¿ƒäº§å“åŒ…æ‹¬ Elasticsearchã€Kibanaã€Beats å’Œ Logstashï¼ˆä¹Ÿç§°ä¸º <a href="https://www.elastic.co/cn/what-is/elk-stack" target="_blank" rel="noopener noreferrer">ELK Stack<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ï¼‰ç­‰ç­‰ã€‚èƒ½å¤Ÿå®‰å…¨å¯é åœ°è·å–ä»»ä½•æ¥æºã€ä»»ä½•æ ¼å¼çš„æ•°æ®ï¼Œç„¶åå®æ—¶åœ°å¯¹æ•°æ®è¿›è¡Œæœç´¢ã€åˆ†æå’Œå¯è§†åŒ–ã€‚</p> <p>Elasticsearch å’Œ Kibana éƒ½æ˜¯åœ¨å…è´¹å¼€æºçš„åŸºç¡€ä¸Šæ„å»ºè€Œæˆï¼Œé€‚ç”¨äºå„ç§å„æ ·çš„ç”¨ä¾‹ï¼Œä»æ—¥å¿—å¼€å§‹ï¼Œåˆ°èƒ½å¤Ÿæƒ³åˆ°çš„ä»»ä½•é¡¹ç›®ï¼Œæ— ä¸€ä¸èƒ½èƒœä»»ã€‚</p> <p>Elasticsearch æ˜¯ä¸€ä¸ªåŸºäº JSON çš„åˆ†å¸ƒå¼ã€RESTful é£æ ¼çš„æœç´¢å’Œæ•°æ®åˆ†æå¼•æ“ï¼Œèƒ½å¤Ÿè§£å†³ä¸æ–­æ¶Œç°å‡ºçš„å„ç§ç”¨ä¾‹ã€‚ ä½œä¸º Elastic Stack çš„æ ¸å¿ƒï¼Œå®ƒé›†ä¸­å­˜å‚¨æ•°æ®ï¼Œå¸®åŠ©å‘ç°æ„æ–™ä¹‹ä¸­ä»¥åŠæ„æ–™ä¹‹å¤–çš„æƒ…å†µã€‚</p> <p>Kibana æ˜¯ä¸€ä¸ªå…è´¹ä¸”å¼€æ”¾çš„ç”¨æˆ·ç•Œé¢ï¼Œèƒ½å¤Ÿå¯¹ Elasticsearch æ•°æ®è¿›è¡Œå¯è§†åŒ–ï¼Œå¹¶åœ¨ Elastic Stack ä¸­è¿›è¡Œå¯¼èˆªã€‚æˆ‘ä»¬å¯ä»¥è¿›è¡Œå„ç§æ“ä½œï¼Œä»è·Ÿè¸ªæŸ¥è¯¢è´Ÿè½½ï¼Œåˆ°ç†è§£è¯·æ±‚å¦‚ä½•æµç»æ•´ä¸ªåº”ç”¨ï¼Œéƒ½èƒ½è½»æ¾å®Œæˆã€‚</p> <h4 id="é›†æˆä¸é…ç½®"><a href="#é›†æˆä¸é…ç½®" class="header-anchor">#</a> é›†æˆä¸é…ç½®</h4> <ol><li><p>Elasticsearch å’Œ Kibana å®‰è£…ï¼Œå¦‚æœä¸æƒ³åœ¨æœ¬åœ°å®‰è£… Elasticsearch å’Œ Kibanaï¼Œå¯ä»¥ä½¿ç”¨å®˜æ–¹æä¾›çš„å…è´¹è¯•ç”¨ç‰ˆ <a href="https://www.elastic.co/cn/cloud/?elektra=home&amp;storm=cloud" target="_blank" rel="noopener noreferrer">Elastic Cloud<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p>Kibana ä¸­åˆ›å»ºç´¢å¼•:</p></li></ol> <div class="language- extra-class"><pre class="language-text"><code>PUT /book
{
  &quot;mappings&quot; : {
    &quot;properties&quot; : {
      &quot;id&quot; : {
        &quot;type&quot; : &quot;long&quot;
      },
      &quot;authorId&quot; : {
        &quot;type&quot; : &quot;long&quot;
      },
      &quot;authorName&quot; : {
        &quot;type&quot; : &quot;text&quot;,
        &quot;analyzer&quot;: &quot;ik_smart&quot;
      },
      &quot;bookName&quot; : {
        &quot;type&quot; : &quot;text&quot;,
        &quot;analyzer&quot;: &quot;ik_smart&quot;
      },
      &quot;bookDesc&quot; : {
        &quot;type&quot; : &quot;text&quot;,
        &quot;analyzer&quot;: &quot;ik_smart&quot;
      },
      &quot;bookStatus&quot; : {
        &quot;type&quot; : &quot;short&quot;
      },
      &quot;categoryId&quot; : {
        &quot;type&quot; : &quot;integer&quot;
      },
      &quot;categoryName&quot; : {
        &quot;type&quot; : &quot;text&quot;,
        &quot;analyzer&quot;: &quot;ik_smart&quot;
      },
      &quot;lastChapterId&quot; : {
        &quot;type&quot; : &quot;long&quot;
      },
      &quot;lastChapterName&quot; : {
        &quot;type&quot; : &quot;text&quot;,
        &quot;analyzer&quot;: &quot;ik_smart&quot;
      },
      &quot;lastChapterUpdateTime&quot; : {
        &quot;type&quot;: &quot;long&quot;
      },
      &quot;picUrl&quot; : {
        &quot;type&quot; : &quot;keyword&quot;,
        &quot;index&quot; : false,
        &quot;doc_values&quot; : false
      },
      &quot;score&quot; : {
        &quot;type&quot; : &quot;integer&quot;
      },
      &quot;wordCount&quot; : {
        &quot;type&quot; : &quot;integer&quot;
      },
      &quot;workDirection&quot; : {
        &quot;type&quot; : &quot;short&quot;
      },
      &quot;visitCount&quot; : {
        &quot;type&quot;: &quot;long&quot;
      }
    }
  }
}
</code></pre></div><ol start="3"><li>é¡¹ç›®æ·»åŠ å¦‚ä¸‹ä¾èµ–ï¼š</li></ol> <div class="language- extra-class"><pre class="language-text"><code>&lt;dependencies&gt;

    &lt;dependency&gt;
      &lt;groupId&gt;co.elastic.clients&lt;/groupId&gt;
      &lt;artifactId&gt;elasticsearch-java&lt;/artifactId&gt;
      &lt;version&gt;8.2.0&lt;/version&gt;
    &lt;/dependency&gt;

    &lt;dependency&gt;
      &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;
      &lt;artifactId&gt;jackson-databind&lt;/artifactId&gt;
      &lt;version&gt;2.12.3&lt;/version&gt;
    &lt;/dependency&gt;

&lt;/dependencies&gt;
</code></pre></div><ol start="4"><li>åœ¨ application.yml ä¸­é…ç½®å¦‚ä¸‹è¿æ¥ä¿¡æ¯ï¼š</li></ol> <div class="language- extra-class"><pre class="language-text"><code>spring:
  elasticsearch:
    uris:
      - https://my-deployment-ce7ca3.es.us-central1.gcp.cloud.es.io:9243
    username: elastic
    password: qTjgYVKSuExX
</code></pre></div><ol start="5"><li>é…ç½® <a href="/course/novel/2.html#å…¨æ–°çš„-elasticsearch-java-api-client">Elasticsearch Java API Client</a></li></ol> <div class="language- extra-class"><pre class="language-text"><code>/**
 * elasticsearch ç›¸å…³é…ç½®
 *
 * @author xiongxiaoyang
 * @date 2022/5/23
 */
@Configuration
@ConditionalOnProperty(prefix = &quot;spring.elasticsearch&quot;, name = &quot;enable&quot;, havingValue = &quot;true&quot;)
@RequiredArgsConstructor
public class EsConfig {

    @Bean
    public ElasticsearchClient elasticsearchClient(RestClient restClient) {

        // Create the transport with a Jackson mapper
        ElasticsearchTransport transport = new RestClientTransport(
                restClient, new JacksonJsonpMapper());

        // And create the API client
        return new ElasticsearchClient(transport);
    }

}
</code></pre></div><h3 id="spring-amqp-é›†æˆä¸é…ç½®"><a href="#spring-amqp-é›†æˆä¸é…ç½®" class="header-anchor">#</a> Spring AMQP é›†æˆä¸é…ç½®</h3> <h4 id="ä»‹ç»-2"><a href="#ä»‹ç»-2" class="header-anchor">#</a> ä»‹ç»</h4> <p>AMQPï¼ˆé«˜çº§æ¶ˆæ¯é˜Ÿåˆ—åè®®ï¼‰æ˜¯ä¸€ä¸ªå¼‚æ­¥æ¶ˆæ¯ä¼ é€’æ‰€ä½¿ç”¨çš„åº”ç”¨å±‚åè®®è§„èŒƒï¼Œä¸ºé¢å‘æ¶ˆæ¯çš„ä¸­é—´ä»¶è®¾è®¡ï¼Œä¸å—äº§å“å’Œå¼€å‘è¯­è¨€çš„é™åˆ¶. Spring AMQP å°†æ ¸å¿ƒ Spring æ¦‚å¿µåº”ç”¨äºåŸºäº AMQP æ¶ˆæ¯ä¼ é€’è§£å†³æ–¹æ¡ˆçš„å¼€å‘ã€‚</p> <p>RabbitMQ æ˜¯åŸºäº AMQP åè®®çš„è½»é‡çº§ã€å¯é ã€å¯æ‰©å±•ã€å¯ç§»æ¤çš„æ¶ˆæ¯ä¸­é—´ä»¶ï¼ŒSpring ä½¿ç”¨ RabbitMQ é€šè¿‡ AMQP åè®®è¿›è¡Œé€šä¿¡ã€‚Spring Boot ä¸ºé€šè¿‡ RabbitMQ ä½¿ç”¨ AMQP æä¾›äº†å¤šç§ä¾¿åˆ©ï¼ŒåŒ…æ‹¬ spring-boot-starter-amqp â€œStarterâ€ã€‚</p> <h4 id="é›†æˆä¸é…ç½®-2"><a href="#é›†æˆä¸é…ç½®-2" class="header-anchor">#</a> é›†æˆä¸é…ç½®</h4> <ol><li>å¯é€šè¿‡å¦‚ä¸‹ Docker å‘½ä»¤ å®‰è£… RabbiMQï¼š</li></ol> <div class="language- extra-class"><pre class="language-text"><code> docker run -it --rm --name rabbitmq -p 5672:5672 -p 15672:15672 rabbitmq:3.10-management
</code></pre></div><ol start="2"><li>ç™»å½• RabbiMQ çš„ web ç®¡ç†ç•Œé¢ï¼Œåˆ›å»ºè™šæ‹Ÿä¸»æœº<code>novel</code>:</li></ol> <p><img src="/img/novel/rabbitmq.png" alt="RabbitMQ"></p> <ol start="3"><li>é¡¹ç›®ä¸­åŠ å…¥å¦‚ä¸‹çš„ maven ä¾èµ–ï¼š</li></ol> <div class="language- extra-class"><pre class="language-text"><code>&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-amqp&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre></div><ol start="4"><li>åœ¨ application.yml é…ç½®æ–‡ä»¶ä¸­åŠ å…¥ RabbitMQ çš„è¿æ¥é…ç½®ï¼š</li></ol> <div class="language- extra-class"><pre class="language-text"><code>spring:
  rabbitmq:
    addresses: &quot;amqp://guest:guest@47.106.243.172&quot;
    virtual-host: novel
    template:
      retry:
        # å¼€å¯é‡è¯•
        enabled: true
        # æœ€å¤§é‡è¯•æ¬¡æ•°
        max-attempts: 3
        # ç¬¬ä¸€æ¬¡å’Œç¬¬äºŒæ¬¡é‡è¯•ä¹‹é—´çš„æŒç»­æ—¶é—´
        initial-interval: &quot;3s&quot;
</code></pre></div><ol start="5"><li>åœ¨ Spring Beans ä¸­æ³¨å…¥ AmqpTemplate å‘é€æ¶ˆæ¯</li></ol> <h3 id="åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦å¹³å°-xxl-job-é›†æˆä¸é…ç½®"><a href="#åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦å¹³å°-xxl-job-é›†æˆä¸é…ç½®" class="header-anchor">#</a> åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦å¹³å° XXL-JOB é›†æˆä¸é…ç½®</h3> <h4 id="ä»‹ç»-3"><a href="#ä»‹ç»-3" class="header-anchor">#</a> ä»‹ç»</h4> <p>XXL-JOB æ˜¯ä¸€ä¸ªå¼€ç®±å³ç”¨çš„å¼€æºåˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦å¹³å°ï¼Œå…¶æ ¸å¿ƒè®¾è®¡ç›®æ ‡æ˜¯å¼€å‘è¿…é€Ÿã€å­¦ä¹ ç®€å•ã€è½»é‡çº§ã€æ˜“æ‰©å±•ã€‚ç”±è°ƒåº¦æ¨¡å—å’Œæ‰§è¡Œæ¨¡å—æ„æˆï¼š</p> <ul><li>è°ƒåº¦æ¨¡å—ï¼ˆè°ƒåº¦ä¸­å¿ƒï¼‰ï¼š</li></ul> <p>è´Ÿè´£ç®¡ç†è°ƒåº¦ä¿¡æ¯ï¼ŒæŒ‰ç…§è°ƒåº¦é…ç½®å‘å‡ºè°ƒåº¦è¯·æ±‚ï¼Œè‡ªèº«ä¸æ‰¿æ‹…ä¸šåŠ¡ä»£ç ã€‚è°ƒåº¦ç³»ç»Ÿä¸ä»»åŠ¡è§£è€¦ï¼Œæé«˜äº†ç³»ç»Ÿå¯ç”¨æ€§å’Œç¨³å®šæ€§ï¼ŒåŒæ—¶è°ƒåº¦ç³»ç»Ÿæ€§èƒ½ä¸å†å—é™äºä»»åŠ¡æ¨¡å—ï¼›
æ”¯æŒå¯è§†åŒ–ã€ç®€å•ä¸”åŠ¨æ€çš„ç®¡ç†è°ƒåº¦ä¿¡æ¯ï¼ŒåŒ…æ‹¬ä»»åŠ¡æ–°å»ºï¼Œæ›´æ–°ï¼Œåˆ é™¤ï¼ŒGLUEå¼€å‘å’Œä»»åŠ¡æŠ¥è­¦ç­‰ï¼Œæ‰€æœ‰ä¸Šè¿°æ“ä½œéƒ½ä¼šå®æ—¶ç”Ÿæ•ˆï¼ŒåŒæ—¶æ”¯æŒç›‘æ§è°ƒåº¦ç»“æœä»¥åŠæ‰§è¡Œæ—¥å¿—ï¼Œæ”¯æŒæ‰§è¡Œå™¨Failoverã€‚</p> <ul><li>æ‰§è¡Œæ¨¡å—ï¼ˆæ‰§è¡Œå™¨ï¼‰ï¼š</li></ul> <p>è´Ÿè´£æ¥æ”¶è°ƒåº¦è¯·æ±‚å¹¶æ‰§è¡Œä»»åŠ¡é€»è¾‘ã€‚ä»»åŠ¡æ¨¡å—ä¸“æ³¨äºä»»åŠ¡çš„æ‰§è¡Œç­‰æ“ä½œï¼Œå¼€å‘å’Œç»´æŠ¤æ›´åŠ ç®€å•å’Œé«˜æ•ˆï¼›
æ¥æ”¶â€œè°ƒåº¦ä¸­å¿ƒâ€çš„æ‰§è¡Œè¯·æ±‚ã€ç»ˆæ­¢è¯·æ±‚å’Œæ—¥å¿—è¯·æ±‚ç­‰ã€‚</p> <p><img src="/img/novel/xxljob.png" alt="XXL-JOB æ¶æ„å›¾"></p> <p>XXL-JOB å°†è°ƒåº¦è¡Œä¸ºæŠ½è±¡å½¢æˆâ€œè°ƒåº¦ä¸­å¿ƒâ€å…¬å…±å¹³å°ï¼Œè€Œå¹³å°è‡ªèº«å¹¶ä¸æ‰¿æ‹…ä¸šåŠ¡é€»è¾‘ï¼Œâ€œè°ƒåº¦ä¸­å¿ƒâ€è´Ÿè´£å‘èµ·è°ƒåº¦è¯·æ±‚ã€‚</p> <p>å°†ä»»åŠ¡æŠ½è±¡æˆåˆ†æ•£çš„JobHandlerï¼Œäº¤ç”±â€œæ‰§è¡Œå™¨â€ç»Ÿä¸€ç®¡ç†ï¼Œâ€œæ‰§è¡Œå™¨â€è´Ÿè´£æ¥æ”¶è°ƒåº¦è¯·æ±‚å¹¶æ‰§è¡Œå¯¹åº”çš„JobHandlerä¸­ä¸šåŠ¡é€»è¾‘ã€‚</p> <p>å› æ­¤ï¼Œâ€œè°ƒåº¦â€å’Œâ€œä»»åŠ¡â€ä¸¤éƒ¨åˆ†å¯ä»¥ç›¸äº’è§£è€¦ï¼Œæé«˜ç³»ç»Ÿæ•´ä½“ç¨³å®šæ€§å’Œæ‰©å±•æ€§ï¼›</p> <p>XXL-JOB çš„ä¸»è¦åŠŸèƒ½ç‰¹æ€§å¦‚ä¸‹ï¼š</p> <ol><li>ç®€å•ï¼šæ”¯æŒé€šè¿‡ Web é¡µé¢å¯¹ä»»åŠ¡è¿›è¡Œ CRUD æ“ä½œï¼Œæ“ä½œç®€å•ï¼Œä¸€åˆ†é’Ÿä¸Šæ‰‹ï¼›</li> <li>åŠ¨æ€ï¼šæ”¯æŒåŠ¨æ€ä¿®æ”¹ä»»åŠ¡çŠ¶æ€ã€å¯åŠ¨/åœæ­¢ä»»åŠ¡ï¼Œä»¥åŠç»ˆæ­¢è¿è¡Œä¸­ä»»åŠ¡ï¼Œå³æ—¶ç”Ÿæ•ˆï¼›</li> <li>è°ƒåº¦ä¸­å¿ƒ HAï¼ˆä¸­å¿ƒå¼ï¼‰ï¼šè°ƒåº¦é‡‡ç”¨ä¸­å¿ƒå¼è®¾è®¡ï¼Œâ€œè°ƒåº¦ä¸­å¿ƒâ€è‡ªç ”è°ƒåº¦ç»„ä»¶å¹¶æ”¯æŒé›†ç¾¤éƒ¨ç½²ï¼Œå¯ä¿è¯è°ƒåº¦ä¸­å¿ƒ HAï¼›</li> <li>æ‰§è¡Œå™¨ HAï¼ˆåˆ†å¸ƒå¼ï¼‰ï¼šä»»åŠ¡åˆ†å¸ƒå¼æ‰§è¡Œï¼Œä»»åŠ¡â€æ‰§è¡Œå™¨â€æ”¯æŒé›†ç¾¤éƒ¨ç½²ï¼Œå¯ä¿è¯ä»»åŠ¡æ‰§è¡Œ HAï¼›</li> <li>æ³¨å†Œä¸­å¿ƒ: æ‰§è¡Œå™¨ä¼šå‘¨æœŸæ€§è‡ªåŠ¨æ³¨å†Œä»»åŠ¡, è°ƒåº¦ä¸­å¿ƒå°†ä¼šè‡ªåŠ¨å‘ç°æ³¨å†Œçš„ä»»åŠ¡å¹¶è§¦å‘æ‰§è¡Œã€‚åŒæ—¶ï¼Œä¹Ÿæ”¯æŒæ‰‹åŠ¨å½•å…¥æ‰§è¡Œå™¨åœ°å€ï¼›</li> <li>å¼¹æ€§æ‰©å®¹ç¼©å®¹ï¼šä¸€æ—¦æœ‰æ–°æ‰§è¡Œå™¨æœºå™¨ä¸Šçº¿æˆ–è€…ä¸‹çº¿ï¼Œä¸‹æ¬¡è°ƒåº¦æ—¶å°†ä¼šé‡æ–°åˆ†é…ä»»åŠ¡ï¼›</li> <li>è§¦å‘ç­–ç•¥ï¼šæä¾›ä¸°å¯Œçš„ä»»åŠ¡è§¦å‘ç­–ç•¥ï¼ŒåŒ…æ‹¬ï¼šCron è§¦å‘ã€å›ºå®šé—´éš”è§¦å‘ã€å›ºå®šå»¶æ—¶è§¦å‘ã€APIï¼ˆäº‹ä»¶ï¼‰è§¦å‘ã€äººå·¥è§¦å‘ã€çˆ¶å­ä»»åŠ¡è§¦å‘ï¼›</li> <li>è°ƒåº¦è¿‡æœŸç­–ç•¥ï¼šè°ƒåº¦ä¸­å¿ƒé”™è¿‡è°ƒåº¦æ—¶é—´çš„è¡¥å¿å¤„ç†ç­–ç•¥ï¼ŒåŒ…æ‹¬ï¼šå¿½ç•¥ã€ç«‹å³è¡¥å¿è§¦å‘ä¸€æ¬¡ç­‰ï¼›</li> <li>é˜»å¡å¤„ç†ç­–ç•¥ï¼šè°ƒåº¦è¿‡äºå¯†é›†æ‰§è¡Œå™¨æ¥ä¸åŠå¤„ç†æ—¶çš„å¤„ç†ç­–ç•¥ï¼Œç­–ç•¥åŒ…æ‹¬ï¼šå•æœºä¸²è¡Œï¼ˆé»˜è®¤ï¼‰ã€ä¸¢å¼ƒåç»­è°ƒåº¦ã€è¦†ç›–ä¹‹å‰è°ƒåº¦ï¼›</li> <li>ä»»åŠ¡è¶…æ—¶æ§åˆ¶ï¼šæ”¯æŒè‡ªå®šä¹‰ä»»åŠ¡è¶…æ—¶æ—¶é—´ï¼Œä»»åŠ¡è¿è¡Œè¶…æ—¶å°†ä¼šä¸»åŠ¨ä¸­æ–­ä»»åŠ¡ï¼›</li> <li>ä»»åŠ¡å¤±è´¥é‡è¯•ï¼šæ”¯æŒè‡ªå®šä¹‰ä»»åŠ¡å¤±è´¥é‡è¯•æ¬¡æ•°ï¼Œå½“ä»»åŠ¡å¤±è´¥æ—¶å°†ä¼šæŒ‰ç…§é¢„è®¾çš„å¤±è´¥é‡è¯•æ¬¡æ•°ä¸»åŠ¨è¿›è¡Œé‡è¯•ï¼›å…¶ä¸­åˆ†ç‰‡ä»»åŠ¡æ”¯æŒåˆ†ç‰‡ç²’åº¦çš„å¤±è´¥é‡è¯•ï¼›</li> <li>ä»»åŠ¡å¤±è´¥å‘Šè­¦ï¼›é»˜è®¤æä¾›é‚®ä»¶æ–¹å¼å¤±è´¥å‘Šè­¦ï¼ŒåŒæ—¶é¢„ç•™æ‰©å±•æ¥å£ï¼Œå¯æ–¹ä¾¿çš„æ‰©å±•çŸ­ä¿¡ã€é’‰é’‰ç­‰å‘Šè­¦æ–¹å¼ï¼›</li> <li>è·¯ç”±ç­–ç•¥ï¼šæ‰§è¡Œå™¨é›†ç¾¤éƒ¨ç½²æ—¶æä¾›ä¸°å¯Œçš„è·¯ç”±ç­–ç•¥ï¼ŒåŒ…æ‹¬ï¼šç¬¬ä¸€ä¸ªã€æœ€åä¸€ä¸ªã€è½®è¯¢ã€éšæœºã€ä¸€è‡´æ€§ HASHã€æœ€ä¸ç»å¸¸ä½¿ç”¨ã€æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨ã€æ•…éšœè½¬ç§»ã€å¿™ç¢Œè½¬ç§»ç­‰ï¼›</li> <li>åˆ†ç‰‡å¹¿æ’­ä»»åŠ¡ï¼šæ‰§è¡Œå™¨é›†ç¾¤éƒ¨ç½²æ—¶ï¼Œä»»åŠ¡è·¯ç”±ç­–ç•¥é€‰æ‹©â€åˆ†ç‰‡å¹¿æ’­â€æƒ…å†µä¸‹ï¼Œä¸€æ¬¡ä»»åŠ¡è°ƒåº¦å°†ä¼šå¹¿æ’­è§¦å‘é›†ç¾¤ä¸­æ‰€æœ‰æ‰§è¡Œå™¨æ‰§è¡Œä¸€æ¬¡ä»»åŠ¡ï¼Œå¯æ ¹æ®åˆ†ç‰‡å‚æ•°å¼€å‘åˆ†ç‰‡ä»»åŠ¡ï¼›</li> <li>åŠ¨æ€åˆ†ç‰‡ï¼šåˆ†ç‰‡å¹¿æ’­ä»»åŠ¡ä»¥æ‰§è¡Œå™¨ä¸ºç»´åº¦è¿›è¡Œåˆ†ç‰‡ï¼Œæ”¯æŒåŠ¨æ€æ‰©å®¹æ‰§è¡Œå™¨é›†ç¾¤ä»è€ŒåŠ¨æ€å¢åŠ åˆ†ç‰‡æ•°é‡ï¼ŒååŒè¿›è¡Œä¸šåŠ¡å¤„ç†ï¼›åœ¨è¿›è¡Œå¤§æ•°æ®é‡ä¸šåŠ¡æ“ä½œæ—¶å¯æ˜¾è‘—æå‡ä»»åŠ¡å¤„ç†èƒ½åŠ›å’Œé€Ÿåº¦ã€‚</li> <li>æ•…éšœè½¬ç§»ï¼šä»»åŠ¡è·¯ç”±ç­–ç•¥é€‰æ‹©â€æ•…éšœè½¬ç§»â€æƒ…å†µä¸‹ï¼Œå¦‚æœæ‰§è¡Œå™¨é›†ç¾¤ä¸­æŸä¸€å°æœºå™¨æ•…éšœï¼Œå°†ä¼šè‡ªåŠ¨Failoveråˆ‡æ¢åˆ°ä¸€å°æ­£å¸¸çš„æ‰§è¡Œå™¨å‘é€è°ƒåº¦è¯·æ±‚ã€‚</li> <li>ä»»åŠ¡è¿›åº¦ç›‘æ§ï¼šæ”¯æŒå®æ—¶ç›‘æ§ä»»åŠ¡è¿›åº¦ï¼›</li> <li>Rolling å®æ—¶æ—¥å¿—ï¼šæ”¯æŒåœ¨çº¿æŸ¥çœ‹è°ƒåº¦ç»“æœï¼Œå¹¶ä¸”æ”¯æŒä»¥ Rolling æ–¹å¼å®æ—¶æŸ¥çœ‹æ‰§è¡Œå™¨è¾“å‡ºçš„å®Œæ•´çš„æ‰§è¡Œæ—¥å¿—ï¼›</li> <li>GLUEï¼šæä¾›Web IDEï¼Œæ”¯æŒåœ¨çº¿å¼€å‘ä»»åŠ¡é€»è¾‘ä»£ç ï¼ŒåŠ¨æ€å‘å¸ƒï¼Œå®æ—¶ç¼–è¯‘ç”Ÿæ•ˆï¼Œçœç•¥éƒ¨ç½²ä¸Šçº¿çš„è¿‡ç¨‹ã€‚æ”¯æŒ30ä¸ªç‰ˆæœ¬çš„å†å²ç‰ˆæœ¬å›æº¯ã€‚</li> <li>è„šæœ¬ä»»åŠ¡ï¼šæ”¯æŒä»¥GLUEæ¨¡å¼å¼€å‘å’Œè¿è¡Œè„šæœ¬ä»»åŠ¡ï¼ŒåŒ…æ‹¬ Shellã€Pythonã€NodeJSã€PHPã€PowerShellç­‰ç±»å‹è„šæœ¬;</li> <li>å‘½ä»¤è¡Œä»»åŠ¡ï¼šåŸç”Ÿæä¾›é€šç”¨å‘½ä»¤è¡Œä»»åŠ¡Handlerï¼ˆBeanä»»åŠ¡ï¼Œâ€CommandJobHandlerâ€ï¼‰ï¼›ä¸šåŠ¡æ–¹åªéœ€è¦æä¾›å‘½ä»¤è¡Œå³å¯ï¼›</li> <li>ä»»åŠ¡ä¾èµ–ï¼šæ”¯æŒé…ç½®å­ä»»åŠ¡ä¾èµ–ï¼Œå½“çˆ¶ä»»åŠ¡æ‰§è¡Œç»“æŸä¸”æ‰§è¡ŒæˆåŠŸåå°†ä¼šä¸»åŠ¨è§¦å‘ä¸€æ¬¡å­ä»»åŠ¡çš„æ‰§è¡Œ, å¤šä¸ªå­ä»»åŠ¡ç”¨é€—å·åˆ†éš”ï¼›</li> <li>ä¸€è‡´æ€§ï¼šâ€œè°ƒåº¦ä¸­å¿ƒâ€é€šè¿‡DBé”ä¿è¯é›†ç¾¤åˆ†å¸ƒå¼è°ƒåº¦çš„ä¸€è‡´æ€§, ä¸€æ¬¡ä»»åŠ¡è°ƒåº¦åªä¼šè§¦å‘ä¸€æ¬¡æ‰§è¡Œï¼›</li> <li>è‡ªå®šä¹‰ä»»åŠ¡å‚æ•°ï¼šæ”¯æŒåœ¨çº¿é…ç½®è°ƒåº¦ä»»åŠ¡å…¥å‚ï¼Œå³æ—¶ç”Ÿæ•ˆï¼›</li> <li>è°ƒåº¦çº¿ç¨‹æ± ï¼šè°ƒåº¦ç³»ç»Ÿå¤šçº¿ç¨‹è§¦å‘è°ƒåº¦è¿è¡Œï¼Œç¡®ä¿è°ƒåº¦ç²¾ç¡®æ‰§è¡Œï¼Œä¸è¢«å µå¡ï¼›</li> <li>æ•°æ®åŠ å¯†ï¼šè°ƒåº¦ä¸­å¿ƒå’Œæ‰§è¡Œå™¨ä¹‹é—´çš„é€šè®¯è¿›è¡Œæ•°æ®åŠ å¯†ï¼Œæå‡è°ƒåº¦ä¿¡æ¯å®‰å…¨æ€§ï¼›</li> <li>é‚®ä»¶æŠ¥è­¦ï¼šä»»åŠ¡å¤±è´¥æ—¶æ”¯æŒé‚®ä»¶æŠ¥è­¦ï¼Œæ”¯æŒé…ç½®å¤šé‚®ä»¶åœ°å€ç¾¤å‘æŠ¥è­¦é‚®ä»¶ï¼›</li> <li>æ¨é€ maven ä¸­å¤®ä»“åº“: å°†ä¼šæŠŠæœ€æ–°ç¨³å®šç‰ˆæ¨é€åˆ° maven ä¸­å¤®ä»“åº“, æ–¹ä¾¿ç”¨æˆ·æ¥å…¥å’Œä½¿ç”¨;</li> <li>è¿è¡ŒæŠ¥è¡¨ï¼šæ”¯æŒå®æ—¶æŸ¥çœ‹è¿è¡Œæ•°æ®ï¼Œå¦‚ä»»åŠ¡æ•°é‡ã€è°ƒåº¦æ¬¡æ•°ã€æ‰§è¡Œå™¨æ•°é‡ç­‰ï¼›ä»¥åŠè°ƒåº¦æŠ¥è¡¨ï¼Œå¦‚è°ƒåº¦æ—¥æœŸåˆ†å¸ƒå›¾ï¼Œè°ƒåº¦æˆåŠŸåˆ†å¸ƒå›¾ç­‰ï¼›</li> <li>å…¨å¼‚æ­¥ï¼šä»»åŠ¡è°ƒåº¦æµç¨‹å…¨å¼‚æ­¥åŒ–è®¾è®¡å®ç°ï¼Œå¦‚å¼‚æ­¥è°ƒåº¦ã€å¼‚æ­¥è¿è¡Œã€å¼‚æ­¥å›è°ƒç­‰ï¼Œæœ‰æ•ˆå¯¹å¯†é›†è°ƒåº¦è¿›è¡Œæµé‡å‰Šå³°ï¼Œç†è®ºä¸Šæ”¯æŒä»»æ„æ—¶é•¿ä»»åŠ¡çš„è¿è¡Œï¼›</li> <li>è·¨è¯­è¨€ï¼šè°ƒåº¦ä¸­å¿ƒä¸æ‰§è¡Œå™¨æä¾›è¯­è¨€æ— å…³çš„ RESTful API æœåŠ¡ï¼Œç¬¬ä¸‰æ–¹ä»»æ„è¯­è¨€å¯æ®æ­¤å¯¹æ¥è°ƒåº¦ä¸­å¿ƒæˆ–è€…å®ç°æ‰§è¡Œå™¨ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æä¾›äº† â€œå¤šä»»åŠ¡æ¨¡å¼â€å’Œâ€œhttpJobHandlerâ€ç­‰å…¶ä»–è·¨è¯­è¨€æ–¹æ¡ˆï¼›</li> <li>å›½é™…åŒ–ï¼šè°ƒåº¦ä¸­å¿ƒæ”¯æŒå›½é™…åŒ–è®¾ç½®ï¼Œæä¾›ä¸­æ–‡ã€è‹±æ–‡ä¸¤ç§å¯é€‰è¯­è¨€ï¼Œé»˜è®¤ä¸ºä¸­æ–‡ï¼›</li> <li>å®¹å™¨åŒ–ï¼šæä¾›å®˜æ–¹ docker é•œåƒï¼Œå¹¶å®æ—¶æ›´æ–°æ¨é€ dockerhubï¼Œè¿›ä¸€æ­¥å®ç°äº§å“å¼€ç®±å³ç”¨ï¼›</li> <li>çº¿ç¨‹æ± éš”ç¦»ï¼šè°ƒåº¦çº¿ç¨‹æ± è¿›è¡Œéš”ç¦»æ‹†åˆ†ï¼Œæ…¢ä»»åŠ¡è‡ªåŠ¨é™çº§è¿›å…¥â€Slowâ€çº¿ç¨‹æ± ï¼Œé¿å…è€—å°½è°ƒåº¦çº¿ç¨‹ï¼Œæé«˜ç³»ç»Ÿç¨³å®šæ€§ï¼›</li> <li>ç”¨æˆ·ç®¡ç†ï¼šæ”¯æŒåœ¨çº¿ç®¡ç†ç³»ç»Ÿç”¨æˆ·ï¼Œå­˜åœ¨ç®¡ç†å‘˜ã€æ™®é€šç”¨æˆ·ä¸¤ç§è§’è‰²ï¼›</li> <li>æƒé™æ§åˆ¶ï¼šæ‰§è¡Œå™¨ç»´åº¦è¿›è¡Œæƒé™æ§åˆ¶ï¼Œç®¡ç†å‘˜æ‹¥æœ‰å…¨é‡æƒé™ï¼Œæ™®é€šç”¨æˆ·éœ€è¦åˆ†é…æ‰§è¡Œå™¨æƒé™åæ‰å…è®¸ç›¸å…³æ“ä½œï¼›</li></ol> <h4 id="é›†æˆä¸é…ç½®-3"><a href="#é›†æˆä¸é…ç½®-3" class="header-anchor">#</a> é›†æˆä¸é…ç½®</h4> <ol><li>åˆå§‹åŒ–å¦‚ä¸‹çš„<code>è°ƒåº¦æ•°æ®åº“</code>ï¼š</li></ol> <div class="language- extra-class"><pre class="language-text"><code>#
# XXL-JOB v2.4.0-SNAPSHOT
# Copyright (c) 2015-present, xuxueli.

CREATE database if NOT EXISTS `xxl_job` default character set utf8mb4 collate utf8mb4_unicode_ci;
use `xxl_job`;

SET NAMES utf8mb4;

CREATE TABLE `xxl_job_info` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `job_group` int(11) NOT NULL COMMENT 'æ‰§è¡Œå™¨ä¸»é”®ID',
  `job_desc` varchar(255) NOT NULL,
  `add_time` datetime DEFAULT NULL,
  `update_time` datetime DEFAULT NULL,
  `author` varchar(64) DEFAULT NULL COMMENT 'ä½œè€…',
  `alarm_email` varchar(255) DEFAULT NULL COMMENT 'æŠ¥è­¦é‚®ä»¶',
  `schedule_type` varchar(50) NOT NULL DEFAULT 'NONE' COMMENT 'è°ƒåº¦ç±»å‹',
  `schedule_conf` varchar(128) DEFAULT NULL COMMENT 'è°ƒåº¦é…ç½®ï¼Œå€¼å«ä¹‰å–å†³äºè°ƒåº¦ç±»å‹',
  `misfire_strategy` varchar(50) NOT NULL DEFAULT 'DO_NOTHING' COMMENT 'è°ƒåº¦è¿‡æœŸç­–ç•¥',
  `executor_route_strategy` varchar(50) DEFAULT NULL COMMENT 'æ‰§è¡Œå™¨è·¯ç”±ç­–ç•¥',
  `executor_handler` varchar(255) DEFAULT NULL COMMENT 'æ‰§è¡Œå™¨ä»»åŠ¡handler',
  `executor_param` varchar(512) DEFAULT NULL COMMENT 'æ‰§è¡Œå™¨ä»»åŠ¡å‚æ•°',
  `executor_block_strategy` varchar(50) DEFAULT NULL COMMENT 'é˜»å¡å¤„ç†ç­–ç•¥',
  `executor_timeout` int(11) NOT NULL DEFAULT '0' COMMENT 'ä»»åŠ¡æ‰§è¡Œè¶…æ—¶æ—¶é—´ï¼Œå•ä½ç§’',
  `executor_fail_retry_count` int(11) NOT NULL DEFAULT '0' COMMENT 'å¤±è´¥é‡è¯•æ¬¡æ•°',
  `glue_type` varchar(50) NOT NULL COMMENT 'GLUEç±»å‹',
  `glue_source` mediumtext COMMENT 'GLUEæºä»£ç ',
  `glue_remark` varchar(128) DEFAULT NULL COMMENT 'GLUEå¤‡æ³¨',
  `glue_updatetime` datetime DEFAULT NULL COMMENT 'GLUEæ›´æ–°æ—¶é—´',
  `child_jobid` varchar(255) DEFAULT NULL COMMENT 'å­ä»»åŠ¡IDï¼Œå¤šä¸ªé€—å·åˆ†éš”',
  `trigger_status` tinyint(4) NOT NULL DEFAULT '0' COMMENT 'è°ƒåº¦çŠ¶æ€ï¼š0-åœæ­¢ï¼Œ1-è¿è¡Œ',
  `trigger_last_time` bigint(13) NOT NULL DEFAULT '0' COMMENT 'ä¸Šæ¬¡è°ƒåº¦æ—¶é—´',
  `trigger_next_time` bigint(13) NOT NULL DEFAULT '0' COMMENT 'ä¸‹æ¬¡è°ƒåº¦æ—¶é—´',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

CREATE TABLE `xxl_job_log` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT,
  `job_group` int(11) NOT NULL COMMENT 'æ‰§è¡Œå™¨ä¸»é”®ID',
  `job_id` int(11) NOT NULL COMMENT 'ä»»åŠ¡ï¼Œä¸»é”®ID',
  `executor_address` varchar(255) DEFAULT NULL COMMENT 'æ‰§è¡Œå™¨åœ°å€ï¼Œæœ¬æ¬¡æ‰§è¡Œçš„åœ°å€',
  `executor_handler` varchar(255) DEFAULT NULL COMMENT 'æ‰§è¡Œå™¨ä»»åŠ¡handler',
  `executor_param` varchar(512) DEFAULT NULL COMMENT 'æ‰§è¡Œå™¨ä»»åŠ¡å‚æ•°',
  `executor_sharding_param` varchar(20) DEFAULT NULL COMMENT 'æ‰§è¡Œå™¨ä»»åŠ¡åˆ†ç‰‡å‚æ•°ï¼Œæ ¼å¼å¦‚ 1/2',
  `executor_fail_retry_count` int(11) NOT NULL DEFAULT '0' COMMENT 'å¤±è´¥é‡è¯•æ¬¡æ•°',
  `trigger_time` datetime DEFAULT NULL COMMENT 'è°ƒåº¦-æ—¶é—´',
  `trigger_code` int(11) NOT NULL COMMENT 'è°ƒåº¦-ç»“æœ',
  `trigger_msg` text COMMENT 'è°ƒåº¦-æ—¥å¿—',
  `handle_time` datetime DEFAULT NULL COMMENT 'æ‰§è¡Œ-æ—¶é—´',
  `handle_code` int(11) NOT NULL COMMENT 'æ‰§è¡Œ-çŠ¶æ€',
  `handle_msg` text COMMENT 'æ‰§è¡Œ-æ—¥å¿—',
  `alarm_status` tinyint(4) NOT NULL DEFAULT '0' COMMENT 'å‘Šè­¦çŠ¶æ€ï¼š0-é»˜è®¤ã€1-æ— éœ€å‘Šè­¦ã€2-å‘Šè­¦æˆåŠŸã€3-å‘Šè­¦å¤±è´¥',
  PRIMARY KEY (`id`),
  KEY `I_trigger_time` (`trigger_time`),
  KEY `I_handle_code` (`handle_code`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

CREATE TABLE `xxl_job_log_report` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `trigger_day` datetime DEFAULT NULL COMMENT 'è°ƒåº¦-æ—¶é—´',
  `running_count` int(11) NOT NULL DEFAULT '0' COMMENT 'è¿è¡Œä¸­-æ—¥å¿—æ•°é‡',
  `suc_count` int(11) NOT NULL DEFAULT '0' COMMENT 'æ‰§è¡ŒæˆåŠŸ-æ—¥å¿—æ•°é‡',
  `fail_count` int(11) NOT NULL DEFAULT '0' COMMENT 'æ‰§è¡Œå¤±è´¥-æ—¥å¿—æ•°é‡',
  `update_time` datetime DEFAULT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `i_trigger_day` (`trigger_day`) USING BTREE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

CREATE TABLE `xxl_job_logglue` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `job_id` int(11) NOT NULL COMMENT 'ä»»åŠ¡ï¼Œä¸»é”®ID',
  `glue_type` varchar(50) DEFAULT NULL COMMENT 'GLUEç±»å‹',
  `glue_source` mediumtext COMMENT 'GLUEæºä»£ç ',
  `glue_remark` varchar(128) NOT NULL COMMENT 'GLUEå¤‡æ³¨',
  `add_time` datetime DEFAULT NULL,
  `update_time` datetime DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

CREATE TABLE `xxl_job_registry` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `registry_group` varchar(50) NOT NULL,
  `registry_key` varchar(255) NOT NULL,
  `registry_value` varchar(255) NOT NULL,
  `update_time` datetime DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `i_g_k_v` (`registry_group`,`registry_key`,`registry_value`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

CREATE TABLE `xxl_job_group` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `app_name` varchar(64) NOT NULL COMMENT 'æ‰§è¡Œå™¨AppName',
  `title` varchar(12) NOT NULL COMMENT 'æ‰§è¡Œå™¨åç§°',
  `address_type` tinyint(4) NOT NULL DEFAULT '0' COMMENT 'æ‰§è¡Œå™¨åœ°å€ç±»å‹ï¼š0=è‡ªåŠ¨æ³¨å†Œã€1=æ‰‹åŠ¨å½•å…¥',
  `address_list` text COMMENT 'æ‰§è¡Œå™¨åœ°å€åˆ—è¡¨ï¼Œå¤šåœ°å€é€—å·åˆ†éš”',
  `update_time` datetime DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

CREATE TABLE `xxl_job_user` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `username` varchar(50) NOT NULL COMMENT 'è´¦å·',
  `password` varchar(50) NOT NULL COMMENT 'å¯†ç ',
  `role` tinyint(4) NOT NULL COMMENT 'è§’è‰²ï¼š0-æ™®é€šç”¨æˆ·ã€1-ç®¡ç†å‘˜',
  `permission` varchar(255) DEFAULT NULL COMMENT 'æƒé™ï¼šæ‰§è¡Œå™¨IDåˆ—è¡¨ï¼Œå¤šä¸ªé€—å·åˆ†å‰²',
  PRIMARY KEY (`id`),
  UNIQUE KEY `i_username` (`username`) USING BTREE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

CREATE TABLE `xxl_job_lock` (
  `lock_name` varchar(50) NOT NULL COMMENT 'é”åç§°',
  PRIMARY KEY (`lock_name`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

INSERT INTO `xxl_job_group`(`id`, `app_name`, `title`, `address_type`, `address_list`, `update_time`) VALUES (1, 'xxl-job-executor-sample', 'ç¤ºä¾‹æ‰§è¡Œå™¨', 0, NULL, '2018-11-03 22:21:31' );
INSERT INTO `xxl_job_info`(`id`, `job_group`, `job_desc`, `add_time`, `update_time`, `author`, `alarm_email`, `schedule_type`, `schedule_conf`, `misfire_strategy`, `executor_route_strategy`, `executor_handler`, `executor_param`, `executor_block_strategy`, `executor_timeout`, `executor_fail_retry_count`, `glue_type`, `glue_source`, `glue_remark`, `glue_updatetime`, `child_jobid`) VALUES (1, 1, 'æµ‹è¯•ä»»åŠ¡1', '2018-11-03 22:21:31', '2018-11-03 22:21:31', 'XXL', '', 'CRON', '0 0 0 * * ? *', 'DO_NOTHING', 'FIRST', 'demoJobHandler', '', 'SERIAL_EXECUTION', 0, 0, 'BEAN', '', 'GLUEä»£ç åˆå§‹åŒ–', '2018-11-03 22:21:31', '');
INSERT INTO `xxl_job_user`(`id`, `username`, `password`, `role`, `permission`) VALUES (1, 'admin', 'e10adc3949ba59abbe56e057f20f883e', 1, NULL);
INSERT INTO `xxl_job_lock` ( `lock_name`) VALUES ( 'schedule_lock');

commit;
</code></pre></div><p><strong>æ³¨ï¼šè°ƒåº¦ä¸­å¿ƒæ”¯æŒé›†ç¾¤éƒ¨ç½²ï¼Œé›†ç¾¤æƒ…å†µä¸‹å„èŠ‚ç‚¹åŠ¡å¿…è¿æ¥åŒä¸€ä¸ª mysql å®ä¾‹ï¼Œå¦‚æœ mysql åšä¸»ä»ï¼Œè°ƒåº¦ä¸­å¿ƒé›†ç¾¤èŠ‚ç‚¹åŠ¡å¿…å¼ºåˆ¶èµ°ä¸»åº“ã€‚</strong></p> <ol start="2"><li>Docker é•œåƒæ–¹å¼æ­å»ºè°ƒåº¦ä¸­å¿ƒï¼š</li></ol> <div class="language- extra-class"><pre class="language-text"><code>/**
* å¦‚éœ€è‡ªå®šä¹‰ mysql ç­‰é…ç½®ï¼Œå¯é€šè¿‡ &quot;-e PARAMS&quot; æŒ‡å®šï¼Œå‚æ•°æ ¼å¼ PARAMS=&quot;--key=value  --key2=value2&quot; ï¼›
* å¦‚éœ€è‡ªå®šä¹‰ JVM å†…å­˜å‚æ•° ç­‰é…ç½®ï¼Œå¯é€šè¿‡ &quot;-e JAVA_OPTS&quot; æŒ‡å®šï¼Œå‚æ•°æ ¼å¼ JAVA_OPTS=&quot;-Xmx512m&quot; ï¼›
*/
docker run \
 -e PARAMS=' \
 --spring.datasource.url=jdbc:mysql://47.106.243.172:3306/xxl_job?useUnicode=true&amp;characterEncoding=UTF-8&amp;autoReconnect=true&amp;serverTimezone=Asia/Shanghai \
 --spring.datasource.username=test \
 --spring.datasource.password=test!1234 \
 --xxl.job.accessToken=123' \
 -p 8080:8080 \
 -v /tmp:/data/applogs \
 --name xxl-job-admin \
 -d xuxueli/xxl-job-admin:{æŒ‡å®šç‰ˆæœ¬} 
</code></pre></div><p><strong>æ³¨ï¼šå¦‚ä¸Šæ‰€ç¤ºï¼Œæ•°æ®åº“å¯†ç ä¸­å¦‚æœåŒ…å«ç‰¹æ®Šå­—ç¬¦(ä¾‹å¦‚ï¼Œ&amp; æˆ– ï¼)ï¼Œéœ€è¦å¯¹ç‰¹æ®Šå­—ç¬¦è¿›è¡Œè½¬ä¹‰ï¼ŒPARAMS å‚æ•°å€¼ä¸€å®šè¦ä½¿ç”¨ä½¿ç”¨å•å¼•å·è€Œä¸èƒ½ä½¿ç”¨åŒå¼•å·ã€‚</strong></p> <table><thead><tr><th style="text-align:left;">å¸¸ç”¨è½¬ä¹‰å­—ç¬¦</th> <th style="text-align:center;">ä½œç”¨</th></tr></thead> <tbody><tr><td style="text-align:left;">åæ–œæ ï¼ˆ\ï¼‰</td> <td style="text-align:center;">ä½¿åæ–œæ åé¢çš„ä¸€ä¸ªå˜é‡å˜ä¸ºå•çº¯çš„å­—ç¬¦ä¸²ï¼Œå¦‚æœæ”¾åœ¨å¼•å·é‡Œé¢ï¼Œæ˜¯ä¸èµ·ä½œç”¨çš„</td></tr> <tr><td style="text-align:left;">å•å¼•å·ï¼ˆâ€™â€™ï¼‰</td> <td style="text-align:center;">è½¬ä¹‰å…¶ä¸­æ‰€æœ‰çš„å˜é‡ä¸ºå•çº¯çš„å­—ç¬¦ä¸²</td></tr> <tr><td style="text-align:left;">åŒå¼•å·ï¼ˆ&quot;&quot;ï¼‰</td> <td style="text-align:center;">ä¿ç•™å…¶ä¸­çš„å˜é‡å±æ€§ï¼Œä¸è¿›è¡Œè½¬ä¹‰å¤„ç†</td></tr></tbody></table> <p>è°ƒåº¦ä¸­å¿ƒè®¿é—®åœ°å€ï¼šhttp://ip:8080/xxl-job-admin (è¯¥åœ°å€æ‰§è¡Œå™¨å°†ä¼šä½¿ç”¨åˆ°ï¼Œä½œä¸ºå›è°ƒåœ°å€)</p> <p>é»˜è®¤ç™»å½•è´¦å· â€œadmin/123456â€ï¼Œç™»å½•åå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p> <p><img src="/img/novel/xxljob1.png" alt="XXL-JOB é¦–é¡µ"></p> <ol start="3"><li>é¡¹ç›®ä¸­å¼•å…¥<code>xxl-job-core</code>çš„ maven ä¾èµ–ï¼š</li></ol> <div class="language- extra-class"><pre class="language-text"><code>&lt;dependency&gt;
    &lt;groupId&gt;com.xuxueli&lt;/groupId&gt;
    &lt;artifactId&gt;xxl-job-core&lt;/artifactId&gt;
    &lt;version&gt;2.3.1&lt;/version&gt;
&lt;/dependency&gt;
</code></pre></div><ol start="4"><li>application.yml ä¸­åŠ å…¥æ‰§è¡Œå™¨é…ç½®ï¼š</li></ol> <div class="language- extra-class"><pre class="language-text"><code># XXL-JOB é…ç½®
xxl:
  job:
    admin:
      ### è°ƒåº¦ä¸­å¿ƒéƒ¨ç½²æ ¹åœ°å€ [é€‰å¡«]ï¼šå¦‚è°ƒåº¦ä¸­å¿ƒé›†ç¾¤éƒ¨ç½²å­˜åœ¨å¤šä¸ªåœ°å€åˆ™ç”¨é€—å·åˆ†éš”ã€‚æ‰§è¡Œå™¨å°†ä¼šä½¿ç”¨è¯¥åœ°å€è¿›è¡Œ&quot;æ‰§è¡Œå™¨å¿ƒè·³æ³¨å†Œ&quot;å’Œ&quot;ä»»åŠ¡ç»“æœå›è°ƒ&quot;ï¼›ä¸ºç©ºåˆ™å…³é—­è‡ªåŠ¨æ³¨å†Œï¼›
      addresses: http://127.0.0.1:8080/xxl-job-admin
    executor:
      ### æ‰§è¡Œå™¨AppName [é€‰å¡«]ï¼šæ‰§è¡Œå™¨å¿ƒè·³æ³¨å†Œåˆ†ç»„ä¾æ®ï¼›ä¸ºç©ºåˆ™å…³é—­è‡ªåŠ¨æ³¨å†Œ
      appname: xxl-job-executor-novel
      ### æ‰§è¡Œå™¨è¿è¡Œæ—¥å¿—æ–‡ä»¶å­˜å‚¨ç£ç›˜è·¯å¾„ [é€‰å¡«] ï¼šéœ€è¦å¯¹è¯¥è·¯å¾„æ‹¥æœ‰è¯»å†™æƒé™ï¼›ä¸ºç©ºåˆ™ä½¿ç”¨é»˜è®¤è·¯å¾„ï¼›
      logpath: logs/xxl-job/jobhandler
    ### xxl-job, access token
    accessToken: 123
</code></pre></div><ol start="5"><li>åœ¨<code>io.github.xxyopen.novel.core.config</code>åŒ…ä¸‹åˆ›å»º XXL-JOB é…ç½®ç±»é…ç½®æ‰§è¡Œå™¨ç»„ä»¶ï¼š</li></ol> <div class="language- extra-class"><pre class="language-text"><code>/**
 * XXL-JOB é…ç½®ç±»
 *
 * @author xiongxiaoyang
 * @date 2022/5/31
 */
@Configuration
@Slf4j
public class XxlJobConfig {

    @Value(&quot;${xxl.job.admin.addresses}&quot;)
    private String adminAddresses;

    @Value(&quot;${xxl.job.accessToken}&quot;)
    private String accessToken;

    @Value(&quot;${xxl.job.executor.appname}&quot;)
    private String appname;

    @Value(&quot;${xxl.job.executor.logpath}&quot;)
    private String logPath;

    @Bean
    public XxlJobSpringExecutor xxlJobExecutor() {
        log.info(&quot;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; xxl-job config init.&quot;);
        XxlJobSpringExecutor xxlJobSpringExecutor = new XxlJobSpringExecutor();
        xxlJobSpringExecutor.setAdminAddresses(adminAddresses);
        xxlJobSpringExecutor.setAccessToken(accessToken);
        xxlJobSpringExecutor.setAppname(appname);
        xxlJobSpringExecutor.setLogPath(logPath);
        return xxlJobSpringExecutor;
    }

}
</code></pre></div><h2 id="æ¥å£å¼€å‘"><a href="#æ¥å£å¼€å‘" class="header-anchor">#</a> æ¥å£å¼€å‘</h2> <h3 id="æ¥å£è§„çº¦"><a href="#æ¥å£è§„çº¦" class="header-anchor">#</a> æ¥å£è§„çº¦</h3> <ol><li><p>åè®®ï¼šç”Ÿäº§ç¯å¢ƒå¿…é¡»ä½¿ç”¨ HTTPSã€‚</p></li> <li><p>è·¯å¾„ï¼šæ¯ä¸€ä¸ª API éœ€å¯¹åº”ä¸€ä¸ªè·¯å¾„ï¼Œè¡¨ç¤º API å…·ä½“çš„è¯·æ±‚åœ°å€ï¼š</p> <p>aï¼‰ ä»£è¡¨ä¸€ç§èµ„æºï¼Œåªèƒ½ä¸ºåè¯ï¼Œæ¨èä½¿ç”¨å¤æ•°ï¼Œä¸èƒ½ä¸ºåŠ¨è¯ï¼Œè¯·æ±‚æ–¹æ³•å·²ç»è¡¨è¾¾åŠ¨ä½œæ„ä¹‰ã€‚</p> <p>bï¼‰ URL è·¯å¾„ä¸èƒ½ä½¿ç”¨å¤§å†™ï¼Œå•è¯å¦‚æœéœ€è¦åˆ†éš”ï¼Œç»Ÿä¸€ä½¿ç”¨ä¸‹åˆ’çº¿ã€‚</p> <p>cï¼‰ è·¯å¾„ç¦æ­¢æºå¸¦è¡¨ç¤ºè¯·æ±‚å†…å®¹ç±»å‹çš„åç¼€ï¼Œæ¯”å¦‚&quot;.json&quot;,&quot;.xml&quot;ï¼Œé€šè¿‡ accept å¤´è¡¨è¾¾å³å¯ã€‚</p></li> <li><p>è¯·æ±‚æ–¹æ³•ï¼šå¯¹å…·ä½“æ“ä½œçš„å®šä¹‰ï¼Œå¸¸è§çš„è¯·æ±‚æ–¹æ³•å¦‚ä¸‹ï¼š</p> <p>aï¼‰ GETï¼šä»æœåŠ¡å™¨å–å‡ºèµ„æºã€‚</p> <p>bï¼‰ POSTï¼šåœ¨æœåŠ¡å™¨æ–°å»ºä¸€ä¸ªèµ„æºã€‚</p> <p>cï¼‰ PUTï¼šåœ¨æœåŠ¡å™¨æ›´æ–°èµ„æºã€‚</p> <p>dï¼‰ DELETEï¼šä»æœåŠ¡å™¨åˆ é™¤èµ„æºã€‚</p></li> <li><p>è¯·æ±‚å†…å®¹ï¼š URL å¸¦çš„å‚æ•°å¿…é¡»æ— æ•æ„Ÿä¿¡æ¯æˆ–ç¬¦åˆå®‰å…¨è¦æ±‚ï¼› body é‡Œå¸¦å‚æ•°æ—¶å¿…é¡»è®¾ç½® Content-Typeã€‚</p></li> <li><p>å“åº”ä½“ï¼šå“åº”ä½“ body å¯æ”¾ç½®å¤šç§æ•°æ®ç±»å‹ï¼Œç”± Content-Type å¤´æ¥ç¡®å®šã€‚</p></li></ol> <h3 id="service-dao-å±‚æ–¹æ³•å‘½åè§„çº¦"><a href="#service-dao-å±‚æ–¹æ³•å‘½åè§„çº¦" class="header-anchor">#</a> Service/DAO å±‚æ–¹æ³•å‘½åè§„çº¦</h3> <ol><li><p>è·å–å•ä¸ªå¯¹è±¡çš„æ–¹æ³•ç”¨ get åšå‰ç¼€ã€‚</p></li> <li><p>è·å–å¤šä¸ªå¯¹è±¡çš„æ–¹æ³•ç”¨ list åšå‰ç¼€ï¼Œå¤æ•°ç»“å°¾ï¼Œå¦‚ï¼š listObjectsã€‚</p></li> <li><p>è·å–ç»Ÿè®¡å€¼çš„æ–¹æ³•ç”¨ count åšå‰ç¼€ã€‚</p></li> <li><p>æ’å…¥çš„æ–¹æ³•ç”¨ save/insert åšå‰ç¼€ã€‚</p></li> <li><p>åˆ é™¤çš„æ–¹æ³•ç”¨ remove/delete åšå‰ç¼€ã€‚</p></li> <li><p>ä¿®æ”¹çš„æ–¹æ³•ç”¨ update åšå‰ç¼€ã€‚</p></li></ol> <h3 id="é¦–é¡µç›¸å…³æ¥å£å¼€å‘"><a href="#é¦–é¡µç›¸å…³æ¥å£å¼€å‘" class="header-anchor">#</a> é¦–é¡µç›¸å…³æ¥å£å¼€å‘</h3> <p>é¦–é¡µ UI å›¾å¦‚ä¸‹ï¼š</p> <p><img src="/img/novel/home.png" alt="é¦–é¡µ UI å›¾"></p> <p>ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºé¦–é¡µåŒ…æ‹¬ <code>å°è¯´æ¨è</code>ï¼ˆåŒ…æ‹¬è½®æ’­å›¾ã€å‘¨æ¨ã€å¼ºæ¨ç­‰ï¼‰ã€<code>æ–°é—»å…¬å‘Š</code>ã€<code>ç‚¹å‡»æ¦œ</code>ã€<code>æ–°ä¹¦æ¦œ</code>ã€<code>æ›´æ–°æ¦œ</code>ï¼ˆåŒ…æ‹¬æœ€æ–°æ›´æ–°åˆ—è¡¨ï¼‰ å’Œ <code>å‹æƒ…é“¾æ¥</code> 6ä¸ªå†…å®¹åŒºåŸŸçš„å±•ç¤ºï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å¼€å‘ 6 ä¸ªç›¸å…³çš„ API æŸ¥è¯¢æ¥å£ä»¥æä¾›æ•°æ®ç»™å‰ç«¯ã€‚</p> <p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åœ¨ controllerã€serviceã€service.impl åŒ…ä¸‹åˆ›å»ºé¦–é¡µæ¨¡å—ã€æ–°é—»æ¨¡å—å’Œå°è¯´æ¨¡å—çš„ API æ§åˆ¶å™¨ Controllerã€ä¸šåŠ¡æœåŠ¡ç±» Service ä»¥åŠæœåŠ¡å®ç°ç±» ServiceImplã€‚</p> <p><strong>æ³¨ï¼šé¦–é¡µæ˜¯æˆ‘ä»¬å°è¯´é—¨æˆ·çš„å…¥å£ï¼Œæ‰¿è½½ç€æˆ‘ä»¬ç³»ç»Ÿå¾ˆå¤§ä¸€éƒ¨åˆ†æµé‡ï¼Œå¹¶ä¸”å†…å®¹ä¸éœ€è¦å®æ—¶æ›´æ–°ã€‚æ‰€ä»¥é¦–é¡µç›¸å…³å†…å®¹çš„æŸ¥è¯¢æœ€å¥½éƒ½åšç¼“å­˜å¤„ç†ã€‚</strong></p> <h4 id="é¦–é¡µå°è¯´æ¨èæŸ¥è¯¢æ¥å£å¼€å‘"><a href="#é¦–é¡µå°è¯´æ¨èæŸ¥è¯¢æ¥å£å¼€å‘" class="header-anchor">#</a> é¦–é¡µå°è¯´æ¨èæŸ¥è¯¢æ¥å£å¼€å‘</h4> <p>é¦–é¡µå°è¯´æ¨èçš„æ•°æ®ä¸»è¦ä¿å­˜åœ¨åœ¨æ•°æ®åº“**home_book [<strong>é¦–é¡µå°è¯´æ¨è</strong>]**è¡¨ä¸­ï¼Œè¯¥æŸ¥è¯¢æ˜¯ä¸€ä¸ªä»æœåŠ¡å™¨å–å‡ºèµ„æºçš„æ“ä½œï¼Œæ‰€ä»¥è¯¥è¯·æ±‚æ–¹æ³•éœ€è¦ä½¿ç”¨ GET ç±»å‹ã€‚å…·ä½“å®ç°æ­¥éª¤å¦‚ä¸‹ï¼š</p> <ol><li>é¦–å…ˆæˆ‘ä»¬éœ€è¦åœ¨<code>io.github.xxyopen.novel.manager</code>åŒ…ä¸‹åˆ›å»ºé¦–é¡µæ¨èå°è¯´çš„ç¼“å­˜ç®¡ç†ç±»å¦‚ä¸‹ï¼š</li></ol> <div class="language- extra-class"><pre class="language-text"><code>/**
 * é¦–é¡µæ¨èå°è¯´ ç¼“å­˜ç®¡ç†ç±»
 *
 * @author xiongxiaoyang
 * @date 2022/5/12
 */
@Component
@RequiredArgsConstructor
public class HomeBookCacheManager {

    private final HomeBookMapper homeBookMapper;

    private final BookInfoMapper bookInfoMapper;

    /**
     * æŸ¥è¯¢é¦–é¡µå°è¯´æ¨èï¼Œå¹¶æ”¾å…¥ç¼“å­˜ä¸­
     */
    @Cacheable(cacheManager = CacheConsts.CAFFEINE_CACHE_MANAGER
            , value = CacheConsts.HOME_BOOK_CACHE_NAME)
    public List&lt;HomeBookRespDto&gt; listHomeBooks() {
        // ä»é¦–é¡µå°è¯´æ¨èè¡¨ä¸­æŸ¥è¯¢å‡ºéœ€è¦æ¨èçš„å°è¯´
        List&lt;HomeBook&gt; homeBooks = homeBookMapper.selectList(null);

        // è·å–æ¨èå°è¯´IDåˆ—è¡¨
        if (!CollectionUtils.isEmpty(homeBooks)) {
            List&lt;Long&gt; bookIds = homeBooks.stream()
                    .map(HomeBook::getBookId)
                    .toList();

            // æ ¹æ®å°è¯´IDåˆ—è¡¨æŸ¥è¯¢ç›¸å…³çš„å°è¯´ä¿¡æ¯åˆ—è¡¨
            QueryWrapper&lt;BookInfo&gt; bookInfoQueryWrapper = new QueryWrapper&lt;&gt;();
            bookInfoQueryWrapper.in(&quot;id&quot;, bookIds);
            List&lt;BookInfo&gt; bookInfos = bookInfoMapper.selectList(bookInfoQueryWrapper);

            // ç»„è£… HomeBookRespDto åˆ—è¡¨æ•°æ®å¹¶è¿”å›
            if(!CollectionUtils.isEmpty(bookInfos)){
                Map&lt;Long, BookInfo&gt; bookInfoMap = bookInfos.stream()
                        .collect(Collectors.toMap(BookInfo::getId, Function.identity()));
                return homeBooks.stream().map(v -&gt; {
                    BookInfo bookInfo = bookInfoMap.get(v.getBookId());
                    HomeBookRespDto bookRespDto = new HomeBookRespDto();
                    bookRespDto.setBookId(v.getBookId());
                    bookRespDto.setBookName(bookInfo.getBookName());
                    bookRespDto.setPicUrl(bookInfo.getPicUrl());
                    bookRespDto.setAuthorName(bookInfo.getAuthorName());
                    bookRespDto.setBookDesc(bookInfo.getBookDesc());
                    return bookRespDto;
                }).toList();

            }

        }

        return Collections.emptyList();
    }

}
</code></pre></div><p>è¯¥ç¼“å­˜ç®¡ç†ç±»åŒ…å«äº†ä¸€ä¸ªæŸ¥è¯¢é¦–é¡µå°è¯´æ¨èæ•°æ®çš„æ–¹æ³•ï¼Œè¯¥æ–¹æ³•æ‰§è¡Œæ•°æ®åº“æŸ¥è¯¢é€»è¾‘å¹¶è¿›è¡Œç®€å•çš„å¤„ç†å¾—åˆ°æˆ‘ä»¬éœ€è¦çš„æ•°æ®æ ¼å¼å¹¶é€šè¿‡ @Cacheable æ³¨è§£ç¼“å­˜èµ·æ¥ã€‚
è¯¥æ–¹æ³•ä¸‹æ¬¡å†è¢«è°ƒç”¨æ—¶ä¼šç›´æ¥ä»ç¼“å­˜ä¸­æ‹¿å–æ•°æ®è€Œä¸éœ€è¦å†ä¸€æ¬¡æŸ¥è¯¢æ•°æ®åº“å¹¶å¤„ç†ï¼Œå¤§å¤§å‡è½»äº†æ•°æ®åº“çš„å‹åŠ›ã€‚</p> <ol start="2"><li>ç„¶åæˆ‘ä»¬åœ¨é¦–é¡µæ¨¡å—ä¸šåŠ¡ç±»<code>HomeService</code>ä¸­å®šä¹‰é¦–é¡µå°è¯´æ¨èæŸ¥è¯¢çš„ä¸šåŠ¡æ–¹æ³•å¦‚ä¸‹ï¼š</li></ol> <div class="language- extra-class"><pre class="language-text"><code>/**
 * é¦–é¡µæ¨¡å— æœåŠ¡ç±»
 *
 * @author xiongxiaoyang
 * @date 2022/5/13
 */
public interface HomeService {

    /**
     * æŸ¥è¯¢é¦–é¡µå°è¯´æ¨èåˆ—è¡¨
     *
     * @return é¦–é¡µå°è¯´æ¨èåˆ—è¡¨çš„ rest å“åº”ç»“æœ
     * */
    RestResp&lt;List&lt;HomeBookRespDto&gt;&gt; listHomeBooks();
}
</code></pre></div><ol start="3"><li>æ¥ç€æˆ‘ä»¬åœ¨é¦–é¡µæ¨¡å—ä¸šåŠ¡å®ç°ç±»<code>HomeServiceImpl</code>ä¸­å®ç°<code>HomeService</code>ä¸­å®šä¹‰çš„æŠ½è±¡æ–¹æ³•ï¼Œé€šè¿‡è°ƒç”¨<code>HomeBookCacheManager</code>çš„<code>listHomeBooks</code>æ–¹æ³•è·å–åˆ°æ‰€éœ€æ•°æ®å¹¶è¿”å›ï¼š</li></ol> <div class="language- extra-class"><pre class="language-text"><code>/**
 * é¦–é¡µæ¨¡å— æœåŠ¡å®ç°ç±»
 *
 * @author xiongxiaoyang
 * @date 2022/5/13
 */
@Service
@RequiredArgsConstructor
public class HomeServiceImpl implements HomeService {

    private final HomeBookCacheManager homeBookCacheManager;

    @Override
    public RestResp&lt;List&lt;HomeBookRespDto&gt;&gt; listHomeBooks() {
        return RestResp.ok(homeBookCacheManager.listHomeBooks());
    }
}
</code></pre></div><ol start="4"><li>æœ€åæˆ‘ä»¬åœ¨é¦–é¡µæ¨¡å—çš„ API æ§åˆ¶å™¨<code>HomeController</code>ä¸­å®šä¹‰ GET ç±»å‹çš„æŸ¥è¯¢æ¥å£ï¼Œè°ƒç”¨ service ä¸­çš„ç›¸åº”ä¸šåŠ¡æ–¹æ³•è·å¾—é¦–é¡µå°è¯´æ¨èæ•°æ®å¹¶è¿”å›ç»™å‰ç«¯ï¼š</li></ol> <div class="language- extra-class"><pre class="language-text"><code>/**
 * é¦–é¡µæ¨¡å— API æ¥å£
 *
 * @author xiongxiaoyang
 * @date 2022/5/12
 */
@RestController
@RequestMapping(ApiRouterConsts.API_FRONT_HOME_URL_PREFIX)
@RequiredArgsConstructor
public class HomeController {

    private final HomeService homeService;

    /**
     * é¦–é¡µå°è¯´æ¨èæŸ¥è¯¢æ¥å£
     * */
    @GetMapping(&quot;books&quot;)
    public RestResp&lt;List&lt;HomeBookRespDto&gt;&gt; listHomeBooks(){
        return homeService.listHomeBooks();
    }
}
</code></pre></div><h3 id="ç™»å½•æ³¨å†Œç›¸å…³æ¥å£å¼€å‘"><a href="#ç™»å½•æ³¨å†Œç›¸å…³æ¥å£å¼€å‘" class="header-anchor">#</a> ç™»å½•æ³¨å†Œç›¸å…³æ¥å£å¼€å‘</h3> <p>JWTï¼ˆJSON Web Tokenï¼‰æ˜¯ä¸€ç§å¼€æ”¾çš„<a href="https://datatracker.ietf.org/doc/html/rfc7519" target="_blank" rel="noopener noreferrer">RFC 7519<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>è¡Œä¸šæ ‡å‡†æ–¹æ³•ï¼Œå®ƒå®šä¹‰äº†ä¸€ç§ç´§å‡‘çš„ã€è‡ªåŒ…å«çš„æ–¹å¼ï¼Œç”¨äºä½œä¸º JSON å¯¹è±¡åœ¨å„æ–¹ä¹‹é—´å®‰å…¨åœ°ä¼ è¾“ä¿¡æ¯ã€‚è¯¥ä¿¡æ¯å¯ä»¥è¢«éªŒè¯å’Œä¿¡ä»»ï¼Œå› ä¸ºå®ƒæ˜¯æ•°å­—ç­¾åçš„ã€‚æœåŠ¡ç«¯åªç”Ÿæˆå’ŒéªŒè¯ JWTï¼Œå®¢æˆ·ç«¯ä¿å­˜ JWTï¼Œæ‰€ä»¥ JWT æ˜¯æ— çŠ¶æ€çš„ã€‚</p> <p>ç”±äº JWT çš„æ— çŠ¶æ€æ€§ï¼Œç‰¹åˆ«é€‚ç”¨äºåˆ†å¸ƒå¼ç«™ç‚¹çš„å•ç‚¹ç™»å½•ï¼ˆSSOï¼‰åœºæ™¯ï¼Œå·²ç»æˆä¸ºäº†ç›®å‰åˆ†å¸ƒå¼æœåŠ¡æƒé™æ§åˆ¶è§£å†³æ–¹æ¡ˆçš„äº‹å®æ ‡å‡†ã€‚æˆ‘ä»¬ novel é¡¹ç›®æ˜¯ä¸€ä¸ªå¤šç³»ç»Ÿå¹¶ä¸”åæœŸä¼šæ‹“å±•ä¸ºå¾®æœåŠ¡æ¶æ„çš„é¡¹ç›®ï¼Œæ‰€ä»¥ä½¿ç”¨ JWT æ¥å®ç°ç™»å½•è®¤è¯ã€‚</p> <p><a href="https://github.com/jwtk/jjwt" target="_blank" rel="noopener noreferrer">JJWT<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æ˜¯ä¸€ä¸ªåœ¨ JVM å’Œ Android ä¸Šåˆ›å»ºå’ŒéªŒè¯ JWT éå¸¸æ˜“äºä½¿ç”¨å’Œç†è§£çš„åº“ï¼ŒJJWT æ˜¯å®Œå…¨åŸºäº JWTã€JWSã€JWEã€JWK å’Œ JWA RFC è§„èŒƒçš„çº¯ Java å®ç°ï¼Œå¹¶ä¸”åœ¨ Apache 2.0 è®¸å¯æ¡æ¬¾ä¸‹å¼€æºï¼Œç›®å‰åœ¨ JAVA åº”ç”¨ç¨‹åºä¸­å¹¿æ³›ä½¿ç”¨ã€‚novel é¡¹ç›®é›†æˆäº†è¯¥åº“ä»¥å®ç° JWT çš„ç”Ÿæˆå’ŒéªŒè¯ã€‚</p> <p>æ³¨å†Œå’Œç™»å½•çš„ UI å›¾å¦‚ä¸‹ï¼š</p> <p><img src="/img/novel/register.png" alt="æ³¨å†Œ UI å›¾"></p> <p><img src="/img/novel/login.png" alt="ç™»å½• UI å›¾"></p> <h4 id="è·å–å›¾ç‰‡éªŒè¯ç æ¥å£å¼€å‘"><a href="#è·å–å›¾ç‰‡éªŒè¯ç æ¥å£å¼€å‘" class="header-anchor">#</a> è·å–å›¾ç‰‡éªŒè¯ç æ¥å£å¼€å‘</h4> <p>ä»æ³¨å†Œçš„ UI å›¾ä¸­å¯ä»¥çœ‹å‡ºæˆ‘ä»¬éœ€è¦ä¸€ä¸ªå›¾å½¢éªŒè¯ç æ¥é˜²æ­¢ç”¨æˆ·åˆ©ç”¨æœºå™¨äººè‡ªåŠ¨æ³¨å†Œã€‚è¯¥å›¾å½¢éªŒè¯ç ç”±æœåŠ¡ç«¯ç”Ÿæˆï¼Œå½“ç”¨æˆ·ç”³è¯·æ³¨å†Œæ—¶å¿…é¡»å¸¦ä¸ŠéªŒè¯ç ï¼Œç”±æœåŠ¡ç«¯æ¥æ ¡éªŒéªŒè¯ç çš„æœ‰æ•ˆæ€§ï¼Œåªæœ‰éªŒè¯ç åŒ¹é…æ‰èƒ½å…è®¸ç”¨æˆ·æ³¨å†Œã€‚è·å–å›¾ç‰‡éªŒè¯ç æ¥å£å¼€å‘æ­¥éª¤å¦‚ä¸‹ï¼š</p> <ol><li><p>å›¾å½¢éªŒè¯ç å±äºä¸€ç§å›¾ç‰‡èµ„æºï¼Œæ‰€ä»¥æˆ‘ä»¬é¦–å…ˆéœ€è¦åœ¨ controllerã€serviceã€service.impl åŒ…ä¸‹åˆ›å»ºèµ„æºï¼ˆResourceï¼Œå¤„ç†å›¾ç‰‡/è§†é¢‘/æ–‡æ¡£ç­‰ï¼‰æ¨¡å—çš„ API æ§åˆ¶å™¨ Controllerã€ä¸šåŠ¡æœåŠ¡ç±» Service ä»¥åŠæœåŠ¡å®ç°ç±» ServiceImplã€‚</p></li> <li><p>æ¥ç€æˆ‘ä»¬éœ€è¦åœ¨<code>io.github.xxyopen.novel.core.common.util</code>åŒ…ä¸‹åˆ›å»ºå›¾å½¢éªŒè¯ç å·¥å…·ç±»æ¥ç”Ÿæˆéšæœºæ ¡éªŒç å’Œå¯¹åº”çš„ Base64 ç¼–ç åçš„å›¾ç‰‡ï¼š</p></li></ol> <div class="language- extra-class"><pre class="language-text"><code>/**
 * å›¾ç‰‡éªŒè¯ç å·¥å…·ç±»
 *
 * @author xiongxiaoyang
 * @date 2022/5/17
 */
@UtilityClass
public class ImgVerifyCodeUtils {

    /**
     * éšæœºäº§ç”Ÿåªæœ‰æ•°å­—çš„å­—ç¬¦ä¸²
     */
    private final String randNumber = &quot;0123456789&quot;;

    /**
     * å›¾ç‰‡å®½
     */
    private final int width = 100;

    /**
     * å›¾ç‰‡é«˜
     */
    private final int height = 38;

    private final Random random = new Random();

    /**
     * è·å¾—å­—ä½“
     */
    private Font getFont() {
        return new Font(&quot;Fixed&quot;, Font.PLAIN, 23);
    }


    /**
     * ç”Ÿæˆæ ¡éªŒç å›¾ç‰‡
     */
    public String genVerifyCodeImg(String verifyCode) throws IOException {
        // BufferedImageç±»æ˜¯å…·æœ‰ç¼“å†²åŒºçš„Imageç±»,Imageç±»æ˜¯ç”¨äºæè¿°å›¾åƒä¿¡æ¯çš„ç±»
        BufferedImage image = new BufferedImage(width, height, BufferedImage.TYPE_INT_BGR);
        // äº§ç”ŸImageå¯¹è±¡çš„Graphicså¯¹è±¡,æ”¹å¯¹è±¡å¯ä»¥åœ¨å›¾åƒä¸Šè¿›è¡Œå„ç§ç»˜åˆ¶æ“ä½œ
        Graphics g = image.getGraphics();
        //å›¾ç‰‡å¤§å°
        g.fillRect(0, 0, width, height);
        //å­—ä½“å¤§å°
        //å­—ä½“é¢œè‰²
        g.setColor(new Color(204, 204, 204));
        // ç»˜åˆ¶å¹²æ‰°çº¿
        // å¹²æ‰°çº¿æ•°é‡
        int lineSize = 40;
        for (int i = 0; i &lt;= lineSize; i++) {
            drawLine(g);
        }
        // ç»˜åˆ¶éšæœºå­—ç¬¦
        drawString(g, verifyCode);
        g.dispose();
        //å°†å›¾ç‰‡è½¬æ¢æˆBase64å­—ç¬¦ä¸²
        ByteArrayOutputStream stream = new ByteArrayOutputStream();
        ImageIO.write(image, &quot;JPEG&quot;, stream);
        return Base64.getEncoder().encodeToString(stream.toByteArray());
    }

    /**
     * ç»˜åˆ¶å­—ç¬¦ä¸²
     */
    private void drawString(Graphics g, String verifyCode) {
        for (int i = 1; i &lt;= verifyCode.length(); i++) {
            g.setFont(getFont());
            g.setColor(new Color(random.nextInt(101), random.nextInt(111), random
                    .nextInt(121)));
            g.translate(random.nextInt(3), random.nextInt(3));
            g.drawString(String.valueOf(verifyCode.charAt(i - 1)), 13 * i, 23);
        }
    }

    /**
     * ç»˜åˆ¶å¹²æ‰°çº¿
     */
    private void drawLine(Graphics g) {
        int x = random.nextInt(width);
        int y = random.nextInt(height);
        int xl = random.nextInt(13);
        int yl = random.nextInt(15);
        g.drawLine(x, y, x + xl, y + yl);
    }

    /**
     * è·å–éšæœºçš„æ ¡éªŒç 
     */
    public String getRandomVerifyCode(int num) {
        int randNumberSize = randNumber.length();
        StringBuilder verifyCode = new StringBuilder();
        for (int i = 0; i &lt; num; i++) {
            String rand = String.valueOf(randNumber.charAt(random.nextInt(randNumberSize)));
            verifyCode.append(rand);
        }
        return verifyCode.toString();
    }

}
</code></pre></div><ol start="3"><li>ç„¶åï¼Œæˆ‘ä»¬åœ¨<code>io.github.xxyopen.novel.manager</code>åŒ…ä¸‹åˆ›å»ºéªŒè¯ç ç®¡ç†ç±»ï¼Œç”¨äºç”Ÿæˆã€æ ¡éªŒå’Œåˆ é™¤éªŒè¯ç ï¼ˆä¸é™äºå›¾å½¢éªŒè¯ç ï¼‰ï¼š</li></ol> <div class="language- extra-class"><pre class="language-text"><code>/**
 * éªŒè¯ç  ç®¡ç†ç±»
 *
 * @author xiongxiaoyang
 * @date 2022/5/12
 */
@Component
@RequiredArgsConstructor
@Slf4j
public class VerifyCodeManager {

    private final StringRedisTemplate stringRedisTemplate;

    /**
     * ç”Ÿæˆå›¾å½¢éªŒè¯ç ï¼Œå¹¶æ”¾å…¥ Redis ä¸­
     */
    public String genImgVerifyCode(String sessionId) throws IOException {
        String verifyCode = ImgVerifyCodeUtils.getRandomVerifyCode(4);
        String img = ImgVerifyCodeUtils.genVerifyCodeImg(verifyCode);
        stringRedisTemplate.opsForValue().set(CacheConsts.IMG_VERIFY_CODE_CACHE_KEY + sessionId
                , verifyCode, Duration.ofMinutes(5));
        return img;
    }

    /**
     * æ ¡éªŒå›¾å½¢éªŒè¯ç 
     */
    public boolean imgVerifyCodeOk(String sessionId, String verifyCode) {
        return Objects.equals(
                stringRedisTemplate.opsForValue().get(CacheConsts.IMG_VERIFY_CODE_CACHE_KEY + sessionId)
                , verifyCode);
    }

    /**
     * ä» Redis ä¸­åˆ é™¤éªŒè¯ç 
     */
    public void removeImgVerifyCode(String sessionId) {
        stringRedisTemplate.delete(CacheConsts.IMG_VERIFY_CODE_CACHE_KEY + sessionId);
    }
</code></pre></div><p><strong>æ³¨ï¼šæˆ‘ä»¬åœ¨ä¿å­˜éªŒè¯ç çš„æ—¶å€™éœ€è¦ä¸€ä¸ªå…¨å±€å”¯ä¸€çš„ sessionId å­—ç¬¦ä¸²ç”¨äºæ ‡è¯†è¯¥éªŒè¯ç å±äºå“ªä¸ªæµè§ˆå™¨ä¼šè¯ï¼Œè¯¥ sessionId ä¼šåœ¨éªŒè¯ç è¿”å›ç»™å‰ç«¯çš„æ—¶å€™ä¸€å¹¶è¿”å›ï¼Œåœ¨ç”¨æˆ·æäº¤æ³¨å†Œçš„æ—¶å€™ï¼Œè¯¥ sessionId ä¼šå’ŒéªŒè¯ç ä¸€èµ·æäº¤ç”¨äºæ ¡éªŒ</strong></p> <ol start="4"><li>æ¥ç€ï¼Œæˆ‘ä»¬åœ¨èµ„æºæ¨¡å—ä¸šåŠ¡ç±»<code>ResourceService</code>ä¸­å®šä¹‰è·å–å›¾ç‰‡éªŒè¯ç çš„ä¸šåŠ¡æ–¹æ³•å¦‚ä¸‹ï¼š</li></ol> <div class="language- extra-class"><pre class="language-text"><code>/**
 * è·å–å›¾ç‰‡éªŒè¯ç 
 *
 * @throws IOException éªŒè¯ç å›¾ç‰‡ç”Ÿæˆå¤±è´¥
 * @return Base64ç¼–ç çš„å›¾ç‰‡
 */
RestResp&lt;ImgVerifyCodeRespDto&gt; getImgVerifyCode() throws IOException;
</code></pre></div><ol start="5"><li>æ¥ç€ï¼Œæˆ‘ä»¬åœ¨èµ„æºæ¨¡å—ä¸šåŠ¡å®ç°ç±»<code>ResourceServiceImpl</code>ä¸­å®ç°<code>ResourceService</code>ä¸­å®šä¹‰çš„æŠ½è±¡æ–¹æ³•ï¼Œè°ƒç”¨<code>VerifyCodeManager</code>ä¸­è·å–å›¾å½¢éªŒè¯ç æ–¹æ³•å¹¶è¿”å›ç»“æœï¼š</li></ol> <div class="language- extra-class"><pre class="language-text"><code>@Override
public RestResp&lt;ImgVerifyCodeRespDto&gt; getImgVerifyCode() throws IOException {
    String sessionId = IdWorker.get32UUID();
    return RestResp.ok(ImgVerifyCodeRespDto.builder()
            .sessionId(sessionId)
            .img(verifyCodeManager.genImgVerifyCode(sessionId))
            .build());
}
</code></pre></div><ol start="6"><li>æœ€åï¼Œæˆ‘ä»¬åœ¨èµ„æºæ¨¡å—çš„ API æ§åˆ¶å™¨<code>ResourceController</code>ä¸­å®šä¹‰ GET ç±»å‹çš„æŸ¥è¯¢æ¥å£ï¼Œè°ƒç”¨ service ä¸­çš„ç›¸åº”ä¸šåŠ¡æ–¹æ³•è·å¾—å›¾å½¢éªŒè¯ç æ•°æ®å¹¶è¿”å›ç»™å‰ç«¯ï¼š</li></ol> <div class="language- extra-class"><pre class="language-text"><code>/**
 * è·å–å›¾ç‰‡éªŒè¯ç æ¥å£
 */
@GetMapping(&quot;img_verify_code&quot;)
public RestResp&lt;ImgVerifyCodeRespDto&gt; getImgVerifyCode() throws IOException {
    return resourceService.getImgVerifyCode();
}
</code></pre></div><h4 id="æ³¨å†Œæ¥å£å¼€å‘"><a href="#æ³¨å†Œæ¥å£å¼€å‘" class="header-anchor">#</a> æ³¨å†Œæ¥å£å¼€å‘</h4> <p>ç”¨æˆ·æ³¨å†Œéœ€è¦åœ¨åœ¨æ•°æ®åº“**user_info [<strong>ç”¨æˆ·ä¿¡æ¯</strong>]**è¡¨ä¸­æ’å…¥ä¸€æ¡ç”¨æˆ·æ•°æ®ï¼Œæ˜¯ä¸€ä¸ªåœ¨æœåŠ¡å™¨æ–°å»ºèµ„æºçš„æ“ä½œï¼Œæ‰€ä»¥è¯¥è¯·æ±‚æ–¹æ³•éœ€è¦ä½¿ç”¨ POST ç±»å‹ã€‚å…·ä½“å®ç°æ­¥éª¤å¦‚ä¸‹ï¼š</p> <ol><li>é¦–å…ˆæˆ‘ä»¬åœ¨é…ç½®æ–‡ä»¶<code>application.yml</code>ä¸­å®šä¹‰ JWT ç›¸å…³é…ç½®ï¼š</li></ol> <div class="language- extra-class"><pre class="language-text"><code># é¡¹ç›®é…ç½®
novel:
  # JWT å¯†é’¥
  jwt:
    secret: E66559580A1ADF48CDD928516062F12E
</code></pre></div><p><strong>æ³¨ï¼šç›®å‰åªæœ‰ JWT å¯†é’¥çš„é…ç½®ï¼ŒåæœŸä¼šæ‹“å±•è¿‡æœŸæ—¶é—´ç­‰å…¶ä»–é…ç½®</strong></p> <ol start="2"><li>ç„¶åï¼Œæˆ‘ä»¬åœ¨<code>io.github.xxyopen.novel.core.util</code>åŒ…ä¸‹åˆ›å»º JWT å·¥å…·ç±»ï¼Œç”¨äº JWT çš„ç”Ÿæˆå’Œè§£æï¼š</li></ol> <div class="language- extra-class"><pre class="language-text"><code>/**
 * JWT å·¥å…·ç±»
 *
 * @author xiongxiaoyang
 * @date 2022/5/17
 */
@ConditionalOnProperty(&quot;novel.jwt.secret&quot;)
@Component
@Slf4j
public class JwtUtils {

    /**
     * æ³¨å…¥JWTåŠ å¯†å¯†é’¥
     */
    @Value(&quot;${novel.jwt.secret}&quot;)
    private String secret;

    /**
     * å®šä¹‰ç³»ç»Ÿæ ‡è¯†å¤´å¸¸é‡
     */
    private static final String HEADER_SYSTEM_KEY = &quot;systemKeyHeader&quot;;

    /**
     * æ ¹æ®ç”¨æˆ· ID ç”Ÿæˆ JWT
     * @param uid ç”¨æˆ· ID
     * @param systemKey ç³»ç»Ÿæ ‡è¯†
     * @return JWT
     */
    public String generateToken(Long uid, String systemKey) {
        return Jwts.builder()
                .setHeaderParam(HEADER_SYSTEM_KEY, systemKey)
                .setSubject(uid.toString())
                .signWith(Keys.hmacShaKeyFor(secret.getBytes(StandardCharsets.UTF_8)))
                .compact();
    }

    /**
     * è§£æ JWT è¿”å›ç”¨æˆ· ID
     * @param token JWT
     * @param systemKey ç³»ç»Ÿæ ‡è¯†
     * @return ç”¨æˆ· ID
     */
    public Long parseToken(String token, String systemKey) {
        Jws&lt;Claims&gt; claimsJws;
        try {
            claimsJws = Jwts.parserBuilder()
                    .setSigningKey(Keys.hmacShaKeyFor(secret.getBytes(StandardCharsets.UTF_8)))
                    .build()
                    .parseClaimsJws(token);
            // OK, we can trust this JWT
            // åˆ¤æ–­è¯¥ JWT æ˜¯å¦å±äºæŒ‡å®šç³»ç»Ÿ
            if (Objects.equals(claimsJws.getHeader().get(HEADER_SYSTEM_KEY), systemKey)) {
                return Long.parseLong(claimsJws.getBody().getSubject());
            }
        } catch (JwtException e) {
            log.warn(&quot;JWTè§£æå¤±è´¥:{}&quot;, token);
            // don't trust the JWT!
        }
        return null;
    }

}
</code></pre></div><ol start="3"><li>æ¥ç€æˆ‘ä»¬éœ€è¦åœ¨ç”¨æˆ·æ¨¡å—ä¸šåŠ¡ç±»<code>UserService</code>ä¸­å®šä¹‰æ³¨å†Œçš„ä¸šåŠ¡æ–¹æ³•å¦‚ä¸‹ï¼š</li></ol> <div class="language- extra-class"><pre class="language-text"><code>/**
 * ç”¨æˆ·æ³¨å†Œ
 *
 * @param dto æ³¨å†Œå‚æ•°
 * @return JWT
 */
RestResp&lt;UserRegisterRespDto&gt; register(UserRegisterReqDto dto);
</code></pre></div><ol start="4"><li>æ¥ç€æˆ‘ä»¬åœ¨ç”¨æˆ·æ¨¡å—ä¸šåŠ¡å®ç°ç±»<code>UserServiceImpl</code>ä¸­å®ç°<code>UserService</code>ä¸­å®šä¹‰çš„æŠ½è±¡æ–¹æ³•ï¼Œå¯¹éªŒè¯ç ã€æ‰‹æœºå·è¿›è¡Œæ ¡éªŒã€‚æ ¡éªŒæˆåŠŸï¼Œåˆ™ä¿å­˜ç”¨æˆ·ä¿¡æ¯åˆ°æ•°æ®åº“ï¼Œå¹¶åˆ é™¤éªŒè¯ç å’Œä½¿ç”¨ JWT å·¥å…·ç±»ç”Ÿæˆ JWT å­—ç¬¦ä¸²è¿”å›ï¼›æ ¡éªŒå¤±è´¥ï¼Œåˆ™è¿”å›ç›¸åº”çš„é”™è¯¯ç ç»™å‰ç«¯ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š</li></ol> <div class="language- extra-class"><pre class="language-text"><code>@Override
public RestResp&lt;UserRegisterRespDto&gt; register(UserRegisterReqDto dto) {
    // æ ¡éªŒå›¾å½¢éªŒè¯ç æ˜¯å¦æ­£ç¡®
    if (!verifyCodeManager.imgVerifyCodeOk(dto.getSessionId(), dto.getVelCode())) {
        // å›¾å½¢éªŒè¯ç æ ¡éªŒå¤±è´¥
        throw new BusinessException(ErrorCodeEnum.USER_VERIFY_CODE_ERROR);
    }

    // æ ¡éªŒæ‰‹æœºå·æ˜¯å¦å·²æ³¨å†Œ
    QueryWrapper&lt;UserInfo&gt; queryWrapper = new QueryWrapper&lt;&gt;();
    queryWrapper.eq(DatabaseConsts.UserInfoTable.COLUMN_USERNAME, dto.getUsername())
            .last(DatabaseConsts.SqlEnum.LIMIT_1.getSql());
    if (userInfoMapper.selectCount(queryWrapper) &gt; 0) {
        // æ‰‹æœºå·å·²æ³¨å†Œ
        throw new BusinessException(ErrorCodeEnum.USER_NAME_EXIST);
    }

    // æ³¨å†ŒæˆåŠŸï¼Œä¿å­˜ç”¨æˆ·ä¿¡æ¯
    UserInfo userInfo = new UserInfo();
    userInfo.setPassword(DigestUtils.md5DigestAsHex(dto.getPassword().getBytes(StandardCharsets.UTF_8)));
    userInfo.setUsername(dto.getUsername());
    userInfo.setNickName(dto.getUsername());
    userInfo.setCreateTime(LocalDateTime.now());
    userInfo.setUpdateTime(LocalDateTime.now());
    userInfo.setSalt(&quot;0&quot;);
    userInfoMapper.insert(userInfo);

    // åˆ é™¤éªŒè¯ç 
    verifyCodeManager.removeImgVerifyCode(dto.getSessionId());

    // ç”ŸæˆJWT å¹¶è¿”å›
    return RestResp.ok(
            UserRegisterRespDto.builder()
                    .token(jwtUtils.generateToken(userInfo.getId(), SystemConfigConsts.NOVEL_FRONT_KEY))
                    .uid(userInfo.getId())
                    .build()
    );

}
</code></pre></div><ol start="5"><li>æœ€åï¼Œæˆ‘ä»¬åœ¨ç”¨æˆ·æ¨¡å— API æ§åˆ¶å™¨<code>UserController</code>ä¸­å®šä¹‰ POST ç±»å‹çš„æ³¨å†Œæ¥å£ï¼Œè°ƒç”¨ç”¨æˆ·æ¨¡å— service ä¸­çš„ç›¸åº”ä¸šåŠ¡æ–¹æ³•æ³¨å†Œç”¨æˆ·ï¼š</li></ol> <div class="language- extra-class"><pre class="language-text"><code>/**
    * ç”¨æˆ·æ³¨å†Œæ¥å£
    */
@PostMapping(&quot;register&quot;)
public RestResp&lt;UserRegisterRespDto&gt; register(@Valid @RequestBody UserRegisterReqDto dto) {
    return userService.register(dto);
}
</code></pre></div><h4 id="ç™»å½•æ¥å£å¼€å‘"><a href="#ç™»å½•æ¥å£å¼€å‘" class="header-anchor">#</a> ç™»å½•æ¥å£å¼€å‘</h4> <p>ç”¨æˆ·ç™»å½•æ˜¯ä¸€ä¸ªç‰¹æ®Šæ¥å£ï¼Œä¸æ˜¯å•ç‹¬è¯·æ±‚ä¸€ä¸ªèµ„æºï¼Œè€Œæ˜¯å¯¹äºç”¨æˆ·ä¿¡æ¯éªŒè¯ï¼Œåˆ›å»ºä¸€ä¸ª JWTï¼Œè€Œä¸”ç™»å½•æäº¤çš„æ•°æ®ä¸­è¿˜åŒ…å«æ•æ„Ÿæ•°æ®ï¼ˆå¯†ç ï¼‰ã€‚URL å¸¦çš„å‚æ•°å¿…é¡»æ— æ•æ„Ÿä¿¡æ¯æˆ–ç¬¦åˆå®‰å…¨è¦æ±‚ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å®šä¹‰ POST ç±»å‹çš„æ¥å£æ¥å¤„ç†ç™»å½•è¯·æ±‚ã€‚å…·ä½“å®ç°æ­¥éª¤å¦‚ä¸‹ï¼š</p> <ol><li>é¦–å…ˆæˆ‘ä»¬éœ€è¦åœ¨ç”¨æˆ·æ¨¡å—ä¸šåŠ¡ç±»<code>UserService</code>ä¸­å®šä¹‰ç™»å½•çš„ä¸šåŠ¡æ–¹æ³•å¦‚ä¸‹ï¼š</li></ol> <div class="language- extra-class"><pre class="language-text"><code>/**
 * ç”¨æˆ·ç™»å½•
 *
 * @param dto ç™»å½•å‚æ•°
 * @return JWT + æ˜µç§°
*/
RestResp&lt;UserLoginRespDto&gt; login(UserLoginReqDto dto);
</code></pre></div><ol start="2"><li>æ¥ç€æˆ‘ä»¬åœ¨ç”¨æˆ·æ¨¡å—ä¸šåŠ¡å®ç°ç±»<code>UserServiceImpl</code>ä¸­å®ç°<code>UserService</code>ä¸­å®šä¹‰çš„æŠ½è±¡æ–¹æ³•ï¼Œå¯¹ç™»å½•ç”¨æˆ·åå¯†ç è¿›è¡Œæ ¡éªŒã€‚æ ¡éªŒé€šè¿‡ï¼Œåˆ™ç”Ÿæˆ JWT å­—ç¬¦ä¸²è¿”å›ï¼›æ ¡éªŒå¤±è´¥ï¼Œåˆ™è¿”å›å¯¹åº”çš„é”™è¯¯ç ï¼š</li></ol> <div class="language- extra-class"><pre class="language-text"><code>@Override
public RestResp&lt;UserLoginRespDto&gt; login(UserLoginReqDto dto) {
    // æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯
    QueryWrapper&lt;UserInfo&gt; queryWrapper = new QueryWrapper&lt;&gt;();
    queryWrapper.eq(DatabaseConsts.UserInfoTable.COLUMN_USERNAME, dto.getUsername())
            .last(DatabaseConsts.SqlEnum.LIMIT_1.getSql());
    UserInfo userInfo = userInfoMapper.selectOne(queryWrapper);
    if (Objects.isNull(userInfo)) {
        // ç”¨æˆ·ä¸å­˜åœ¨
        throw new BusinessException(ErrorCodeEnum.USER_ACCOUNT_NOT_EXIST);
    }

    // åˆ¤æ–­å¯†ç æ˜¯å¦æ­£ç¡®
    if (!Objects.equals(userInfo.getPassword()
            , DigestUtils.md5DigestAsHex(dto.getPassword().getBytes(StandardCharsets.UTF_8)))) {
        // å¯†ç é”™è¯¯
        throw new BusinessException(ErrorCodeEnum.USER_PASSWORD_ERROR);
    }

    // ç™»å½•æˆåŠŸï¼Œç”ŸæˆJWTå¹¶è¿”å›
    return RestResp.ok(UserLoginRespDto.builder()
            .token(jwtUtils.generateToken(userInfo.getId(), SystemConfigConsts.NOVEL_FRONT_KEY))
            .uid(userInfo.getId())
            .nickName(userInfo.getNickName()).build());
}
</code></pre></div><ol start="3"><li>æœ€åï¼Œæˆ‘ä»¬åœ¨ç”¨æˆ·æ¨¡å— API æ§åˆ¶å™¨<code>UserController</code>ä¸­å®šä¹‰ POST ç±»å‹çš„ç™»å½•æ¥å£ï¼Œè°ƒç”¨ç”¨æˆ·æ¨¡å— service ä¸­çš„ç›¸åº”ä¸šåŠ¡æ–¹æ³•ï¼š</li></ol> <div class="language- extra-class"><pre class="language-text"><code>/**
 * ç”¨æˆ·ç™»å½•æ¥å£
 */
@PostMapping(&quot;login&quot;)
public RestResp&lt;UserLoginRespDto&gt; login(@Valid @RequestBody UserLoginReqDto dto) {
    return userService.login(dto);
}

</code></pre></div><h3 id="å°è¯´è¯¦æƒ…é¡µç›¸å…³æ¥å£å¼€å‘"><a href="#å°è¯´è¯¦æƒ…é¡µç›¸å…³æ¥å£å¼€å‘" class="header-anchor">#</a> å°è¯´è¯¦æƒ…é¡µç›¸å…³æ¥å£å¼€å‘</h3> <p>å°è¯´è¯¦æƒ…é¡µ UI å›¾å¦‚ä¸‹ï¼š</p> <p><img src="/img/novel/book_detail.png" alt="å°è¯´è¯¦æƒ…é¡µ UI å›¾"></p> <p>ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºå°è¯´è¯¦æƒ…é¡µåŒ…æ‹¬ <code>å°è¯´ä¿¡æ¯</code>ï¼ˆåŒ…æ‹¬ä½œå®¶ä¿¡æ¯ï¼‰ã€<code>æœ€æ–°ç« èŠ‚</code>ã€<code>ä½œå“è¯„è®º</code>ã€<code>åŒç±»æ¨è</code>å››ä¸ªå†…å®¹åŒºåŸŸçš„å±•ç¤ºï¼Œè€Œè¯„è®ºåŒºè¿˜åŒ…å«äº†è¯„è®ºå‘è¡¨ã€è¯„è®ºä¿®æ”¹å’Œè¯„è®ºåˆ é™¤çš„åŠŸèƒ½ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦å¼€å‘ä¸å°è¯´è¯¦æƒ…é¡µç›¸å…³çš„ 4 ä¸ª API æŸ¥è¯¢æ¥å£ã€1 ä¸ª API å¢åŠ æ¥å£ã€1 ä¸ª API ä¿®æ”¹æ¥å£å’Œ 1 ä¸ª API åˆ é™¤æ¥å£æä¾›ç»™å‰ç«¯ã€‚</p> <h4 id="å°è¯´è¯„è®ºå‘è¡¨æ¥å£å¼€å‘"><a href="#å°è¯´è¯„è®ºå‘è¡¨æ¥å£å¼€å‘" class="header-anchor">#</a> å°è¯´è¯„è®ºå‘è¡¨æ¥å£å¼€å‘</h4> <p>è¯„è®ºå‘è¡¨éœ€è¦åœ¨æ•°æ®åº“**book_comment [<strong>å°è¯´è¯„è®º</strong>]**è¡¨ä¸­æ’å…¥ä¸€æ¡è¯„è®ºæ•°æ®ï¼Œæ˜¯ä¸€ä¸ªåœ¨æœåŠ¡å™¨æ–°å»ºèµ„æºçš„æ“ä½œï¼Œæ‰€ä»¥è¯¥è¯·æ±‚æ–¹æ³•éœ€è¦ä½¿ç”¨ POST ç±»å‹ã€‚å…·ä½“å®ç°æ­¥éª¤å¦‚ä¸‹ï¼š</p> <ol><li>é¦–å…ˆæˆ‘ä»¬éœ€è¦åœ¨å°è¯´æ¨¡å—ä¸šåŠ¡ç±»<code>BookService</code>ä¸­å®šä¹‰å‘è¡¨è¯„è®ºçš„ä¸šåŠ¡æ–¹æ³•å¦‚ä¸‹ï¼š</li></ol> <div class="language- extra-class"><pre class="language-text"><code>/**
 * å‘è¡¨è¯„è®º
 *
 * @param dto è¯„è®ºç›¸å…³ DTO
 * @return void
 */
RestResp&lt;Void&gt; saveComment(UserCommentReqDto dto);
</code></pre></div><ol start="2"><li>æ¥ç€æˆ‘ä»¬åœ¨å°è¯´æ¨¡å—ä¸šåŠ¡å®ç°ç±»<code>BookServiceImpl</code>ä¸­å®ç°<code>BookService</code>ä¸­å®šä¹‰çš„æŠ½è±¡æ–¹æ³•ï¼Œå°†ç”¨æˆ·å¯¹å°è¯´çš„è¯„è®ºæ•°æ®ä¿å­˜åˆ°æ•°æ®åº“ä¸­ï¼š</li></ol> <div class="language- extra-class"><pre class="language-text"><code>@Override
public RestResp&lt;Void&gt; saveComment(UserCommentReqDto dto) {
    // æ ¡éªŒç”¨æˆ·æ˜¯å¦å·²å‘è¡¨è¯„è®º
    QueryWrapper&lt;BookComment&gt; queryWrapper = new QueryWrapper&lt;&gt;();
    queryWrapper.eq(DatabaseConsts.BookCommentTable.COLUMN_USER_ID,dto.getUserId())
            .eq(DatabaseConsts.BookCommentTable.COLUMN_BOOK_ID,dto.getBookId());
    if(bookCommentMapper.selectCount(queryWrapper) &gt; 0){
        // ç”¨æˆ·å·²å‘è¡¨è¯„è®º
        return RestResp.fail(ErrorCodeEnum.USER_COMMENTED);
    }
    BookComment bookComment = new BookComment();
    bookComment.setBookId(dto.getBookId());
    bookComment.setUserId(dto.getUserId());
    bookComment.setCommentContent(dto.getCommentContent());
    bookComment.setCreateTime(LocalDateTime.now());
    bookComment.setUpdateTime(LocalDateTime.now());
    bookCommentMapper.insert(bookComment);
    return RestResp.ok();
}
</code></pre></div><p><strong>æ³¨ï¼šä¿å­˜è¯„è®ºä¹‹å‰æˆ‘ä»¬éœ€è¦å¯¹ç”¨æˆ·æ˜¯å¦å·²å‘è¡¨è¯„è®ºè¿›è¡Œæ ¡éªŒï¼Œæ¯ä¸ªç”¨æˆ·åªèƒ½å¯¹åŒä¸€æœ¬ä¹¦å‘è¡¨ä¸€æ¡è¯„è®ºã€‚</strong></p> <ol start="3"><li>æœ€åï¼Œç”±äºå‘è¡¨è¯„è®ºçš„è¡Œä¸ºå±äºç”¨æˆ·ï¼ˆéœ€è¦æ ¡éªŒç™»å½•æƒé™ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ç”¨æˆ·æ¨¡å— API æ§åˆ¶å™¨<code>UserController</code>ä¸­å®šä¹‰ POST ç±»å‹çš„å¢åŠ æ¥å£ï¼Œè°ƒç”¨å°è¯´æ¨¡å— service ä¸­çš„ç›¸åº”ä¸šåŠ¡æ–¹æ³•ä¿å­˜å°è¯´è¯„è®ºæ•°æ®ï¼š</li></ol> <div class="language- extra-class"><pre class="language-text"><code>/**
 * å‘è¡¨è¯„è®ºæ¥å£
 */
@PostMapping(&quot;comment&quot;)
public RestResp&lt;Void&gt; comment(@Valid @RequestBody UserCommentReqDto dto) {
    dto.setUserId(UserHolder.getUserId());
    return bookService.saveComment(dto);
}
</code></pre></div><h4 id="å°è¯´è¯„è®ºä¿®æ”¹æ¥å£å¼€å‘"><a href="#å°è¯´è¯„è®ºä¿®æ”¹æ¥å£å¼€å‘" class="header-anchor">#</a> å°è¯´è¯„è®ºä¿®æ”¹æ¥å£å¼€å‘</h4> <p>è¯„è®ºä¿®æ”¹éœ€è¦æ›´æ–°æ•°æ®åº“**book_comment [<strong>å°è¯´è¯„è®º</strong>]**è¡¨ä¸­çš„è¯„è®ºæ•°æ®ï¼Œæ˜¯ä¸€ä¸ªåœ¨æœåŠ¡å™¨æ›´æ–°èµ„æºçš„æ“ä½œï¼Œæ‰€ä»¥è¯¥è¯·æ±‚æ–¹æ³•éœ€è¦ä½¿ç”¨ PUT ç±»å‹ã€‚å…·ä½“å®ç°æ­¥éª¤å¦‚ä¸‹ï¼š</p> <ol><li>é¦–å…ˆæˆ‘ä»¬éœ€è¦åœ¨å°è¯´æ¨¡å—ä¸šåŠ¡ç±»<code>BookService</code>ä¸­å®šä¹‰ä¿®æ”¹è¯„è®ºçš„ä¸šåŠ¡æ–¹æ³•å¦‚ä¸‹ï¼š</li></ol> <div class="language- extra-class"><pre class="language-text"><code>/**
 * ä¿®æ”¹è¯„è®º
 * @param userId ç”¨æˆ·ID
 * @param id è¯„è®ºID
 * @param content ä¿®æ”¹åçš„è¯„è®ºå†…å®¹
 * @return void
 * */
RestResp&lt;Void&gt; updateComment(Long userId, Long id, String content);
</code></pre></div><ol start="2"><li>æ¥ç€æˆ‘ä»¬åœ¨å°è¯´æ¨¡å—ä¸šåŠ¡å®ç°ç±»<code>BookServiceImpl</code>ä¸­å®ç°<code>BookService</code>ä¸­å®šä¹‰çš„æŠ½è±¡æ–¹æ³•ï¼Œæ›´æ–°æ•°æ®è¡¨ä¸­çš„è¯„è®ºæ•°æ®ï¼š</li></ol> <div class="language- extra-class"><pre class="language-text"><code>@Override
public RestResp&lt;Void&gt; updateComment(Long userId, Long id, String content) {
    QueryWrapper&lt;BookComment&gt; queryWrapper = new QueryWrapper&lt;&gt;();
    queryWrapper.eq(DatabaseConsts.CommonColumnEnum.ID.getName(), id)
            .eq(DatabaseConsts.BookCommentTable.COLUMN_USER_ID,userId);
    BookComment bookComment = new BookComment();
    bookComment.setCommentContent(content);
    bookCommentMapper.update(bookComment,queryWrapper);
    return RestResp.ok();
}
</code></pre></div><p><strong>æ³¨ï¼šç”¨æˆ·åªèƒ½æ›´æ–°è‡ªå·±çš„å°è¯´è¯„è®ºï¼Œæ‰€ä»¥æ›´æ–°è¯„è®ºè¡¨ä¸­æ•°æ®çš„ where æ¡ä»¶ä¸ä½†éœ€è¦å°è¯´IDè¿˜éœ€è¦åŠ ä¸Šç”¨æˆ·ID</strong></p> <ol start="3"><li>æœ€åï¼Œç”±äºä¿®æ”¹è¯„è®ºçš„è¡Œä¸ºå±äºç”¨æˆ·ï¼ˆéœ€è¦æ ¡éªŒç™»å½•æƒé™ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ç”¨æˆ·æ¨¡å— API æ§åˆ¶å™¨<code>UserController</code>ä¸­å®šä¹‰ PUT ç±»å‹çš„ä¿®æ”¹æ¥å£ï¼Œè°ƒç”¨å°è¯´æ¨¡å— service ä¸­çš„ç›¸åº”ä¸šåŠ¡æ–¹æ³•æ¥æ›´æ–°å°è¯´è¯„è®ºæ•°æ®ï¼š</li></ol> <div class="language- extra-class"><pre class="language-text"><code>/**
 * ä¿®æ”¹è¯„è®ºæ¥å£
 */
@PutMapping(&quot;comment/{id}&quot;)
public RestResp&lt;Void&gt; updateComment(@PathVariable Long id, String content) {
    return bookService.updateComment(UserHolder.getUserId(), id, content);
}
</code></pre></div><h4 id="å°è¯´è¯„è®ºåˆ é™¤æ¥å£å¼€å‘"><a href="#å°è¯´è¯„è®ºåˆ é™¤æ¥å£å¼€å‘" class="header-anchor">#</a> å°è¯´è¯„è®ºåˆ é™¤æ¥å£å¼€å‘</h4> <p>è¯„è®ºåˆ é™¤éœ€è¦åˆ é™¤æ•°æ®åº“**book_comment [<strong>å°è¯´è¯„è®º</strong>]**è¡¨ä¸­çš„è¯„è®ºæ•°æ®ï¼Œæ˜¯ä¸€ä¸ªä»æœåŠ¡å™¨åˆ é™¤èµ„æºçš„æ“ä½œï¼Œæ‰€ä»¥è¯¥è¯·æ±‚æ–¹æ³•éœ€è¦ä½¿ç”¨ DELETE ç±»å‹ã€‚å…·ä½“å®ç°æ­¥éª¤å¦‚ä¸‹ï¼š</p> <ol><li>é¦–å…ˆæˆ‘ä»¬éœ€è¦åœ¨å°è¯´æ¨¡å—ä¸šåŠ¡ç±»<code>BookService</code>ä¸­å®šä¹‰åˆ é™¤è¯„è®ºçš„ä¸šåŠ¡æ–¹æ³•å¦‚ä¸‹ï¼š</li></ol> <div class="language- extra-class"><pre class="language-text"><code>/**
 * åˆ é™¤è¯„è®º
 * @param userId è¯„è®ºç”¨æˆ·ID
 * @param commentId è¯„è®ºID
 * @return void
 * */
RestResp&lt;Void&gt; deleteComment(Long userId, Long commentId);
</code></pre></div><ol start="2"><li>æ¥ç€æˆ‘ä»¬åœ¨å°è¯´æ¨¡å—ä¸šåŠ¡å®ç°ç±»<code>BookServiceImpl</code>ä¸­å®ç°<code>BookService</code>ä¸­å®šä¹‰çš„æŠ½è±¡æ–¹æ³•ï¼Œåˆ é™¤æ•°æ®è¡¨ä¸­çš„è¯„è®ºæ•°æ®ï¼š</li></ol> <div class="language- extra-class"><pre class="language-text"><code>@Override
public RestResp&lt;Void&gt; deleteComment(Long userId, Long commentId) {
    QueryWrapper&lt;BookComment&gt; queryWrapper = new QueryWrapper&lt;&gt;();
    queryWrapper.eq(DatabaseConsts.CommonColumnEnum.ID.getName(), commentId)
            .eq(DatabaseConsts.BookCommentTable.COLUMN_USER_ID,userId);
        bookCommentMapper.delete(queryWrapper);
    return RestResp.ok();
}
</code></pre></div><p><strong>æ³¨ï¼šç”¨æˆ·åªèƒ½åˆ é™¤è‡ªå·±çš„å°è¯´è¯„è®ºï¼Œæ‰€ä»¥åˆ é™¤è¯„è®ºè¡¨ä¸­æ•°æ®çš„ where æ¡ä»¶ä¸ä½†éœ€è¦å°è¯´IDè¿˜éœ€è¦åŠ ä¸Šç”¨æˆ·ID</strong></p> <ol start="3"><li>æœ€åï¼Œç”±äºåˆ é™¤è¯„è®ºçš„è¡Œä¸ºå±äºç”¨æˆ·ï¼ˆéœ€è¦æ ¡éªŒç™»å½•æƒé™ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ç”¨æˆ·æ¨¡å— API æ§åˆ¶å™¨<code>UserController</code>ä¸­å®šä¹‰ DELETE ç±»å‹çš„åˆ é™¤æ¥å£ï¼Œè°ƒç”¨å°è¯´æ¨¡å— service ä¸­çš„ç›¸åº”ä¸šåŠ¡æ–¹æ³•æ¥åˆ é™¤å°è¯´è¯„è®ºæ•°æ®ï¼š</li></ol> <div class="language- extra-class"><pre class="language-text"><code>/**
 * åˆ é™¤è¯„è®ºæ¥å£
 */
@DeleteMapping(&quot;comment/{id}&quot;)
public RestResp&lt;Void&gt; deleteComment(@PathVariable Long id) {
    return bookService.deleteComment(UserHolder.getUserId(), id);
}
</code></pre></div><h4 id="å°è¯´æœ€æ–°è¯„è®ºåˆ—è¡¨æŸ¥è¯¢æ¥å£å¼€å‘"><a href="#å°è¯´æœ€æ–°è¯„è®ºåˆ—è¡¨æŸ¥è¯¢æ¥å£å¼€å‘" class="header-anchor">#</a> å°è¯´æœ€æ–°è¯„è®ºåˆ—è¡¨æŸ¥è¯¢æ¥å£å¼€å‘</h4> <p>æœ€æ–°è¯„è®ºåˆ—è¡¨æŸ¥è¯¢éœ€è¦æŸ¥è¯¢æ•°æ®åº“**book_comment [<strong>å°è¯´è¯„è®º</strong>]**è¡¨ä¸­çš„è¯„è®ºæ•°æ®ï¼Œæ˜¯ä¸€ä¸ªä»æœåŠ¡å™¨å–å‡ºèµ„æºçš„æ“ä½œï¼Œæ‰€ä»¥è¯¥è¯·æ±‚æ–¹æ³•éœ€è¦ä½¿ç”¨ GET ç±»å‹ã€‚å…·ä½“å®ç°æ­¥éª¤å¦‚ä¸‹ï¼š</p> <ol><li>é¦–å…ˆæˆ‘ä»¬éœ€è¦åœ¨å°è¯´æ¨¡å—ä¸šåŠ¡ç±»<code>BookService</code>ä¸­å®šä¹‰æŸ¥è¯¢æœ€æ–°è¯„è®ºåˆ—è¡¨çš„ä¸šåŠ¡æ–¹æ³•å¦‚ä¸‹ï¼š</li></ol> <div class="language- extra-class"><pre class="language-text"><code>/**
 * å°è¯´æœ€æ–°è¯„è®ºæŸ¥è¯¢
 *
 * @param bookId å°è¯´ID
 * @return å°è¯´æœ€æ–°è¯„è®ºæ•°æ®
 */
RestResp&lt;BookCommentRespDto&gt; listNewestComments(Long bookId);
</code></pre></div><ol start="2"><li>æ¥ç€æˆ‘ä»¬åœ¨å°è¯´æ¨¡å—ä¸šåŠ¡å®ç°ç±»<code>BookServiceImpl</code>ä¸­å®ç°<code>BookService</code>ä¸­å®šä¹‰çš„æŠ½è±¡æ–¹æ³•ï¼ŒæŸ¥è¯¢æ•°æ®è¡¨ä¸­çš„æœ€æ–°è¯„è®ºåˆ—è¡¨æ•°æ®ï¼š</li></ol> <div class="language- extra-class"><pre class="language-text"><code>@Override
public RestResp&lt;BookCommentRespDto&gt; listNewestComments(Long bookId) {
    // æŸ¥è¯¢è¯„è®ºæ€»æ•°
    QueryWrapper&lt;BookComment&gt; commentCountQueryWrapper = new QueryWrapper&lt;&gt;();
    commentCountQueryWrapper.eq(DatabaseConsts.BookCommentTable.COLUMN_BOOK_ID, bookId);
    Long commentTotal = bookCommentMapper.selectCount(commentCountQueryWrapper);
    BookCommentRespDto bookCommentRespDto = BookCommentRespDto.builder().commentTotal(commentTotal).build();
    if (commentTotal &gt; 0) {

        // æŸ¥è¯¢æœ€æ–°çš„è¯„è®ºåˆ—è¡¨
        QueryWrapper&lt;BookComment&gt; commentQueryWrapper = new QueryWrapper&lt;&gt;();
        commentQueryWrapper.eq(DatabaseConsts.BookCommentTable.COLUMN_BOOK_ID, bookId)
                .orderByDesc(DatabaseConsts.CommonColumnEnum.CREATE_TIME.getName())
                .last(DatabaseConsts.SqlEnum.LIMIT_5.getSql());
        List&lt;BookComment&gt; bookComments = bookCommentMapper.selectList(commentQueryWrapper);

        // æŸ¥è¯¢è¯„è®ºç”¨æˆ·ä¿¡æ¯ï¼Œå¹¶è®¾ç½®éœ€è¦è¿”å›çš„è¯„è®ºç”¨æˆ·å
        List&lt;Long&gt; userIds = bookComments.stream().map(BookComment::getUserId).toList();
        List&lt;UserInfo&gt; userInfos = userDaoManager.listUsers(userIds);
        Map&lt;Long, String&gt; userInfoMap = userInfos.stream().collect(Collectors.toMap(UserInfo::getId, UserInfo::getUsername));
        List&lt;BookCommentRespDto.CommentInfo&gt; commentInfos = bookComments.stream()
                .map(v -&gt; BookCommentRespDto.CommentInfo.builder()
                        .id(v.getId())
                        .commentUserId(v.getUserId())
                        .commentUser(userInfoMap.get(v.getUserId()))
                        .commentContent(v.getCommentContent())
                        .commentTime(v.getCreateTime()).build()).toList();
        bookCommentRespDto.setComments(commentInfos);
    } else {
        bookCommentRespDto.setComments(Collections.emptyList());
    }
    return RestResp.ok(bookCommentRespDto);
}
</code></pre></div><ol start="3"><li>æœ€åï¼Œæˆ‘ä»¬åœ¨å°è¯´æ¨¡å— API æ§åˆ¶å™¨<code>BookController</code>ä¸­å®šä¹‰ GET ç±»å‹çš„æŸ¥è¯¢æ¥å£ï¼Œè°ƒç”¨ service ä¸­çš„ç›¸åº”ä¸šåŠ¡æ–¹æ³•æ¥æŸ¥è¯¢å°è¯´æœ€æ–°è¯„è®ºåˆ—è¡¨æ•°æ®ï¼š</li></ol> <div class="language- extra-class"><pre class="language-text"><code>/**
 * å°è¯´æœ€æ–°è¯„è®ºæŸ¥è¯¢æ¥å£
 */
@GetMapping(&quot;comment/newest_list&quot;)
public RestResp&lt;BookCommentRespDto&gt; listNewestComments(Long bookId) {
    return bookService.listNewestComments(bookId);
}
</code></pre></div><ol start="4"><li>å› ä¸ºå°è¯´è¯„è®ºçš„ç”¨æˆ·åï¼ˆæ‰‹æœºå·ï¼‰å±äºæ•æ„Ÿæ•°æ®ï¼Œæˆ‘ä»¬ä¸åº”è¯¥ç›´æ¥è¿”å›ç»™å‰ç«¯ã€‚æ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦å®šä¹‰ä¸€ä¸ª JSON åºåˆ—åŒ–å™¨åœ¨ Spring MVC åºåˆ—åŒ–æˆ‘ä»¬è¿”å›çš„ Java å¯¹è±¡ä¸º JSON å­—ç¬¦ä¸²æ—¶æ ¼å¼åŒ–ä¸€ä¸‹ç”¨æˆ·åï¼Œéšè—ä¸­é—´çš„ 4 ä½æ•°å­—ä¸º <code>****</code>ã€‚ä»£ç å¦‚ä¸‹ï¼š</li></ol> <div class="language- extra-class"><pre class="language-text"><code>/**
 * ç”¨æˆ·ååºåˆ—åŒ–å™¨ï¼ˆæ•æ„Ÿä¿¡æ¯ï¼Œä¸åº”è¯¥åœ¨é¡µé¢ä¸Šå®Œå…¨æ˜¾ç¤ºï¼‰
 *
 * @author xiongxiaoyang
 * @date 2022/5/20
 */
public class UsernameSerializer extends JsonSerializer&lt;String&gt; {

    @Override
    public void serialize(String s, JsonGenerator jsonGenerator, SerializerProvider serializerProvider) throws IOException {
        jsonGenerator.writeString(s.substring(0,4) + &quot;****&quot; + s.substring(8));
    }

}
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>/**
 * å°è¯´è¯„è®º å“åº”DTO
 * @author xiongxiaoyang
 * @date 2022/5/17
 */
@Data
@Builder
public class BookCommentRespDto {

    private Long commentTotal;

    private List&lt;CommentInfo&gt; comments;

    @Data
    @Builder
    public static class CommentInfo {

        private Long id;

        private String commentContent;

        @JsonSerialize(using = UsernameSerializer.class)
        private String commentUser;

        private Long commentUserId;

        @JsonFormat(pattern = &quot;yyyy-MM-dd HH:mm:ss&quot;)
        private LocalDateTime commentTime;

    }

}
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">ä¸Šæ¬¡æ›´æ–°:</span> <span class="time">21 days ago</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/course/novel/3.html" class="prev">
        æ•°æ®åº“è®¾è®¡
      </a></span> <span class="next"><a href="/course/novel/9.html">
        é¡¹ç›®ä¼˜åŒ–
      </a>
      â†’
    </span></p></div> </main></div><div class="global-ui"><!----><div id="live2d-widget" class="live2d-widget-container" style="position:fixed;right:65px;bottom:0px;width:135px;height:300px;z-index:99999;opacity:0.8;pointer-events:none;"><canvas id="live2d_canvas" width="135" height="300" class="live2d_canvas" style="position:absolute;left:0px;top:0px;width:135px;height:300px;"></canvas></div><div></div></div></div>
    <script src="/assets/js/app.09e306c7.js" defer></script><script src="/assets/js/2.99247de7.js" defer></script><script src="/assets/js/14.d3b12aa4.js" defer></script>
  </body>
</html>
